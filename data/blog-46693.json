{"status":"OK","result":{"originalLocale":"en","allowViewHistory":true,"creationTimeSeconds":1471792910,"rating":98,"authorHandle":"Radewoosh","modificationTimeSeconds":1471817523,"id":46693,"title":"\u003cp\u003eVK cup eliminations — Levels and Regions — higher limits\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eHi guys!\u003c/p\u003e\u003cp\u003eOn IOI I\u0027ve learned many new things, so now I want to give you a challenge. You probably remember my and \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/Errichto\" title\u003d\"International Grandmaster Errichto\"\u003eErrichto\u003c/a\u003e\u0027s eliminations to VK Cup 2016. Let\u0027s focus on this problem: \u003ca href\u003d\"/contest/674/problem/C\" title\u003d\"Codeforces Round 351 (VK Cup 2016 Round 3, Div. 1 Edition)\"\u003e674C - Levels and Regions\u003c/a\u003e\u003c/p\u003e\u003cp\u003eMain solution was solving it in O(n*k), because k wasn\u0027t greater than 50. What if k is just lower or equal to n? :D\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003c/span\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003esolution\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cp\u003eThere are two key observations. \u003c/p\u003e \u003col\u003e   \u003cli\u003eObviously, higher \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e means smaller result.\u003c/li\u003e   \u003cli\u003eFor every \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e (\u003cspan class\u003d\"tex-span\"\u003e1 \u0026lt; \u003ci\u003ei\u003c/i\u003e \u0026lt; \u003ci\u003en\u003c/i\u003e\u003c/span\u003e) there is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eres\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e + 1) - \u003ci\u003eres\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e) ≤ \u003ci\u003eres\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e) - \u003ci\u003eres\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e - 1)\u003c/span\u003e.\u003c/li\u003e \u003c/ol\u003e\u003cp\u003eThe above implies that for every \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e (that \u003cspan class\u003d\"tex-span\"\u003e1 ≤ \u003ci\u003ei\u003c/i\u003e ≤ \u003ci\u003en\u003c/i\u003e\u003c/span\u003e) there exists such real value \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e\u003c/span\u003e that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eres\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e) + \u003ci\u003ei\u003c/i\u003e·\u003ci\u003eX\u003c/i\u003e ≤ \u003ci\u003eres\u003c/i\u003e(\u003ci\u003ej\u003c/i\u003e) + \u003ci\u003ej\u003c/i\u003e·\u003ci\u003eX\u003c/i\u003e\u003c/span\u003e for every \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/98/e6/98e6d3cf51ce3a6e5449f2b6dd77a0124d147f1f.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Also, for fixed \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e good \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e\u003c/span\u003e\u0027s are between \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eres\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e + 1) - \u003ci\u003eres\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e)\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eres\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e) - \u003ci\u003eres\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e - 1)\u003c/span\u003e, inclusive (except for trivial cases \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e \u003d 1\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e \u003d \u003ci\u003en\u003c/i\u003e\u003c/span\u003e).\u003c/p\u003e\u003cp\u003eSo, when we have fixed \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e\u003c/span\u003e, we can calculate the minimum value of dividing sequence into intervals (we can use any number of them), where cost for an interval is the same as in the basic version of task plus \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e\u003c/span\u003e. Using the convex hull trick, we can do it in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e)\u003c/span\u003e. Then we check how many intervals we\u0027ve used to do it. If we\u0027ve used too many, we know that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e\u003c/span\u003e should be greater (to force the algorithm to use smaller number of intervals). If we\u0027ve used at most \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e intervals, we should make \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e\u003c/span\u003e lower. So now we see that we should use binary search to find good \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e\u003c/span\u003e!\u003c/p\u003e\u003cp\u003eAfter finding good \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e\u003c/span\u003e, we just calculate the optimum value for full sequence and subtract \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e·\u003ci\u003eX\u003c/i\u003e\u003c/span\u003e. This gives us \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e·\u003ci\u003elog\u003c/i\u003e)\u003c/span\u003e solution.\u003c/p\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e","tags":["after ioi","challenge","dp","convex hull optimization","complexity optimization"]}}