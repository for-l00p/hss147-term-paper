{"status":"OK","result":{"originalLocale":"en","allowViewHistory":true,"creationTimeSeconds":1461432163,"rating":6,"authorHandle":"skavurskaa","modificationTimeSeconds":1461455084,"id":44516,"title":"\u003cp\u003e[Need Help] Order statistics in rooted trees\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eHello!\u003c/p\u003e\u003cp\u003eI am solving a problem where a rooted tree with N vertices is given, each vertex has a value V \u0026lt;\u003d 10^9, and i have to answer M queries. Each of the queries has the format (V,K), and i have to answer which is the K-th smallest value in the subtree rooted in vertex V. The limits for N,M are 10^5.\u003c/p\u003e\u003cp\u003eMy current approach solves almost every instance of the problem (O(N log N) average) but fails when the tree degenerates to a linked list (O(N^2 log N) worst case). I store every query so i can answer all them after i run my algorithm. I process the tree from the leaves up to the root using topological sort, and when i am processing some vertex, i merge the leaves\u0027 subtrees values using heapsort (found it to be faster than mergesort, but still slow if the tree is a linked list), and answer every query related to this vertex. After every vertex has been processed, i iterate over the answer array and print the results.\u003c/p\u003e\u003cp\u003eCan anyone help me with a better approach, or point some property that can help my solution so it doesn\u0027t get TLE verdict?\u003c/p\u003e\u003cp\u003eThanks in advance.\u003c/p\u003e\u003cp\u003eEDIT : problem solved, used the idea given by \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/ffao\" title\u003d\"Grandmaster ffao\"\u003effao\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eOriginal statement : \u003ca href\u003d\"https://www.urionlinejudge.com.br/judge/en/problems/view/1695\"\u003ehttps://www.urionlinejudge.com.br/judge/en/problems/view/1695\u003c/a\u003e\u003c/p\u003e\u003cp\u003eMy code : \u003ca href\u003d\"http://pastebin.com/ncWeC102\"\u003ehttp://pastebin.com/ncWeC102\u003c/a\u003e\u003c/p\u003e\u003c/div\u003e","tags":["graph","trees","k-th order statistic"]}}