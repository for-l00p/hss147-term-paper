{"status":"OK","result":{"originalLocale":"en","allowViewHistory":true,"creationTimeSeconds":1522931673,"rating":38,"authorHandle":"Vovuh","modificationTimeSeconds":1522997733,"id":58743,"title":"\u003cp\u003eEducational Codeforces Round 41 Editorial\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003e\u003ca href\u003d\"/contest/961/problem/A\" title\u003d\"Educational Codeforces Round 41 (Rated for Div. 2)\"\u003e961A - Tetris\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eEditorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"961A\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (Vovuh)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\nint main() {\n#ifdef _DEBUG\n\tfreopen(\u0026quot;input.txt\u0026quot;, \u0026quot;r\u0026quot;, stdin);\n//\tfreopen(\u0026quot;output.txt\u0026quot;, \u0026quot;w\u0026quot;, stdout);\n#endif\n\n\tint n, m;\n\tcin \u0026gt;\u0026gt; n \u0026gt;\u0026gt; m;\n\tvector\u0026lt;int\u0026gt; cnt(n);\n\n\tfor (int i \u003d 0; i \u0026lt; m; ++i) {\n\t\tint col;\n\t\tcin \u0026gt;\u0026gt; col;\n\t\t++cnt[col - 1];\n\t}\n\t\n\tcout \u0026lt;\u0026lt; *min_element(cnt.begin(), cnt.end()) \u0026lt;\u0026lt; endl;\n\t\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/961/problem/B\" title\u003d\"Educational Codeforces Round 41 (Rated for Div. 2)\"\u003e961B - Lecture Sleep\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eEditorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"961B\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (Vovuh)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\nint main() {\n#ifdef _DEBUG\n\tfreopen(\u0026quot;input.txt\u0026quot;, \u0026quot;r\u0026quot;, stdin);\n//\tfreopen(\u0026quot;output.txt\u0026quot;, \u0026quot;w\u0026quot;, stdout);\n#endif\n\n\tint n, k;\n\tscanf(\u0026quot;%d %d\u0026quot;, \u0026amp;n, \u0026amp;k);\n\t\n\tvector\u0026lt;int\u0026gt; a(n);\n\tvector\u0026lt;int\u0026gt; t(n);\n\t\n\tint overall \u003d 0;\n\t\n\tfor (int i \u003d 0; i \u0026lt; n; ++i)\n\t\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;a[i]);\n\tfor (int i \u003d 0; i \u0026lt; n; ++i)\n\t\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;t[i]);\n\t\t\n\tvector\u0026lt;int\u0026gt; pr(n);\n\tfor (int i \u003d 0; i \u0026lt; n; ++i) {\n\t\tif (i) pr[i] +\u003d pr[i - 1];\n\t\tif (t[i] \u003d\u003d 0) pr[i] +\u003d a[i];\n\t\telse overall +\u003d a[i];\n\t}\n\t\n\tint add \u003d 0;\n\tfor (int i \u003d k - 1; i \u0026lt; n; ++i)\n\t\tadd \u003d max(add, pr[i] - (i \u0026gt;\u003d k ? pr[i - k] : 0));\n\t\n\tprintf(\u0026quot;%d\\n\u0026quot;, overall + add);\n\t\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/961/problem/C\" title\u003d\"Educational Codeforces Round 41 (Rated for Div. 2)\"\u003e961C - Chessboard\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eEditorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"961C\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (Ajosteen)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\nconst int N \u003d 109;\n\nint n;\nstring a[4][N];\n\nint main() {\n\tcin \u0026gt;\u0026gt; n;\n\tfor(int k \u003d 0; k \u0026lt; 4; ++k)\n\t\tfor(int i \u003d 0; i \u0026lt; n; ++i){\n\t\t\tcin \u0026gt;\u0026gt; a[k][i];\n\t\t\t\tfor(int j \u003d 0; j \u0026lt; n; ++j)\n\t\t\t    a[k][i][j] -\u003d \u00270\u0027;\n\t\t}\n\t\n\tvector \u0026lt;int\u0026gt; v;\n\tfor(int k \u003d 0; k \u0026lt; 4; ++k){\n\t\tint sum \u003d 0;\n\t\tfor(int i \u003d 0; i \u0026lt; n; ++i)\n\t\t\tfor(int j \u003d 0; j \u0026lt; n; ++j)\n\t\t\t\tif((i + j) % 2 !\u003d a[k][i][j])\n\t\t\t\t\t++sum;\n\t\tv.push_back(sum);\n\t}\n\t\n\tint res \u003d int(1e9);\n\tvector \u0026lt;int\u0026gt; perm;\n\tfor(int k \u003d 0; k \u0026lt; 4; ++k) perm.push_back(k);\n\tdo{\n\t\tint sum \u003d 0;\n\t\tfor(int k \u003d 0; k \u0026lt; 4; ++k){\n\t\t\tint id \u003d perm[k];\n\t\t\tif(k \u0026amp; 1)\n\t\t\t\tsum +\u003d v[id];\n\t\t\telse\n\t\t\t\tsum +\u003d n * n - v[id];\n\t\t}\n\t\t\n\t\tres \u003d min(res, sum);\n\t}while(next_permutation(perm.begin(), perm.end()));\n\n\tcout \u0026lt;\u0026lt; res \u0026lt;\u0026lt; endl;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/961/problem/D\" title\u003d\"Educational Codeforces Round 41 (Rated for Div. 2)\"\u003e961D - Pair Of Lines\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eEditorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"961D\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (adedalic)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\n#define fore(i, l, r) for(int i \u003d int(l); i \u0026lt; int(r); i++)\n\n#define all(a) (a).begin(), (a).end()\n#define sz(a) int(a.size())\n#define mp make_pair\n\n#define x first\n#define y second\n\nusing namespace std;\n\ntypedef long long li;\ntypedef pair\u0026lt;int, int\u0026gt; pt;\n\ninline pt operator -(const pt \u0026amp;a, const pt \u0026amp;b) {\n\treturn {a.x - b.x, a.y - b.y};\n}\n\ninline li cross(const pt \u0026amp;a, const pt \u0026amp;b) {\n\treturn a.x * 1ll * b.y - a.y * 1ll * b.x;\n}\n\nconst int N \u003d 200 * 1000 + 555;\n\nint n;\npt p[N];\n\ninline bool read() {\n\tif(!(cin \u0026gt;\u0026gt; n))\n\t\treturn false;\n\t\n\tfore(i, 0, n)\n\t\tscanf(\u0026quot;%d%d\u0026quot;, \u0026amp;p[i].x, \u0026amp;p[i].y);\n\treturn true;\n}\n\nbool used[N];\n\nbool check() {\n\tint i1 \u003d -1, i2 \u003d -1;\n\tfore(i, 0, n) {\n\t\tif(used[i])\n\t\t\tcontinue;\n\t\tif(i1 \u003d\u003d -1)\n\t\t\ti1 \u003d i;\n\t\telse if(i2 \u003d\u003d -1)\n\t\t\ti2 \u003d i;\n\t}\n\tif(i2 \u003d\u003d -1)\n\t\treturn true;\n\t\t\n\tfore(i, 0, n) {\n\t\tif(used[i])\n\t\t\tcontinue;\n\t\tif(cross(p[i2] - p[i1], p[i] - p[i1]) !\u003d 0)\n\t\t\treturn false;\n\t}\n\treturn true;\n}\n\nbool check2(pt a, pt b) {\n\tmemset(used, 0, sizeof used);\n\tfore(i, 0, n)\n\t\tif(cross(b - a, p[i] - a) \u003d\u003d 0)\n\t\t\tused[i] \u003d 1;\n\treturn check();\n}\n\ninline void solve() {\n\tif(n \u0026lt;\u003d 2) {\n\t\tputs(\u0026quot;YES\u0026quot;);\n\t\treturn;\n\t}\n\t\n\tif(check2(p[0], p[1]) || check2(p[0], p[2]) || check2(p[1], p[2]))\n\t\tputs(\u0026quot;YES\u0026quot;);\n\telse\n\t\tputs(\u0026quot;NO\u0026quot;);\n}\n\nint main(){\n\tif(read()) {\n\t\tsolve();\n\t}\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/961/problem/E\" title\u003d\"Educational Codeforces Round 41 (Rated for Div. 2)\"\u003e961E - Tufurama\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eEditorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"961E\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (Ajosteen)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\nconst int N \u003d 200 * 1000 + 9;\n\nint n;\nint a[N];\nint f[N];\nvector \u0026lt;int\u0026gt; v[N];\n\nvoid upd(int pos, int d){\n\tfor(; pos \u0026lt; N; pos |\u003d pos + 1)\n\t\tf[pos] +\u003d d;\n}\n\nint get(int pos){\n\tint res \u003d 0;\n\tfor(; pos \u0026gt;\u003d 0; pos \u003d (pos \u0026amp; (pos + 1)) - 1)\n\t\tres +\u003d f[pos];\n\treturn res;\n}\n\nint main() {\n\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;n);\n\tfor(int i \u003d 0; i \u0026lt; n; ++i){\n\t\tscanf(\u0026quot;%d\u0026quot;, a + i);\n\t\t--a[i];\n\t}\n\t\t\n\tfor(int i \u003d 0; i \u0026lt; n; ++i){\n\t\tif(a[i] \u0026lt; N)\n\t\t\tv[a[i]].push_back(i);\n\t\tupd(i, 1);\n\t}\n\t\n\tlong long res \u003d 0;\n\tfor(int i \u003d 0; i \u0026lt; n; ++i){\n\t\tint to \u003d min(N - 1, a[i]);\n\t\tres +\u003d get(to);\n\t\tfor(auto x : v[i])\n\t\t\tupd(x, -1);\n\t}\n\t\n\tfor(int i \u003d 0; i \u0026lt; n; ++i)\n\t    if(i \u0026lt;\u003d a[i])\n\t        --res;\n    assert(res % 2 \u003d\u003d 0);\n    \n\tcout \u0026lt;\u0026lt; res / 2 \u0026lt;\u0026lt; endl;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/961/problem/F\" title\u003d\"Educational Codeforces Round 41 (Rated for Div. 2)\"\u003e961F - k-substrings\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eEditorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"961F\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eAlternative solution (jtnydv25)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cp\u003e\u003ca href\u003d\"//codeforces.com/blog/entry/58707?#comment-423461\"\u003eComment\u003c/a\u003e\u003c/p\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (adedalic, suffix array)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\n#define fore(i, l, r) for(int i \u003d int(l); i \u0026lt; int(r); i++)\n\n#define all(a) (a).begin(), (a).end()\n#define sz(a) int(a.size())\n#define mp make_pair\n\n#define x first\n#define y second\n\nusing namespace std;\n\ntypedef pair\u0026lt;int, int\u0026gt; pt;\n\nconst int LOGN \u003d 21;\nconst int N \u003d 1000 * 1000 + 555;\n\nint n;\nstring s;\n\ninline bool read() {\n\tif(!(cin \u0026gt;\u0026gt; n))\n\t\treturn false;\n\t\n\tchar buf[N];\n\tassert(scanf(\u0026quot;%s\u0026quot;, buf) \u003d\u003d 1);\n\ts \u003d buf;\n\treturn true;\n}\n\npair\u0026lt;pt, int\u0026gt; d[N], curP[N];\nint szd \u003d 0;\n\nint cnt[N], szcnt;\nint rdp[N];\n\ninline void radix_sort() {\n\tfore(k, 0, 2) {\n\t\tszcnt \u003d 0;\n\t\tfore(i, 0, szd) {\n\t\t\tint val \u003d k \u003d\u003d 0 ? d[i].x.y : d[i].x.x;\n\t\t\twhile(szcnt \u0026lt;\u003d val)\n\t\t\t\tcnt[szcnt++] \u003d 0;\n\t\t\tcnt[val]++;\n\t\t}\n\t\tint sum \u003d 0;\n\t\tfore(i, 0, szcnt) {\n\t\t\trdp[i] \u003d sum;\n\t\t\tsum +\u003d cnt[i];\n\t\t}\n\t\t\n\t\tfore(i, 0, szd) {\n\t\t\tint val \u003d k \u003d\u003d 0 ? d[i].x.y : d[i].x.x;\n\t\t\tcurP[rdp[val]++] \u003d d[i];\n\t\t}\n\t\tfore(i, 0, szd)\n\t\t\td[i] \u003d curP[i];\n\t}\n}\n\nint c[N], id[N];\nint lcp[N];\n\nint lg[N];\nint st[LOGN][N];\n\nvoid precalc() {\n\ts +\u003d \u0027$\u0027;\n\tfor(int len \u003d 1; len \u0026lt; 2 * sz(s); len \u0026lt;\u0026lt;\u003d 1) {\n\t\tszd \u003d 0;\n\t\tfore(i, 0, sz(s)) {\n\t\t\tint sh \u003d len \u0026gt;\u0026gt; 1;\n\t\t\td[szd++] \u003d {len \u003d\u003d 1 ? mp((int)s[i], 0) : mp(c[i], c[(i + sh) % sz(s)]), i};\n\t\t}\n\t\tradix_sort();\n\t\t\n\t\tc[d[0].y] \u003d 0;\n\t\tfore(i, 1, szd)\n\t\t\tc[d[i].y] \u003d c[d[i - 1].y] + (d[i - 1].x !\u003d d[i].x);\n\t\t\n\t\tif(c[d[szd - 1].y] \u003d\u003d sz(s) - 1)\n\t\t\tbreak;\n\t}\n\t\n\tfore(i, 0, sz(s)) {\n\t\tc[i]--;\n\t\tif(c[i] \u0026gt;\u003d 0) id[c[i]] \u003d i;\n\t}\n\ts.pop_back();\n\t\n\tint l \u003d 0;\n\tfore(i1, 0, n) {\n\t\tl \u003d max(l - 1, 0);\n\t\tif(c[i1] \u003d\u003d n - 1)\n\t\t\tcontinue;\n\t\t\n\t\tint i2 \u003d id[c[i1] + 1];\n\t\twhile(i1 + l \u0026lt; n \u0026amp;\u0026amp; i2 + l \u0026lt; n \u0026amp;\u0026amp; s[i1 + l] \u003d\u003d s[i2 + l])\n\t\t\tl++;\n\t\tlcp[c[i1]] \u003d l;\n\t}\n\t\n\tlg[0] \u003d 0;\n\tfore(i, 1, N) {\n\t\tlg[i] \u003d lg[i - 1];\n\t\tif((1 \u0026lt;\u0026lt; (lg[i] + 1)) \u0026lt;\u003d i)\n\t\t\tlg[i]++;\n\t}\n\t\n\tfore(pw, 0, LOGN) {\n\t\tif(pw \u003d\u003d 0) {\n\t\t\tfore(i, 0, n)\n\t\t\t\tst[pw][i] \u003d lcp[i];\n\t\t\tcontinue;\n\t\t}\n\t\tfore(i, 0, n) {\n\t\t\tst[pw][i] \u003d st[pw - 1][i];\n\t\t\tif(i + (1 \u0026lt;\u0026lt; (pw - 1)) \u0026lt; n)\n\t\t\t\tst[pw][i] \u003d min(st[pw][i], st[pw - 1][i + (1 \u0026lt;\u0026lt; (pw - 1))]);\n\t\t}\n\t}\n}\n\ninline int getMin(int l, int r) {\n\tif(l \u0026gt;\u003d r) swap(l, r);\n\t\n\tint len \u003d lg[r - l];\n\treturn min(st[len][l], st[len][r - (1 \u0026lt;\u0026lt; len)]);\n}\n\ninline bool eq(int i1, int i2, int l) {\n\tif(i1 \u003d\u003d i2) return true;\n\treturn getMin(c[i1], c[i2]) \u0026gt;\u003d l;\n}\n\nint l[N], mx[N];\n\ninline void solve() {\n\tprecalc();\n\t\n\tfore(i, 0, n / 2) {\n\t\tint c1 \u003d i, c2 \u003d n - 1 - i;\n\t\tif(s[c1] !\u003d s[c2]) {\n\t\t\tl[i] \u003d -1;\n\t\t\tcontinue;\n\t\t}\n\t\tint lf \u003d 0, rg \u003d min(c1, n - 1 - c2) + 1;\n\t\twhile(rg - lf \u0026gt; 1) {\n\t\t\tint mid \u003d (lf + rg) \u0026gt;\u0026gt; 1;\n\t\t\t\n\t\t\tif(eq(c1 - mid, c2 - mid, 2 * mid + 1))\n\t\t\t\tlf \u003d mid;\n\t\t\telse\n\t\t\t\trg \u003d mid;\n\t\t}\n\t\tl[i] \u003d lf;\n\t}\n\t\n\tfore(i, 0, n / 2) {\n\t\tif(l[i] \u0026lt; 0)\n\t\t\tcontinue;\n\t\tmx[i - l[i]] \u003d max(mx[i - l[i]], 2 * l[i] + 1);\n\t}\n\tfore(i, 1, n / 2)\n\t\tmx[i] \u003d max(mx[i], mx[i - 1] - 2);\n\n\tfore(i, 0, (n + 1) / 2) {\n\t\tif(i) printf(\u0026quot; \u0026quot;);\n\t\tprintf(\u0026quot;%d\u0026quot;, mx[i] \u003d\u003d 0 ? -1 : mx[i]);\n\t}\n\tputs(\u0026quot;\u0026quot;);\n}\n\nint main(){\n\tif(read()) {\n\t\tsolve();\n\t}\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (adedalic, hashes)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\n#define fore(i, l, r) for(int i \u003d int(l); i \u0026lt; int(r); i++)\n\n#define all(a) (a).begin(), (a).end()\n#define sz(a) int(a.size())\n#define mp make_pair\n\n#define x first\n#define y second\n\nusing namespace std;\n\ntypedef long long li;\n\nconst li MOD \u003d li(1e18) + 3;\nconst li BASE \u003d 1009;\n\ninline li norm(li a) {\n\twhile(a \u0026gt;\u003d MOD)\n\t\ta -\u003d MOD;\n\twhile(a \u0026lt; 0)\n\t\ta +\u003d MOD;\n\treturn a;\n}\n\ninline li mul(li a, li b) {\n\tli m \u003d ((long double)(a) * b) / MOD;\n\treturn norm(a * b - m * MOD);\n}\n\nconst int N \u003d 1000 * 1000 + 555;\n\nint n;\nstring s;\n\ninline bool read() {\n\tif(!(cin \u0026gt;\u0026gt; n))\n\t\treturn false;\n\t\n\tchar buf[N];\n\tassert(scanf(\u0026quot;%s\u0026quot;, buf) \u003d\u003d 1);\n\ts \u003d buf;\n\treturn true;\n}\n\nli h[N], pw[N];\n\ninline void precalc() {\n\th[0] \u003d 0;\n\tfore(i, 0, n)\n\t\th[i + 1] \u003d norm(mul(h[i], BASE) + s[i] - \u0027a\u0027 + 1);\n\t\t\n\tpw[0] \u003d 1;\n\tfore(i, 1, N)\n\t\tpw[i] \u003d mul(pw[i - 1], BASE);\n}\n\ninline li getHash(int l, int r) {\n\treturn norm(h[r] - mul(h[l], pw[r - l]));\n}\n\ninline bool eq(int i1, int i2, int l) {\n\tif(i1 \u003d\u003d i2) return true;\n\treturn getHash(i1, i1 + l) \u003d\u003d getHash(i2, i2 + l);\n}\n\nint l[N], mx[N];\n\ninline void solve() {\n\tprecalc();\n\t\n\tfore(i, 0, n / 2) {\n\t\tint c1 \u003d i, c2 \u003d n - 1 - i;\n\t\tif(s[c1] !\u003d s[c2]) {\n\t\t\tl[i] \u003d -1;\n\t\t\tcontinue;\n\t\t}\n\t\tint lf \u003d 0, rg \u003d min(c1, n - 1 - c2) + 1;\n\t\twhile(rg - lf \u0026gt; 1) {\n\t\t\tint mid \u003d (lf + rg) \u0026gt;\u0026gt; 1;\n\t\t\t\n\t\t\tif(eq(c1 - mid, c2 - mid, 2 * mid + 1))\n\t\t\t\tlf \u003d mid;\n\t\t\telse\n\t\t\t\trg \u003d mid;\n\t\t}\n\t\tl[i] \u003d lf;\n\t}\n\t\n\tfore(i, 0, n / 2) {\n\t\tif(l[i] \u0026lt; 0)\n\t\t\tcontinue;\n\t\tmx[i - l[i]] \u003d max(mx[i - l[i]], 2 * l[i] + 1);\n\t}\n\tfore(i, 1, n / 2)\n\t\tmx[i] \u003d max(mx[i], mx[i - 1] - 2);\n\n\tfore(i, 0, (n + 1) / 2) {\n\t\tif(i) printf(\u0026quot; \u0026quot;);\n\t\tif(mx[i] \u003d\u003d 0) mx[i] \u003d -1;\n\t\tprintf(\u0026quot;%d\u0026quot;, mx[i]);\n\t}\n\tputs(\u0026quot;\u0026quot;);\n}\n\nint main(){\n\tif(read()) {\n\t\tsolve();\n\t}\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/961/problem/G\" title\u003d\"Educational Codeforces Round 41 (Rated for Div. 2)\"\u003e961G - Partitions\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eEditorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"961G\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (adedalic)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\n#define fore(i, l, r) for(int i \u003d int(l); i \u0026lt; int(r); i++)\n#define forn(i, n) fore(i, 0, n)\n\nconst int MOD \u003d int(1e9) + 7;\n\ninline int norm(int a) {\n\twhile(a \u0026gt;\u003d MOD)\n\t\ta -\u003d MOD;\n\twhile(a \u0026lt; 0)\n\t\ta +\u003d MOD;\n\treturn a;\n}\n\ninline int mul(int a, int b) {\n\treturn int((a * 1ll * b) % MOD);\n}\n\ninline int binPow(int a, int k) {\n\tint ans \u003d 1;\n\twhile(k \u0026gt; 0) {\n\t\tif(k \u0026amp; 1) ans \u003d mul(ans, a);\n\t\ta \u003d mul(a, a);\n\t\tk \u0026gt;\u0026gt;\u003d 1;\n\t}\n\treturn ans;\n}\n\nconst int N \u003d 200 * 1000 + 555;\n\nint f[N], inf[N];\n\nvoid precalc() {\n\tf[0] \u003d inf[0] \u003d 1;\n\tfore(i, 1, N) {\n\t\tf[i] \u003d mul(f[i - 1], i);\n\t\tinf[i] \u003d mul(inf[i - 1], binPow(i, MOD - 2));\n\t}\n}\n\nint n, k, w[N];\n\ninline bool read() {\n\tif(!(cin \u0026gt;\u0026gt; n \u0026gt;\u0026gt; k))\n\t\treturn false;\n\tforn(i, n)\n\t\tcin \u0026gt;\u0026gt; w[i];\n\treturn true;\n}\n\ninline int c(int n, int k) {\n\tif(k \u0026gt; n || n \u0026lt; 0) return 0;\n\tif(k \u003d\u003d 0 || n \u003d\u003d k) return 1;\n\t\n\treturn mul(f[n], mul(inf[n - k], inf[k]));\n}\n\ninline int s(int n, int k) {\n\tif(n \u003d\u003d 0) return k \u003d\u003d 0;\n\tif(k \u003d\u003d 0) return n \u003d\u003d 0;\n\t\n\tint ans \u003d 0, sg[2] \u003d {1, MOD - 1};\n\tforn(cnt, k)\n\t\tans \u003d norm(ans + mul(sg[cnt \u0026amp; 1], mul(c(k, cnt), binPow(k - cnt, n))));\n\treturn mul(ans, inf[k]);\n}\n\ninline void solve() {\n\tint sum \u003d 0;\n\tforn(i, n)\n\t\tsum \u003d norm(sum + w[i]);\n\t\t\n\tint s0 \u003d s(n, k);\n\tint s1 \u003d mul(n - 1, s(n - 1, k));\n\t\n\tcout \u0026lt;\u0026lt; mul(sum, norm(s0 + s1)) \u0026lt;\u0026lt; endl;\n}\n\nint main() {\n#ifdef _DEBUG\n\tfreopen(\u0026quot;input.txt\u0026quot;, \u0026quot;r\u0026quot;, stdin);\n#endif\n\tprecalc();\n\t\n\tassert(read());\n\tsolve();\n\n#ifdef _DEBUG\n\tcerr \u0026lt;\u0026lt; \u0026quot;TIME \u003d \u0026quot; \u0026lt;\u0026lt; clock() \u0026lt;\u0026lt; endl;\n#endif\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e","tags":[]}}