{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1503003775,"rating":202,"authorHandle":"Nisiyama_Suzune","modificationTimeSeconds":1504077904,"id":53925,"title":"\u003cp\u003e[Tutorial] Math note — Möbius inversion\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eIf you\u0027ve ever taken some lessons on competitive programming, chances are that you have already heard about one of the most famous formula: the Möbius inversion. This article is aimed to provide some basic insight on what is the Möbius inversion, as well as how to apply it in various programming tasks.\u003c/p\u003e\u003ch1\u003ePrequisite\u003c/h1\u003e\u003cp\u003eIf you are not familiar with the linear sieve and multiplicative functions, it is recommended that you read about them first \u003ca href\u003d\"//codeforces.com/blog/entry/54090\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eI will introduce some frequently used notations and lemmas first.\u003c/p\u003e\u003ch2\u003eNotation\u003c/h2\u003e \u003col\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003eP\u003c/i\u003e]\u003c/span\u003e refers to the boolean expression, i.e. \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003eP\u003c/i\u003e] \u003d 1\u003c/span\u003e when \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eP\u003c/i\u003e\u003c/span\u003e is true, and \u003cspan class\u003d\"tex-span\"\u003e0\u003c/span\u003e otherwise.\u003c/li\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e⌊ \u003ci\u003ex\u003c/i\u003e⌋\u003c/span\u003e refers to rounding \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e down to the nearest integer. Thus \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/7b/4d/7b4ddcab99fda98adfec7cad04c0ce4b2810a327.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e refers to the integer division.\u003c/li\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e|\u003ci\u003en\u003c/i\u003e\u003c/span\u003e means that d can divide n (without a remainder).\u003c/li\u003e \u003c/ol\u003e\u003cp\u003eThe following functions are all multiplicative functions, where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e is a prime number and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e is a positive integer.\u003c/p\u003e \u003col\u003e   \u003cli\u003eThe constant function \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eI\u003c/i\u003e(\u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sup\u003e) \u003d 1\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003eThe identity function \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eId\u003c/i\u003e(\u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sup\u003e) \u003d \u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sup\u003e\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003eThe power function \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eId\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/sub\u003e(\u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sup\u003e) \u003d \u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003eak\u003c/i\u003e\u003c/sup\u003e\u003c/span\u003e, where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/span\u003e is constant.\u003c/li\u003e   \u003cli\u003eThe unit function \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/89/ec/89ecdb085e355f5292cf0ab56666290971639dae.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/li\u003e   \u003cli\u003eThe divisor function \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/9a/8e/9a8e85f82fa3922c4741d54591fa2a538171b513.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, denoting the sum of the \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/span\u003e-th powers of all the positive divisors of the number.\u003c/li\u003e   \u003cli\u003e\u003ca href\u003d\"https://en.wikipedia.org/wiki/M%C3%B6bius_function\"\u003eThe Möbius function\u003c/a\u003e \u003cspan class\u003d\"tex-span\"\u003eμ(\u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sup\u003e) \u003d [\u003ci\u003ek\u003c/i\u003e \u003d 0] - [\u003ci\u003ek\u003c/i\u003e \u003d 1]\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003e\u003ca href\u003d\"https://en.wikipedia.org/wiki/Euler%27s_totient_function\"\u003eThe Euler\u0027s totient function\u003c/a\u003e \u003cspan class\u003d\"tex-span\"\u003eφ(\u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sup\u003e) \u003d \u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sup\u003e - \u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e - 1\u003c/sup\u003e\u003c/span\u003e.\u003c/li\u003e \u003c/ol\u003e\u003ch2\u003eLemma\u003c/h2\u003e\u003cp\u003eI have some my unofficial names for these frequently used conclusions. If you happen to know any more commonly used name for them, you are more than welcome to tell me.\u003c/p\u003e \u003cul\u003e   \u003cli\u003e( \u003cstrong\u003eThe integer division lemma\u003c/strong\u003e ) For every positive integer \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eq\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e, \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/c0/3f/c03f459f2b52101b5aa45aac01c0291f5aee1f94.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eProof: We know that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/04/d4/04d4918e3faebf3b416090737357cff141062265.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Hence \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/62/0d/620d7c09d74d5086d5974cadc55167f7e83fd00d.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Since the fraction part of \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/8d/8b/8d8bf124608da072154b42bdcacd8ec38f316725.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e cannot exceed \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/63/74/6374b1363b501fd5b83189ab9d799d76c90e9492.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, we achieve the conclusion.\u003c/p\u003e \u003cul\u003e   \u003cli\u003e( \u003cstrong\u003eThe harmonic lemma\u003c/strong\u003e ) Consider the harmonic sequence on integer division \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/bf/23/bf23ecdf9777520ef715cc2aca59db9d9f7c7234.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/li\u003e \u003c/ul\u003e \u003col\u003e   \u003cli\u003eThe sequence is non-increasing, and there are at most \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/23/25/23252b0fc4d48df9962f8b56307b87565eba520a.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e different elements.\u003c/li\u003e   \u003cli\u003eThe sum of the sequence is approximate to \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/e7/0f/e70fbdc8079c0b9ff4f31073012937bac199bc6b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/li\u003e \u003c/ol\u003e\u003cp\u003eProof: Denote \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/90/5e/905e20db785fadaabc1066f36ae37763846b7055.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. For every \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e not exceeding \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/4e/5c/4e5c9f371024ad4e1f5b0f2dfeb967ffe7cb5f4e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, there will be no more than \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/4e/5c/4e5c9f371024ad4e1f5b0f2dfeb967ffe7cb5f4e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e values in the domain of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e)\u003c/span\u003e, so there can be at most \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/4e/5c/4e5c9f371024ad4e1f5b0f2dfeb967ffe7cb5f4e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e different values for \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e)\u003c/span\u003e. For the rest part of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e greater than \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/4e/5c/4e5c9f371024ad4e1f5b0f2dfeb967ffe7cb5f4e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, we can infer that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/c9/50/c950c47126b44a4c1ab3677d4e116097e33cd649.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and is a positive integer, so there can be at most \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/4e/5c/4e5c9f371024ad4e1f5b0f2dfeb967ffe7cb5f4e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e different values for \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e)\u003c/span\u003e. Therefore we know that there are at most \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/23/25/23252b0fc4d48df9962f8b56307b87565eba520a.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e different elements in the sequence.\u003c/p\u003e\u003cp\u003eSince \u003ca href\u003d\"https://en.wikipedia.org/wiki/Euler%E2%80%93Mascheroni_constant\"\u003ethe Euler–Mascheroni constant\u003c/a\u003e states that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/4f/26/4f26f640ae5677eccc28eb3a430adc66b196db68.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, we know that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/1c/89/1c89f24a93762d0cc020355e38f12b1c1656111b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, so the sum of the original sequence is approximate to \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/e7/0f/e70fbdc8079c0b9ff4f31073012937bac199bc6b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/p\u003e\u003cp\u003eMoreover, it is actually possible to exploit the property that the sequence has at most \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/23/25/23252b0fc4d48df9962f8b56307b87565eba520a.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e different elements, and write a loop that runs in \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/32/91/32913ddf691f31b4d68f1a13d186d75779229920.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e complexity to iterate through every possible value of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e)\u003c/span\u003e, using the fact that the greatest integer \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e satisfying \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e) \u003d \u003ci\u003ed\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e)\u003c/span\u003e is \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/e8/f3/e8f3a4db15b8e535bb0d0a351bbe109fbe0b4016.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. The piece of code below demonstrates one way to program it.\u003c/p\u003e \u003cpre\u003e\u003ccode\u003efor (int i \u003d 1, la; i \u0026lt;\u003d n; i \u003d la + 1) {\n\tla \u003d n / (n / i);\n\t//n / x yields the same value for i \u0026lt;\u003d x \u0026lt;\u003d la.\n}\n\u003c/code\u003e\u003c/pre\u003e \u003cul\u003e   \u003cli\u003e( \u003cstrong\u003eThe transitive property of multiplicative functions\u003c/strong\u003e )\u003c/li\u003e \u003c/ul\u003e \u003col\u003e   \u003cli\u003eIf both \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e are multiplicative, then \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e) \u003d \u003ci\u003ef\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e)\u003ci\u003eg\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e is also multiplicative.\u003c/li\u003e   \u003cli\u003eIf both \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e are multiplicative, then their \u003ca href\u003d\"https://en.wikipedia.org/wiki/Dirichlet_convolution\"\u003eDirichlet convolution\u003c/a\u003e \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/a3/46/a346ea369201601e663b991789249ad7fb19447e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e is also multiplicative. Specifically, if \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e is multiplicative, \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/df/95/df95ba637cb69352369950069c5655752072eab5.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e is also multiplicative.\u003c/li\u003e \u003c/ol\u003e\u003cp\u003eThe proof is more mathematical, which I will skip here.\u003c/p\u003e\u003ch1\u003eWhat is the Möbius inversion?\u003c/h1\u003e\u003cp\u003eAccording to \u003ca href\u003d\"https://en.wikipedia.org/wiki/M%C3%B6bius_inversion_formula\"\u003eWikipedia\u003c/a\u003e, the Möbius inversion states that:\u003c/p\u003e\u003cp\u003eIf \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/b8/4d/b84dfc4a2b5967585bd7af9971a6f18fa388240c.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e for every positive integer \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e, then \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/37/7e/377ebc47ef0bd00a6d08ba935dfcc2bbf0712e64.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, where \u003cspan class\u003d\"tex-span\"\u003eμ(\u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e is the Möbius function, which is multiplicative and satisfies \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(1) \u003d 1, \u003ci\u003ef\u003c/i\u003e(\u003ci\u003ep\u003c/i\u003e) \u003d  - 1, \u003ci\u003ef\u003c/i\u003e(\u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sup\u003e) \u003d 0\u003c/span\u003e for any prime number \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e and any integer \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e ≥ 2\u003c/span\u003e. ( \u003cem\u003eIt is worth noting that you can pre-compute all values of the Möbius function from \u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e using the linear sieve.\u003c/em\u003e )\u003c/p\u003e\u003cp\u003eHowever, the definition alone does not mean much (unless the problem statement explicitly gives you something like \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/b8/4d/b84dfc4a2b5967585bd7af9971a6f18fa388240c.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. In that case, well...). There is one important property that is probably more useful than the definition:\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/20/cf/20cf0a8fa15c1d9a0e7e94bc896d7a835f138d02.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eIn order to prove this property, we have to use the transitive property of multiplicative functions to show that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/b8/fa/b8fab94e2745c19df8ed3cbd3318175be2950488.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e is multiplicative. After that, we can see \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(1) \u003d 1\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sup\u003e) \u003d 0\u003c/span\u003e, which means \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e) \u003d ε(\u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e. Now you may ask: why is this property important? I think it is best to show the reasons in some basic examples below.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eExample 1.\u003c/strong\u003e Find out the number of co-prime pairs of integer \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e in range \u003cspan class\u003d\"tex-span\"\u003e[1, \u003ci\u003en\u003c/i\u003e]\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eSolution 1.\u003c/strong\u003e Notice that the question is the same as asking you the value of\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/6c/10/6c107924b4bbbaaa8b5ad1730765145d2de3fa48.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eNow apply the Möbius inversion on \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003egcd\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)] \u003d 1\u003c/span\u003e, we have\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/c5/a7/c5a7a993c183446ff88926b86ad986e80b72c34b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003ewhich is the same as\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/01/fa/01facf88de9ab1e7ad0ca0236124885a823b7f36.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eNotice that \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003ed\u003c/i\u003e|\u003ci\u003egcd\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)] \u003d [\u003ci\u003ed\u003c/i\u003e|\u003ci\u003ei\u003c/i\u003e][\u003ci\u003ed\u003c/i\u003e|\u003ci\u003ej\u003c/i\u003e]\u003c/span\u003e. Therefore\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/ab/f1/abf15e8c95746752aa18db8b521d3898b083c477.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eWe can change the order of summing things up, so\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/37/1a/371a3956cd380624d2d2611118478e0ddccf7618.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eWe know that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/f1/7f/f17f509cbadc7aed264c738d55fe4bcd4a72f01c.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Thus\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/b6/65/b665dac1860ef3adae9a3cd17e6f336cfd200d98.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eThen we can simply loop through \u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e to compute the formula. While we can optimize this loop to \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/32/91/32913ddf691f31b4d68f1a13d186d75779229920.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e using the harmonic lemma, we still have to use the linear sieve to pre-compute the values of \u003cspan class\u003d\"tex-span\"\u003eμ(\u003ci\u003ed\u003c/i\u003e)\u003c/span\u003e. Therefore, the overall complexity of the algorithm is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eExample 2.\u003c/strong\u003e Find out the sum of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003egcd\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e for every pair of integer \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e in range \u003cspan class\u003d\"tex-span\"\u003e[1, \u003ci\u003en\u003c/i\u003e]\u003c/span\u003e (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003egcd\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e means the greatest common divisor of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ey\u003c/i\u003e\u003c/span\u003e).\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eSolution 2.\u003c/strong\u003e Similar as above, notice that the question is the same as asking you the value of\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/3d/b4/3db464e3c690b6e33a7f2c98799aad9d54824f18.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eLet \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e \u003d \u003ci\u003egcd\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e. We can then loop for \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e first.\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/73/1c/731cdf874e96e68cbaf9c0799ec2f1f0a7ad6a5b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eNow assume \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e \u003d \u003ci\u003eak\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e \u003d \u003ci\u003ebk\u003c/i\u003e\u003c/span\u003e, and then\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/65/58/65583ee05d3afde23fe5a72e4b868e93ecaf83bf.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eIt can be observed that the last part of the formula is the same as the one in example 1. Applying the same procedure, we have\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/57/7e/577e38115436b17a34e523b54fc54d6fd49eaf74.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eAccording to the harmonic lemma, \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/77/5b/775bfd9245aa840ca745228bcb3079e472728bd9.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Therefore, if we compute the sum above with brute force, the overall complexity will be \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/e7/0f/e70fbdc8079c0b9ff4f31073012937bac199bc6b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/p\u003e\u003cp\u003eThis is, however, not the best complexity we can achieve with the Möbius inversion. Now let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e \u003d \u003ci\u003ekd\u003c/i\u003e\u003c/span\u003e, and we can loop for \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e first.\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/93/72/93725af19c3bee5424d9bf53c5abf403644e80d3.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eApplying the transitive property of multiplicative functions, we can see that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/ed/cf/edcfff7cc47737bcfc878fbb81d62e1a14f41796.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e is multiplicative. Moreover, we have \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(\u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sup\u003e) \u003d \u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sup\u003e - \u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e - 1\u003c/sup\u003e\u003c/span\u003e. If you have somewhat studied about the number theory, you may figure out that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(\u003ci\u003el\u003c/i\u003e)\u003c/span\u003e is actually the Euler\u0027s totient function. Regardless of whether you know about the coincidence or not, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(\u003ci\u003el\u003c/i\u003e)\u003c/span\u003e can be pre-computed with the linear sieve, and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/c9/b7/c9b7f5c5e9dd17474b941e3a0dbbfb297baf5367.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, which can be simply computed in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e)\u003c/span\u003e complexity.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eExample 3.\u003c/strong\u003e Find out the sum of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003elcm\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e for every pair of integer \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e in range \u003cspan class\u003d\"tex-span\"\u003e[1, \u003ci\u003en\u003c/i\u003e]\u003c/span\u003e (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003elcm\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e means the least common multiple of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ey\u003c/i\u003e\u003c/span\u003e).\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eSolution 3.\u003c/strong\u003e Well, we should be pretty familiar with the techniques by now. First of all, the answer should be\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/7f/7d/7f7d573301a63ee2e51ce2c26853edca3c432cf9.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eSince \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/7a/2b/7a2b465fbfd3de64850140956a45c3a5ff30763c.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e \u003d \u003ci\u003egcd\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e. We can then loop for \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e first.\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/c2/29/c22920abc03ad41fa522080aae2a83245916f3e2.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eNow assume \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e \u003d \u003ci\u003eak\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e \u003d \u003ci\u003ebk\u003c/i\u003e\u003c/span\u003e, and then\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/9e/8e/9e8ec1437edc72af398f3fe13c4f18f7a10057b2.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eNow let\u0027s proceed to assume \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e \u003d \u003ci\u003edp\u003c/i\u003e, \u003ci\u003eb\u003c/i\u003e \u003d \u003ci\u003edq\u003c/i\u003e\u003c/span\u003e, then\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/c2/98/c29870584f2132e0904e114ccecb21bb97e96fd5.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eNow notice \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/af/c2/afc253d3dbb438a20e3b4539145ab963a27141f6.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, and we have\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/83/88/83888beb94889ab278de53dd46582ea5752a1cb8.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eNow following the example above, let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e \u003d \u003ci\u003ekd\u003c/i\u003e\u003c/span\u003e, and then\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/5f/8c/5f8cdf43042e5460768be02116ef61a53ef3ff49.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eNotice that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/82/ca/82ca782443e2ad741dd3fab23985409d5229d4a3.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e is also multiplicative, and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(\u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sup\u003e) \u003d \u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sup\u003e - \u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e + 1\u003c/sup\u003e\u003c/span\u003e. We can pre-compute the values of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(\u003ci\u003el\u003c/i\u003e)\u003c/span\u003e via the linear sieve, and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/a2/cb/a2cb2ad35cbcbb96a099abb8a9a65c0d8bb094b2.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. The overall complexity will be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003ch1\u003ePractice Problems\u003c/h1\u003e\u003ch2\u003eSimple Sum\u003c/h2\u003e\u003cp\u003e(Thanks \u003ca class\u003d\"rated-user user-violet\" href\u003d\"/profile/_threat_\" title\u003d\"Кандидат в мастера _threat_\"\u003e_threat_\u003c/a\u003e for showing me this one!)\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"https://www.codechef.com/NOV15/problems/SMPLSUM\"\u003eLink\u003c/a\u003e\u003c/p\u003e\u003ch2\u003eGCD\u003c/h2\u003e\u003cp\u003e\u003ca href\u003d\"http://acm.hdu.edu.cn/showproblem.php?pid\u003d1695\"\u003eLink\u003c/a\u003e\u003c/p\u003e\u003ch2\u003eSky Code\u003c/h2\u003e\u003cp\u003e\u003ca href\u003d\"http://poj.org/problem?id\u003d3904\"\u003eLink\u003c/a\u003e\u003c/p\u003e\u003ch1\u003eExtensions\u003c/h1\u003e\u003cp\u003eIt is known that all examples above can be further optimized to \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/14/e7/14e77072409139a62fc0c967bc104bd1f965fa87.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. The exact technique will (probably) be introduced in the upcoming article.\u003c/p\u003e\u003cp\u003e\u003cem\u003eUpdate: The article introducing the optimization is ready \u003ca href\u003d\"//codeforces.com/blog/entry/54150\"\u003ehere\u003c/a\u003e.\u003c/em\u003e\u003c/p\u003e\u003cp\u003e\u003cem\u003eFinally, thanks \u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/Tommyr7\" title\u003d\"Мастер Tommyr7\"\u003eTommyr7\u003c/a\u003e for his effort in the article!\u003c/em\u003e\u003c/p\u003e\u003c/div\u003e","tags":["math","mobius inversion formula","mobius function","tutorial"]}}