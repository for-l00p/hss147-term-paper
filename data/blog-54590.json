{"status":"OK","result":{"originalLocale":"en","allowViewHistory":true,"creationTimeSeconds":1505671041,"rating":88,"authorHandle":"mohammedehab2002","modificationTimeSeconds":1509148377,"id":54590,"title":"\u003cp\u003eCodeforces round #435 editorial\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003e\u003ca href\u003d\"/contest/862/problem/A\" title\u003d\"Codeforces Round 435 (Div. 2)\"\u003e862A - Махмуд, Ехаб и MEX\u003c/a\u003e\u003c/p\u003e\u003cp\u003eOne can see that in the final set all the elements less than \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e should exist, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e shouldn\u0027t exist and any element greater than \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e doesn\u0027t matter, so we will count the number of elements less than \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e that don\u0027t exist in the initial set and add this to the answer, If \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e exists we\u0027ll add 1 to the answer because \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e should be removed .\u003c/p\u003e\u003cp\u003eTime complexity : \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e + \u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e .\u003c/p\u003e\u003cp\u003eSolution link (me) : \u003ca href\u003d\"https://pastebin.com/ALfcu8Ab\"\u003ehttps://pastebin.com/ALfcu8Ab\u003c/a\u003e .\u003c/p\u003e\u003cp\u003eSolution link (\u003ca class\u003d\"rated-user user-violet\" href\u003d\"/profile/mahmoudbadawy\" title\u003d\"Кандидат в мастера mahmoudbadawy\"\u003emahmoudbadawy\u003c/a\u003e) : \u003ca href\u003d\"https://pastebin.com/yXLkmA5F\"\u003ehttps://pastebin.com/yXLkmA5F\u003c/a\u003e .\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/862/problem/B\" title\u003d\"Codeforces Round 435 (Div. 2)\"\u003e862B - Махмуд, Ехаб и двудольность\u003c/a\u003e\u003c/p\u003e\u003cp\u003eThe tree itself is bipartite so we can run a dfs to partition the tree into the 2 sets (called bicoloring), We can\u0027t add an edge between any 2 nodes in the same set and we can add an edge between every 2 nodes in different sets, so let the number of nodes in the left set be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e and the number of nodes in the right set be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e, The maximum number of edges that can exist is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e * \u003ci\u003er\u003c/i\u003e\u003c/span\u003e, but \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e - 1\u003c/span\u003e edges already exist so the maximum number of edges to be added is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e * \u003ci\u003er\u003c/i\u003e - (\u003ci\u003en\u003c/i\u003e - 1)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eTime complexity : \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e)\u003c/span\u003e .\u003c/p\u003e\u003cp\u003eSolution link (me) : \u003ca href\u003d\"https://pastebin.com/w3bF7gKS\"\u003ehttps://pastebin.com/w3bF7gKS\u003c/a\u003e .\u003c/p\u003e\u003cp\u003eSolution link (\u003ca class\u003d\"rated-user user-violet\" href\u003d\"/profile/mahmoudbadawy\" title\u003d\"Кандидат в мастера mahmoudbadawy\"\u003emahmoudbadawy\u003c/a\u003e) : \u003ca href\u003d\"https://pastebin.com/PMpte7nC\"\u003ehttps://pastebin.com/PMpte7nC\u003c/a\u003e .\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/862/problem/C\" title\u003d\"Codeforces Round 435 (Div. 2)\"\u003e862C - Махмуд, Ехаб и xor\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e \u003d 2, \u003ci\u003ex\u003c/i\u003e \u003d 0\u003c/span\u003e is the only case with answer \u0026quot;NO\u0026quot; .\u003c/p\u003e\u003cp\u003eLet \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003epw\u003c/i\u003e \u003d 2\u003csup class\u003d\"upper-index\"\u003e17\u003c/sup\u003e\u003c/span\u003e .\u003c/p\u003e\u003cp\u003eFirst print \u003cspan class\u003d\"tex-span\"\u003e1, 2, ..., \u003ci\u003en\u003c/i\u003e - 3\u003c/span\u003e (The first \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e - 3\u003c/span\u003e positive integers), Let their bitwise-xor sum be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ey\u003c/i\u003e\u003c/span\u003e, If \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e \u003d \u003ci\u003ey\u003c/i\u003e\u003c/span\u003e You can add \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003epw\u003c/i\u003e, \u003ci\u003epw\u003c/i\u003e * 2\u003c/span\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/e2/e0/e2e086ba22101401e2a7b71f071fe501855e2884.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, Otherwise you can add \u003cspan class\u003d\"tex-span\"\u003e0, \u003ci\u003epw\u003c/i\u003e\u003c/span\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/aa/e3/aae36921b15321d7be689ad2ed055eab1e9b1609.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, We handled the case \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e \u003d \u003ci\u003ey\u003c/i\u003e\u003c/span\u003e in a different way because if we add \u003cspan class\u003d\"tex-span\"\u003e0, \u003ci\u003epw\u003c/i\u003e\u003c/span\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/aa/e3/aae36921b15321d7be689ad2ed055eab1e9b1609.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e in this case, Then it\u0027s like adding \u003cspan class\u003d\"tex-span\"\u003e0, \u003ci\u003epw\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003epw\u003c/i\u003e\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003epw\u003c/i\u003e\u003c/span\u003e appears twice so we\u0027ll get wrong answer.\u003c/p\u003e\u003cp\u003eHandle \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e \u003d 1\u003c/span\u003e (print \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e) and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e \u003d 2\u003c/span\u003e (print \u003cspan class\u003d\"tex-span\"\u003e0\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e) .\u003c/p\u003e\u003cp\u003eSolution link (\u003ca class\u003d\"rated-user user-violet\" href\u003d\"/profile/mahmoudbadawy\" title\u003d\"Кандидат в мастера mahmoudbadawy\"\u003emahmoudbadawy\u003c/a\u003e) : \u003ca href\u003d\"https://pastebin.com/w67KUY5u\"\u003ehttps://pastebin.com/w67KUY5u\u003c/a\u003e .\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/862/problem/D\" title\u003d\"Codeforces Round 435 (Div. 2)\"\u003e862D - Махмуд, Ехаб и бинарная строка\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eIn the editorial we suppose that the answer of some query is the number of correct guessed positions which is equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e minus hamming distance, The solutions in this editorial consider the answer of a query as \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e minus real answer, For convenience.\u003c/strong\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eCommon things\u003c/strong\u003e : Let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ezero\u003c/i\u003e(\u003ci\u003el\u003c/i\u003e, \u003ci\u003er\u003c/i\u003e)\u003c/span\u003e be a function that returns the number of zeros in the interval \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e;\u003ci\u003er\u003c/i\u003e]\u003c/span\u003e minus the number of ones in it, We can find it in one query after a preprocessing query, The preprocessing query is \u003cspan class\u003d\"tex-span\"\u003e1111...\u003c/span\u003e, Let its answer be stored in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eall\u003c/i\u003e\u003c/span\u003e, If we made a query with a string full of ones except for the interval \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e;\u003ci\u003er\u003c/i\u003e]\u003c/span\u003e which will be full of zeros, If this query\u0027s answer is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ecur\u003c/i\u003e\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ezero\u003c/i\u003e(\u003ci\u003el\u003c/i\u003e, \u003ci\u003er\u003c/i\u003e) \u003d \u003ci\u003ecur\u003c/i\u003e - \u003ci\u003eall\u003c/i\u003e\u003c/span\u003e, That\u0027s because \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eall\u003c/i\u003e\u003c/span\u003e is the number of ones in the interval \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e;\u003ci\u003er\u003c/i\u003e]\u003c/span\u003e plus some trash and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ecur\u003c/i\u003e\u003c/span\u003e is the number of zeros in the interval plus the same trash .\u003c/p\u003e\u003ch4\u003eFirst solution by \u003ca class\u003d\"rated-user user-violet\" href\u003d\"/profile/mahmoudbadawy\" title\u003d\"Кандидат в мастера mahmoudbadawy\"\u003emahmoudbadawy\u003c/a\u003e\u003c/h4\u003e\u003cp\u003eLet\u0027s have a searching interval, initially this interval is \u003cspan class\u003d\"tex-span\"\u003e[1;\u003ci\u003en\u003c/i\u003e]\u003c/span\u003e (The whole string), Let\u0027s repeat this until we reach our goal, Let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emid\u003c/i\u003e \u003d (\u003ci\u003el\u003c/i\u003e + \u003ci\u003er\u003c/i\u003e) / 2\u003c/span\u003e Let\u0027s query to get \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ezero\u003c/i\u003e(\u003ci\u003el\u003c/i\u003e, \u003ci\u003emid\u003c/i\u003e)\u003c/span\u003e, If it\u0027s equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e - \u003ci\u003el\u003c/i\u003e + 1\u003c/span\u003e, This interval is full of zeros so we can print any index in it as the index with value 0 and continue searching for an index with the value 1 in the interval \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003emid\u003c/i\u003e + 1;\u003ci\u003er\u003c/i\u003e]\u003c/span\u003e, But if its value is equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e - \u003ci\u003er\u003c/i\u003e - 1\u003c/span\u003e, This interval is full of ones so we can print any index in it as the index with value 1 and continue searching for a 0 in the interval \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003emid\u003c/i\u003e + 1;\u003ci\u003er\u003c/i\u003e]\u003c/span\u003e, Otherwise the interval contains both values so we can continue searching for both in the interval \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e;\u003ci\u003emid\u003c/i\u003e]\u003c/span\u003e, Every time the searching interval length must be divided by 2 in any case so we perform \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003elog\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e))\u003c/span\u003e queries .\u003c/p\u003e\u003ch4\u003eSecond solution by me\u003c/h4\u003e\u003cp\u003eLet\u0027s send \u003cspan class\u003d\"tex-span\"\u003e1111...\u003c/span\u003e and let the answer be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eans\u003c/i\u003e1\u003c/span\u003e, Let\u0027s send \u003cspan class\u003d\"tex-span\"\u003e0111...\u003c/span\u003e and let the answer be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eans\u003c/i\u003e0\u003c/span\u003e, We now know the value in the first index (1 if \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eans\u003c/i\u003e1 \u0026gt; \u003ci\u003eans\u003c/i\u003e0\u003c/span\u003e, 0 otherwise), We can binary search for the first index where the non-found value exists, which is to binary search on the first value \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ezero\u003c/i\u003e(2, \u003ci\u003ex\u003c/i\u003e) * \u003ci\u003esign\u003c/i\u003e(\u003ci\u003enon\u003c/i\u003e - \u003ci\u003efound\u003c/i\u003e\u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ebit\u003c/i\u003e\u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003evalue\u003c/i\u003e) ≠ \u003ci\u003ex\u003c/i\u003e - 1\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003esign\u003c/i\u003e(\u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e is \u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e if \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ey\u003c/i\u003e \u003d 0\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e - 1\u003c/span\u003e otherwise .\u003c/p\u003e\u003cp\u003eSolution link (me) : \u003ca href\u003d\"https://pastebin.com/Bc6q7TKv\"\u003ehttps://pastebin.com/Bc6q7TKv\u003c/a\u003e .\u003c/p\u003e\u003cp\u003eSolution link (\u003ca class\u003d\"rated-user user-violet\" href\u003d\"/profile/mahmoudbadawy\" title\u003d\"Кандидат в мастера mahmoudbadawy\"\u003emahmoudbadawy\u003c/a\u003e) : \u003ca href\u003d\"https://pastebin.com/RMyLDMxw\"\u003ehttps://pastebin.com/RMyLDMxw\u003c/a\u003e .\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/862/problem/E\" title\u003d\"Codeforces Round 435 (Div. 2)\"\u003e862E - Махмуд, Ехаб и функция\u003c/a\u003e\u003c/p\u003e\u003cp\u003eLet\u0027s write \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e in another way:-\u003c/p\u003e\u003cp\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/a6/a6/a6a63e05b22a13c3022d6ebe94db7283d64a0d48.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/da/f9/daf97b1fb8207638fa6b409d1b437464cde689dd.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eNow we have 2 sums, The first one is constant (doesn\u0027t depend on \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e), For the second sum we can calculate all its possible values using sliding window technique, Now we want a data-structure that takes the value of the first sum and chooses the best second sum from all the choices .\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eobservation:\u003c/strong\u003e We don\u0027t have to try all the possible values of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e to minimize the expression, If the first sum is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003c/span\u003e, We can try only the least value greater than \u003cspan class\u003d\"tex-span\"\u003e - \u003ci\u003ec\u003c/i\u003e\u003c/span\u003e and the greatest value less than \u003cspan class\u003d\"tex-span\"\u003e - \u003ci\u003ec\u003c/i\u003e\u003c/span\u003e (\u003cspan class\u003d\"tex-span\"\u003e - \u003ci\u003ec\u003c/i\u003e\u003c/span\u003e not \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003c/span\u003e because we are minimizing \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e + \u003ci\u003esecond\u003c/i\u003e\u003c/span\u003e not \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e - \u003ci\u003esecond\u003c/i\u003e\u003c/span\u003e) because the absolute value means the distance between the two values on the number line, Any other value will be further than at least one of the chosen values, To do this we can keep all the values of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e sorted and try the elements numbered \u003ccode\u003elower_bound(-c)\u003c/code\u003e and \u003ccode\u003elower_bound(-c)-1\u003c/code\u003e and choose the better (In short we\u0027re trying the values close to \u003cspan class\u003d\"tex-span\"\u003e - \u003ci\u003ec\u003c/i\u003e\u003c/span\u003e only).\u003c/p\u003e\u003cp\u003eNow we have a data-structure that can get us the minimum value of the expression once given the value of the first sum in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003elog\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e))\u003c/span\u003e, Now we want to keep track of the value of the first sum .\u003c/p\u003e\u003cp\u003eLet the initial value be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003c/span\u003e, In each update, If the length of the updated interval is even, The sum won\u0027t change because \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e will be added as many times as it\u0027s subtracted, Otherwise \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e will be added to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003c/span\u003e or subtracted from \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003c/span\u003e depending of the parity of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e (the left-bound of the interval) .\u003c/p\u003e\u003cp\u003eTime complexity : \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e + (\u003ci\u003em\u003c/i\u003e + \u003ci\u003eq\u003c/i\u003e)\u003ci\u003elog\u003c/i\u003e(\u003ci\u003em\u003c/i\u003e))\u003c/span\u003e .\u003c/p\u003e\u003cp\u003eSolution link (me) : \u003ca href\u003d\"https://pastebin.com/u828DjcS\"\u003ehttps://pastebin.com/u828DjcS\u003c/a\u003e .\u003c/p\u003e\u003cp\u003eSolution link (\u003ca class\u003d\"rated-user user-violet\" href\u003d\"/profile/mahmoudbadawy\" title\u003d\"Кандидат в мастера mahmoudbadawy\"\u003emahmoudbadawy\u003c/a\u003e) : \u003ca href\u003d\"https://pastebin.com/dA3K8nfK\"\u003ehttps://pastebin.com/dA3K8nfK\u003c/a\u003e .\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/862/problem/F\" title\u003d\"Codeforces Round 435 (Div. 2)\"\u003e862F - Махмуд, Ехаб и последнее испытание\u003c/a\u003e\u003c/p\u003e\u003cp\u003eFirst, Let\u0027s get rid of the \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eLCP\u003c/i\u003e\u003c/span\u003e part .\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eobservation:\u003c/strong\u003e \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/1c/da/1cda3b528a9d9d48d5bc8f6787a4ab12380e8956.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, That could make us transform the \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eLCP\u003c/i\u003e\u003c/span\u003e part into a minimization part by making an array \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003elcp\u003c/i\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003elcp\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e \u003d \u003ci\u003eLCP\u003c/i\u003e(\u003ci\u003es\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e, \u003ci\u003es\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e + 1\u003c/sub\u003e)\u003c/span\u003e, You could calculate it naively, And when an update happens at index \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/span\u003e, You should update \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003elcp\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e (If exists) and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003elcp\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ea\u003c/i\u003e - 1\u003c/sub\u003e\u003c/span\u003e (If exists) naively .\u003c/p\u003e\u003cp\u003eNow the problem reduces to finding \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e ≤ \u003ci\u003el\u003c/i\u003e ≤ \u003ci\u003er\u003c/i\u003e ≤ \u003ci\u003eb\u003c/i\u003e\u003c/span\u003e that maximizes the value:-\u003c/p\u003e\u003cp\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/8e/cf/8ecfb556606a5d010342e69b8985ee178986ed34.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, If we have a histogram where the \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003eth\u003c/i\u003e\u003c/sup\u003e\u003c/span\u003e column has height \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003elcp\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e, The the size of the largest rectangle that fits in the columns from \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e - 1\u003c/span\u003e is \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/14/1e/141e45c14dc5396be6f14e5d1ff6c3ec71aa2365.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, That\u0027s close to our formula not the same but it\u0027s not a problem (You\u0027ll see how to fix it later), so to get rid of finding the \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e part, We can make that histogram and the answer for a query will be the largest rectangle in the subhistogram that contains the columns from \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/span\u003e to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e - 1\u003c/span\u003e, One of the ways to solve it is to try some heights \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e\u003c/span\u003e and see the maximum width we can achieve if \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e\u003c/span\u003e was the height, call it \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ew\u003c/i\u003e\u003c/span\u003e, and maximize with \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e * \u003ci\u003ew\u003c/i\u003e\u003c/span\u003e, To solve the slight difference in formulas problem we\u0027ll just maximize with \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e * (\u003ci\u003ew\u003c/i\u003e + 1)\u003c/span\u003e!!\u003c/p\u003e\u003cp\u003eLet \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eBU\u003c/i\u003e\u003c/span\u003e be a value the we\u0027ll choose later, We have 2 cases for our largest rectangle\u0027s height \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e\u003c/span\u003e, It could be either \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e ≤ \u003ci\u003eBU\u003c/i\u003e\u003c/span\u003e or \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e \u0026gt; \u003ci\u003eBU\u003c/i\u003e\u003c/span\u003e, We will solve both problems separately.\u003c/p\u003e\u003cp\u003eFor \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e ≤ \u003ci\u003eBU\u003c/i\u003e\u003c/span\u003e we can maintain \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eBU\u003c/i\u003e\u003c/span\u003e segment trees, Segment tree number \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e has \u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e at index \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e if \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003elcp\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/sub\u003e ≥ \u003ci\u003ei\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e0\u003c/span\u003e otherwise, When we query, It should get us the longest subsegment of ones in the query range, Let\u0027s see what we need for our merging operation, If we want the answer for the longest subsegment of ones in a range \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e;\u003ci\u003er\u003c/i\u003e]\u003c/span\u003e, Let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emid\u003c/i\u003e \u003d (\u003ci\u003el\u003c/i\u003e + \u003ci\u003er\u003c/i\u003e) / 2\u003c/span\u003e, Then the answer is the maximum between the answer of \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e;\u003ci\u003emid\u003c/i\u003e]\u003c/span\u003e, The answer of \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003emid\u003c/i\u003e + 1;\u003ci\u003er\u003c/i\u003e]\u003c/span\u003e, And the maximum suffix of ones in the range \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e;\u003ci\u003emid\u003c/i\u003e]\u003c/span\u003e added to the maximum prefix of ones in the range \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003emid\u003c/i\u003e + 1;\u003ci\u003er\u003c/i\u003e]\u003c/span\u003e . So we need to keep all these information in our node and also the length of the interval, As it\u0027s a well-known problem I won\u0027t get into more detail. Back to our problem, We can loop over all \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e ≤ \u003ci\u003eBU\u003c/i\u003e\u003c/span\u003e, Let the answer for the query on range \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003ea\u003c/i\u003e;\u003ci\u003eb\u003c/i\u003e - 1]\u003c/span\u003e in segment tree number \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e\u003c/span\u003e be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ew\u003c/i\u003e\u003c/span\u003e, The maximum width of a rectangle of height \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e\u003c/span\u003e in this range is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ew\u003c/i\u003e\u003c/span\u003e and we\u0027ll maximize our answer with \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e * (\u003ci\u003ew\u003c/i\u003e + 1)\u003c/span\u003e .\u003c/p\u003e\u003cp\u003eFor \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e \u0026gt; \u003ci\u003eBU\u003c/i\u003e\u003c/span\u003e, Let\u0027s call a column of height greater than \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eBU\u003c/i\u003e\u003c/span\u003e big, The heights we\u0027ll try are the heights of the big columns in the range, We don\u0027t have to try all the heights greater the \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eBU\u003c/i\u003e\u003c/span\u003e, There are at most \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/55/b4/55b403c6b936646b722006dcd075b5b175311fc2.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e big columns (Where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003etot\u003c/i\u003e\u003c/span\u003e is the total length of strings in input), Let\u0027s keep them in a set, When an update happens, You should add the column to the set or remove it depending on its new height, The set\u0027s size can\u0027t exceed \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/55/b4/55b403c6b936646b722006dcd075b5b175311fc2.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e now, Let\u0027s see how to answer a query, Let\u0027s loop over the big columns in range \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003ea\u003c/i\u003e;\u003ci\u003eb\u003c/i\u003e - 1]\u003c/span\u003e only, If 2 of them aren\u0027t consecutive then the column after the first can\u0027t be big and the column before the second either, That\u0027s because if it were big, It would be in our set, So we can use this observation by making a new histogram with the big columns in the range only, And put a column with height 0 between any non-consecutive two, And get the largest rectangle in this histogram by the stack way for example in \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/57/83/5783e476c47d3ede01248c9472edd98aef1fdd0f.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, The stack way will get us the maximum width \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ew\u003c/i\u003e\u003c/span\u003e we can achieve for a rectangle containing column number \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e, We\u0027ll maximize with \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003elcp\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e * (\u003ci\u003ew\u003c/i\u003e + 1)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eAlso the answer for our main formula can be an interval of length one, All what I mentioned doesn\u0027t cover this, You should maintain another segment tree that gets the maximum length of a string in a range for this .\u003c/p\u003e\u003cp\u003eMaximize all what we got, You have the answer, Now it\u0027s time to choose \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eBU\u003c/i\u003e\u003c/span\u003e, It\u0027s optimal in time to choose \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eBU\u003c/i\u003e\u003c/span\u003e near \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/09/e0/09e0bb8eeeed848cb8c9c4177614ddf35a062e69.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e (Reason in \u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/tfg\" title\u003d\"Мастер tfg\"\u003etfg\u003c/a\u003e\u0027s comment below) .\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eOptimization:\u003c/strong\u003e The longest subsegment of ones problem is solved by \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eBU\u003c/i\u003e\u003c/span\u003e segment trees and each one has 4 integers in each node, You can make them 2 integers (max prefix and suffix of ones) and make another only one segment tree that has the rest of the integers, That would divide the memory by 2 .\u003c/p\u003e\u003cp\u003eTime complexity : \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/c5/8f/c58f4a87eed1dfd0b4e4e91e5b7934728dfb9f12.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eThanks to \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/gritukan\" title\u003d\"Международный гроссмейстер gritukan\"\u003egritukan\u003c/a\u003e for making it harder and more interesting .\u003c/p\u003e\u003cp\u003eSolution link (\u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/gritukan\" title\u003d\"Международный гроссмейстер gritukan\"\u003egritukan\u003c/a\u003e) : \u003ca href\u003d\"https://pastebin.com/vQ4RJqh0\"\u003ehttps://pastebin.com/vQ4RJqh0\u003c/a\u003e .\u003c/p\u003e\u003cp\u003eSolution link (\u003ca class\u003d\"rated-user user-violet\" href\u003d\"/profile/mahmoudbadawy\" title\u003d\"Кандидат в мастера mahmoudbadawy\"\u003emahmoudbadawy\u003c/a\u003e) : \u003ca href\u003d\"https://pastebin.com/t3Vetzwf\"\u003ehttps://pastebin.com/t3Vetzwf\u003c/a\u003e .\u003c/p\u003e\u003c/div\u003e","tags":[]}}