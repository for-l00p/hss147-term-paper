{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1521916544,"rating":114,"authorHandle":"cyand1317","modificationTimeSeconds":1523718184,"id":58544,"title":"\u003cp\u003eVK Cup 2018 Round 2 and Codeforces Round #472 Editorial\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eLong time no see!\u003c/p\u003e\u003cp\u003eAs \u003ca href\u003d\"//codeforces.com/contest/924\"\u003eVK Cup Round 2\u003c/a\u003e and its two parallel rounds (\u003ca href\u003d\"//codeforces.com/contest/956\"\u003eDiv. 1\u003c/a\u003e and \u003ca href\u003d\"//codeforces.com/contest/957\"\u003eDiv. 2\u003c/a\u003e) comes to a close, we\u0027re here to congratulate on all who did well on the contest and cheer for everyone who participated â€” the queue won\u0027t stop you!\u003c/p\u003e\u003cp\u003eHere are the detailed tutorials for the problems. Feel free to discuss in the comments!\u003c/p\u003e\u003cp\u003eKudos to \u003ca class\u003d\"rated-user user-cyan\" href\u003d\"/profile/arsor\" title\u003d\"Specialist arsor\"\u003earsor\u003c/a\u003e for translating the tutorials into Russian!\u003c/p\u003e \u003chr /\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"957A\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eModel solution\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e_, s \u003d input(), input()\nprint(\u0027Yes\u0027 if\n    (\u0027??\u0027 in s or \u0027C?C\u0027 in s or \u0027M?M\u0027 in s or \u0027Y?Y\u0027 in s or s[0] \u003d\u003d \u0027?\u0027 or s[-1] \u003d\u003d \u0027?\u0027) and\n    not (\u0027CC\u0027 in s or \u0027MM\u0027 in s or \u0027YY\u0027 in s)\nelse \u0027No\u0027)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eAlternative solution (Errichto)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\nusing namespace std;\n\nvoid NO() {\n\tputs(\u0026quot;No\u0026quot;);\n\texit(0);\n}\nvoid YES() {\n\tputs(\u0026quot;Yes\u0026quot;);\n\texit(0);\n}\n\nint main() {\n\tint n;\n\tcin \u0026gt;\u0026gt; n;\n\tstring s;\n\tcin \u0026gt;\u0026gt; s;\n\tfor(int i \u003d 0; i \u0026lt; n - 1; ++i)\n\t\tif(s[i] !\u003d \u0027?\u0027 \u0026amp;\u0026amp; s[i] \u003d\u003d s[i+1])\n\t\t\tNO();\n\tfor(int i \u003d 0; i \u0026lt; n; ++i) if(s[i] \u003d\u003d \u0027?\u0027) {\n\t\tif(i \u003d\u003d 0 || i \u003d\u003d n - 1) YES();\n\t\tif(s[i+1] \u003d\u003d \u0027?\u0027) YES();\n\t\tif(s[i-1] \u003d\u003d s[i+1]) YES();\n\t}\n\tNO();\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e(by \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/cyand1317\" title\u003d\"Grandmaster cyand1317\"\u003ecyand1317\u003c/a\u003e)\u003c/p\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"924A\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eModel solution\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;cstdio\u0026gt;\n\ntypedef long long int64;\nstatic const int MAXN \u003d 53;\n\nstatic int n, m;\nstatic bool a[MAXN][MAXN];\nstatic int64 b[MAXN];\n\nint main()\n{\n    scanf(\u0026quot;%d%d\u0026quot;, \u0026amp;n, \u0026amp;m); getchar();\n    for (int i \u003d 0; i \u0026lt; n; ++i)\n        for (int j \u003d 0; j \u0026lt;\u003d m; ++j) a[i][j] \u003d (getchar() \u003d\u003d \u0027#\u0027);\n\n    for (int i \u003d 0; i \u0026lt; n - 1; ++i)\n        for (int j \u003d i + 1; j \u0026lt; n; ++j) {\n            bool all_same \u003d true, no_intersect \u003d true;\n            for (int k \u003d 0; k \u0026lt; m; ++k) {\n                if (a[i][k] !\u003d a[j][k]) all_same \u003d false;\n                if (a[i][k] \u0026amp;\u0026amp; a[j][k]) no_intersect \u003d false;\n            }\n            if (!all_same \u0026amp;\u0026amp; !no_intersect) {\n                puts(\u0026quot;No\u0026quot;); return 0;\n            }\n        }\n\n    puts(\u0026quot;Yes\u0026quot;); return 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eAlternative solution with DSU in O(nm alpha(n)) (skywalkert)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\nusing namespace std;\nconst int maxn \u003d 5001, maxm \u003d maxn \u0026lt;\u0026lt; 1 | 1;\nint n, m, dsu[maxm], cB[maxm], cW[maxm], cE[maxm];\nchar buf[maxn];\nint dsu_find(int u) {\n\treturn dsu[u] \u0026lt; 0 ? u : (dsu[u] \u003d dsu_find(dsu[u]));\n}\nvoid dsu_merge(int u, int v) {\n\tu \u003d dsu_find(u);\n\tv \u003d dsu_find(v);\n\tif(u \u003d\u003d v) {\n\t\t++cE[u];\n\t\treturn;\n\t}\n\tif(dsu[u] \u0026lt; dsu[v])\n\t\tswap(u, v);\n\tdsu[v] -\u003d dsu[u] \u003d\u003d dsu[v];\n\tdsu[u] \u003d v;\n\tcB[v] +\u003d cB[u];\n\tcW[v] +\u003d cW[u];\n\tcE[v] +\u003d cE[u] + 1;\n}\nint main() {\n\tscanf(\u0026quot;%d%d\u0026quot;, \u0026amp;n, \u0026amp;m);\n\tmemset(dsu, -1, (n + m) * sizeof(int));\n\tfor(int i \u003d 0; i \u0026lt; n; ++i)\n\t\tcB[i] \u003d 1;\n\tfor(int i \u003d 0; i \u0026lt; m; ++i)\n\t\tcW[n + i] \u003d 1;\n\tfor(int i \u003d 0; i \u0026lt; n; ++i) {\n\t\tscanf(\u0026quot;%s\u0026quot;, buf);\n\t\tfor(int j \u003d 0; j \u0026lt; m; ++j)\n\t\t\tif(buf[j] !\u003d \u0027.\u0027)\n\t\t\t\tdsu_merge(i, n + j);\n\t}\n\tfor(int i \u003d 0; i \u0026lt; n + m; ++i)\n\t\tif(dsu_find(i) \u003d\u003d i \u0026amp;\u0026amp; cB[i] * cW[i] !\u003d cE[i]) {\n\t\t\tputs(\u0026quot;No\u0026quot;);\n\t\t\treturn 0;\n\t\t}\n\tputs(\u0026quot;Yes\u0026quot;);\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eAlternative solution in O(nm)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;cstdio\u0026gt;\n#include \u0026lt;algorithm\u0026gt;\n#include \u0026lt;vector\u0026gt;\nstatic const int MAXN \u003d 1004;\n\nstatic int n, m;\nstatic bool g[MAXN][MAXN];\n// c[i] \u003d set of rows where the i-th column is coloured\nstatic std::vector\u0026lt;int\u0026gt; c[MAXN];\nstatic bool checked[MAXN] \u003d { false };\n\nint main()\n{\n    scanf(\u0026quot;%d%d\u0026quot;, \u0026amp;n, \u0026amp;m); getchar();\n    for (int i \u003d 0; i \u0026lt; n; ++i)\n        for (int j \u003d 0; j \u0026lt;\u003d m; ++j) {\n            g[i][j] \u003d (getchar() \u003d\u003d \u0027#\u0027);\n            if (g[i][j]) c[j].push_back(i);\n        }\n\n    for (int i \u003d 0; i \u0026lt; n; ++i) if (!checked[i]) {\n        std::vector\u0026lt;int\u0026gt; r;\n        for (int j \u003d 0; j \u0026lt; m; ++j) if (g[i][j])\n            for (int k : c[j]) r.push_back(k);\n        std::sort(r.begin(), r.end());\n        r.resize(std::unique(r.begin(), r.end()) - r.begin());\n\n        for (int k : r) {\n            if (checked[k]) { puts(\u0026quot;No\u0026quot;); return 0; }\n            checked[k] \u003d true;\n            for (int p \u003d 0; p \u0026lt; m; ++p)\n                if (g[i][p] !\u003d g[k][p]) { puts(\u0026quot;No\u0026quot;); return 0; }\n        }\n    }\n\n    puts(\u0026quot;Yes\u0026quot;); return 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e(by \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/cyand1317\" title\u003d\"Grandmaster cyand1317\"\u003ecyand1317\u003c/a\u003e)\u003c/p\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"924B\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eModel solution\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;iostream\u0026gt;\n#include \u0026lt;sstream\u0026gt;\n#include \u0026lt;cstdio\u0026gt;\n#include \u0026lt;vector\u0026gt;\n#include \u0026lt;cmath\u0026gt;\n#include \u0026lt;queue\u0026gt;\n#include \u0026lt;string\u0026gt;\n#include \u0026lt;cstring\u0026gt;\n#include \u0026lt;cassert\u0026gt;\n#include \u0026lt;iomanip\u0026gt;\n#include \u0026lt;algorithm\u0026gt;\n#include \u0026lt;set\u0026gt;\n#include \u0026lt;map\u0026gt;\n#include \u0026lt;ctime\u0026gt;\n#include \u0026lt;cmath\u0026gt;\n\n#define forn(i, n) for(int i\u003d0;i\u0026lt;n;++i)\n#define fore(i, l, r) for(int i \u003d int(l); i \u0026lt;\u003d int(r); ++i)\n#define sz(v) int(v.size())\n#define all(v) v.begin(), v.end()\n#define pb push_back\n#define mp make_pair\n#define x first\n#define y1 ________y1\n#define y second\n#define ft first\n#define sc second\n#define pt pair\u0026lt;int, int\u0026gt;\n\ntemplate\u0026lt;typename X\u0026gt; inline X abs(const X\u0026amp; a) { return a \u0026lt; 0? -a: a; }\ntemplate\u0026lt;typename X\u0026gt; inline X sqr(const X\u0026amp; a) { return a * a; }\n\ntypedef long long li;\ntypedef long double ld;\n\nusing namespace std;\n\nconst int INF \u003d 1000 * 1000 * 1000;\nconst ld EPS \u003d 1e-9;\nconst ld PI \u003d acos(-1.0);\n\nconst int N \u003d 100 * 1000 + 13;\n\nint n, u;\nint a[N];\nint idx1 \u003d -1, idx2, idx3;\n\ninline void read() {\t\n\tscanf(\u0026quot;%d%d\u0026quot;, \u0026amp;n, \u0026amp;u);\n\tfor (int i \u003d 0; i \u0026lt; n; i++) {\n\t\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;a[i]);\n\t}\n}\n\ninline void solve() {\n\tint k \u003d 0;\n\tfor (int i \u003d 0; i \u0026lt; n; i++) {\n\t\tk \u003d max(k, i);\n\t\twhile (k + 1 \u0026lt; n \u0026amp;\u0026amp; a[k + 1] - a[i] \u0026lt;\u003d u) {\n      \t\tk++;\n\t\t}\n        if (k - i - 1 \u0026lt;\u003d 0) {\n        \tcontinue;\n        }\n        int j \u003d i + 1;\n\n        if (idx1 \u003d\u003d -1 || (a[k] - a[j]) * 1ll * (a[idx3] - a[idx1]) \u0026gt; (a[idx3] - a[idx2]) * 1ll * (a[k] - a[i])) {\n\t\t\tidx1 \u003d i, idx2 \u003d j, idx3 \u003d k;        \t\n        }\n\t}\t\n\n\tif (idx1 \u003d\u003d -1) {\n\t\tcout \u0026lt;\u0026lt; -1 \u0026lt;\u0026lt; endl;\n\t\treturn;\n\t}\n\n\tcout.precision(20);\n    cout \u0026lt;\u0026lt; (double)(a[idx3] - a[idx2]) / (a[idx3] - a[idx1]) \u0026lt;\u0026lt; endl;\n}\n\nint main () {\n#ifdef fcspartakm\n    freopen(\u0026quot;input.txt\u0026quot;, \u0026quot;r\u0026quot;, stdin);\n    //freopen(\u0026quot;output.txt\u0026quot;, \u0026quot;w\u0026quot;, stdout);\n#endif\n    srand(time(NULL));\n    cerr \u0026lt;\u0026lt; setprecision(10) \u0026lt;\u0026lt; fixed;\n    \n    read();\n    solve();\n \n    //cerr \u0026lt;\u0026lt; \u0026quot;TIME: \u0026quot; \u0026lt;\u0026lt; clock() \u0026lt;\u0026lt; endl;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e(by \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/KAN\" title\u003d\"Grandmaster KAN\"\u003eKAN\u003c/a\u003e, prepared by \u003ca class\u003d\"rated-user user-violet\" href\u003d\"/profile/fcspartakm\" title\u003d\"Candidate Master fcspartakm\"\u003efcspartakm\u003c/a\u003e)\u003c/p\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"924C\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eModel solution\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;cstdio\u0026gt;\n#include \u0026lt;algorithm\u0026gt;\n\ntypedef long long int64;\nstatic const int MAXN \u003d 1e5 + 4;\n\nstatic int n, m[MAXN];\nstatic int t[MAXN];\n\nint main()\n{\n    scanf(\u0026quot;%d\u0026quot;, \u0026amp;n);\n    for (int i \u003d 0; i \u0026lt; n; ++i) scanf(\u0026quot;%d\u0026quot;, \u0026amp;m[i]);\n\n    for (int i \u003d n - 1, cur \u003d 0; i \u0026gt;\u003d 0; --i) {\n        cur \u003d std::max(0, cur - 1);\n        cur \u003d std::max(cur, m[i] + 1);\n        t[i] \u003d cur;\n    }\n\n    int64 ans \u003d 0;\n    for (int i \u003d 0, cur \u003d 0; i \u0026lt; n; ++i) {\n        cur \u003d std::max(cur, t[i]);\n        ans +\u003d cur;\n    }\n\n    for (int i \u003d 0; i \u0026lt; n; ++i) ans -\u003d (m[i] + 1);\n    printf(\u0026quot;%lld\\n\u0026quot;, ans);\n\n    return 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e(by \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/cyand1317\" title\u003d\"Grandmaster cyand1317\"\u003ecyand1317\u003c/a\u003e)\u003c/p\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"924D\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eModel solution\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;cstdio\u0026gt;\n#include \u0026lt;algorithm\u0026gt;\n#include \u0026lt;utility\u0026gt;\n\ntypedef long long int64;\nstatic const int MAXN \u003d 1e5 + 4;\nstatic const int MAXX \u003d 1e8 + 4;\n\nstatic int n, w;\nstatic int x[MAXN], v[MAXN];\n\nstruct fraction {\n    template \u0026lt;typename T\u0026gt; static inline T gcd(const T a, const T b) {\n        return (b \u003d\u003d 0) ? a : gcd(b, a % b);\n    }\n\n    int64 num, deno;\n    inline void simplify() {\n        if (deno \u0026lt; 0) { num *\u003d -1; deno *\u003d -1; }\n        int64 g \u003d gcd(num \u0026lt; 0 ? -num : num, deno); num /\u003d g; deno /\u003d g;\n    }\n\n    fraction() { }\n    fraction(int64 num, int64 deno) : num(num), deno(deno) { simplify(); }\n\n    inline bool operator \u0026lt; (const fraction \u0026amp;rhs) const {\n        return num * rhs.deno \u0026lt; deno * rhs.num;\n    }\n    inline bool operator !\u003d (const fraction \u0026amp;rhs) const {\n        return num * rhs.deno !\u003d deno * rhs.num;\n    }\n};\n\n// Time bounds at which clouds can arrive at the origin\nstatic std::pair\u0026lt;fraction, fraction\u0026gt; t[MAXN];\n// Used at discretization\nstatic std::pair\u0026lt;fraction, int\u0026gt; d[MAXN];\nstatic int p[MAXN];\n\nstruct bit {\n    static const int MAXN \u003d ::MAXN;\n    int f[MAXN];\n    bit() { std::fill(f, f + MAXN, 0); }\n    inline void add(int pos, int inc) {\n        for (++pos; pos \u0026lt; MAXN; pos +\u003d (pos \u0026amp; -pos)) f[pos] +\u003d inc;\n    }\n    inline int sum(int rg) {\n        int ans \u003d 0;\n        for (++rg; rg; rg -\u003d (rg \u0026amp; -rg)) ans +\u003d f[rg];\n        return ans;\n    }\n    inline int sum(int lf, int rg) {\n        return sum(rg) - sum(lf - 1);\n    }\n} arkady;\n\nint main()\n{\n    scanf(\u0026quot;%d%d\u0026quot;, \u0026amp;n, \u0026amp;w);\n    for (int i \u003d 0; i \u0026lt; n; ++i) scanf(\u0026quot;%d%d\u0026quot;, \u0026amp;x[i], \u0026amp;v[i]);\n\n    for (int i \u003d 0; i \u0026lt; n; ++i) {\n        int64 v1 \u003d v[i] - w, v2 \u003d v[i] + w;\n        t[i] \u003d {fraction(-x[i], v1), fraction(-x[i], v2)};\n    }\n\n    for (int i \u003d 0; i \u0026lt; n; ++i) t[i].second.num *\u003d -1;\n    std::sort(t, t + n);\n    for (int i \u003d 0; i \u0026lt; n; ++i) t[i].second.num *\u003d -1;\n    for (int i \u003d 0; i \u0026lt; n; ++i) d[i] \u003d {t[i].second, i};\n    std::sort(d, d + n);\n    for (int i \u003d 0, rk \u003d -1; i \u0026lt; n; ++i) {\n        if (i \u003d\u003d 0 || d[i].first !\u003d d[i - 1].first) ++rk;\n        p[d[i].second] \u003d rk;\n    }\n    /*for (int i \u003d 0; i \u0026lt; n; ++i)\n        printf(\u0026quot;%.4lf %.4lf | %d\\n\u0026quot;,\n            (double)t[i].first.num / t[i].first.deno,\n            (double)t[i].second.num / t[i].second.deno, p[i]);*/\n\n    int64 ans \u003d 0;\n    for (int i \u003d 0; i \u0026lt; n; ++i) {\n        ans +\u003d arkady.sum(p[i], MAXN - 1);\n        arkady.add(p[i], 1);\n    }\n\n    printf(\u0026quot;%lld\\n\u0026quot;, ans);\n\n    return 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e(by \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/KAN\" title\u003d\"Grandmaster KAN\"\u003eKAN\u003c/a\u003e, prepared by \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/cyand1317\" title\u003d\"Grandmaster cyand1317\"\u003ecyand1317\u003c/a\u003e)\u003c/p\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"924E\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eModel solution\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e/**\n * This is a solution for problem wardrobe\n * This is nk_ok.cpp\n * \n * @author: Nikolay Kalinin\n * @date: Tue, 20 Mar 2018 21:48:33 +0300\n */\n#include \u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\nusing ll \u003d long long;\nusing ld \u003d long double;\nusing D \u003d double;\nusing uint \u003d unsigned int;\ntemplate\u0026lt;typename T\u0026gt;\nusing pair2 \u003d pair\u0026lt;T, T\u0026gt;;\n\n#ifdef WIN32\n    #define LLD \u0026quot;%I64d\u0026quot;\n#else\n    #define LLD \u0026quot;%lld\u0026quot;\n#endif\n\n#define pb push_back\n#define mp make_pair\n#define all(x) (x).begin(),(x).end()\n#define fi first\n#define se second\n\nstruct tbox\n{\n    int h, t;\n};\n\ninline bool operator\u0026lt;(const tbox \u0026amp;a, const tbox \u0026amp;b)\n{\n    if (a.t !\u003d b.t) return a.t \u0026lt; b.t;\n    return a.h \u0026gt; b.h;\n}\n\nconst int maxn \u003d 10005;\nconst int inf \u003d 1e9;\n\ntbox b[maxn];\nint ans[maxn];\nint n, l, r;\n\nint main()\n{\n    scanf(\u0026quot;%d%d%d\u0026quot;, \u0026amp;n, \u0026amp;l, \u0026amp;r);\n    int sumh \u003d 0;\n    for (int i \u003d 0; i \u0026lt; n; i++)\n    {\n        scanf(\u0026quot;%d\u0026quot;, \u0026amp;b[i].h);\n        sumh +\u003d b[i].h;\n    }\n    tie(l, r) \u003d pair{sumh - r, sumh - l};\n    for (int i \u003d 0; i \u0026lt; n; i++) scanf(\u0026quot;%d\u0026quot;, \u0026amp;b[i].t);\n    sort(b, b + n);\n    for (int i \u003d 0; i \u0026lt;\u003d sumh; i++) ans[i] \u003d -inf;\n    ans[0] \u003d 0;\n    for (int i \u003d 0; i \u0026lt; n; i++)\n    {\n        for (int h \u003d sumh - b[i].h; h \u0026gt;\u003d 0; h--) ans[h + b[i].h] \u003d max(ans[h + b[i].h], ans[h] + b[i].t * (h + b[i].h \u0026gt;\u003d l \u0026amp;\u0026amp; h + b[i].h \u0026lt;\u003d r));\n    }\n    cout \u0026lt;\u0026lt; *max_element(ans, ans + sumh + 1) \u0026lt;\u0026lt; endl;\n    return 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e(by \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/KAN\" title\u003d\"Grandmaster KAN\"\u003eKAN\u003c/a\u003e)\u003c/p\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"924F\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eModel solution\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\nusing namespace std;\ntypedef long long LL;\nconst int maxd \u003d 10, maxl \u003d 18, maxs \u003d 81, BLEN \u003d 5, BMSK \u003d 31;\nstruct States {\n\tvector\u0026lt;LL\u0026gt; keys, vals[maxd + 1];\n\tvoid insert(LL key) {\n\t\tkeys.push_back(key);\n\t}\n\tvoid initialize(LL val \u003d 0) {\n\t\tsort(keys.begin(), keys.end());\n\t\tkeys.erase(unique(keys.begin(), keys.end()), keys.end());\n\t\tfor(int i \u003d 0; i \u0026lt; maxd; ++i)\n\t\t\tvals[i].assign(keys.size(), val);\n\t}\n\tvoid summation() {\n\t\tfor(int i \u003d 1; i \u0026lt; maxd; ++i)\n\t\t\tfor(vector\u0026lt;LL\u0026gt;::iterator it \u003d vals[i - 1].begin(), jt \u003d vals[i].begin(); jt !\u003d vals[i].end(); ++it, ++jt)\n\t\t\t\t*jt +\u003d *it;\n\t}\n\tsize_t size() const {\n\t\treturn keys.size();\n\t}\n\tvoid update(int upp, LL key, LL adt) {\n\t\tvals[upp][lower_bound(keys.begin(), keys.end(), key) - keys.begin()] +\u003d adt;\n\t}\n\tLL find(int upp, LL key) {\n\t\tvector\u0026lt;LL\u0026gt;::iterator it \u003d lower_bound(keys.begin(), keys.end(), key);\n\t\tif(it \u003d\u003d keys.end() || *it !\u003d key)\n\t\t\treturn 0;\n\t\treturn vals[upp][it - keys.begin()];\n\t}\n} f[maxd + 1][maxl + 1];\nLL c[2][maxl + 1], bit[maxd + 1];\nbitset\u0026lt;maxs + 1\u0026gt; vis[maxd + 1];\nvoid dfs(int dep, int cnt, int sum, LL msk) {\n\tif(dep \u003d\u003d maxd) {\n\t\tfor(int i \u003d sum \u0026gt;\u0026gt; 1; i \u0026gt;\u003d 0; --i)\n\t\t\tif(vis[dep - 1].test(i)) {\n\t\t\t\tint dif \u003d sum - i - i;\n\t\t\t\tif(dif \u0026gt; 1)\n\t\t\t\t\tf[dif][0].insert(msk);\n\t\t\t\tbreak;\n\t\t\t}\n\t\treturn;\n\t}\n\tvis[dep] \u003d vis[dep - 1];\n\tdfs(dep + 1, cnt, sum, msk);\n\twhile(cnt \u0026lt; maxl) {\n\t\tvis[dep] |\u003d vis[dep] \u0026lt;\u0026lt; dep;\n\t\tdfs(dep + 1, ++cnt, sum +\u003d dep, msk +\u003d bit[dep]);\n\t}\n}\nLL solve(int dif, LL lim) {\n\tchar dig[maxl + 3];\n\tint len \u003d sprintf(dig, \u0026quot;%lld\u0026quot;, lim);\n\tLL ret \u003d 0, msk \u003d 0;\n\tStates *F \u003d f[dif];\n\tfor(int i \u003d 0; i \u0026lt; len; ++i) {\n\t\tdig[i] -\u003d \u00270\u0027;\n\t\tif(len - i \u0026gt; maxl) {\n\t\t\tfor(int j \u003d 0; j \u0026lt; dig[i]; ++j)\n\t\t\t\tret +\u003d F[len - i - 1].find(maxd - 1, msk);\n\t\t} else if(dig[i]) {\n\t\t\tret +\u003d F[len - i].find(dig[i] - 1, msk);\n\t\t\tmsk +\u003d bit[dig[i]];\n\t\t}\n\t}\n\treturn ret;\n}\nLL solve2(LL lim) {\n\tchar dig[maxl + 3];\n\tint len \u003d sprintf(dig, \u0026quot;%lld\u0026quot;, lim), part \u003d 0;\n\tLL ret \u003d 0;\n\tfor(int i \u003d 0; i \u0026lt; len; ++i) {\n\t\tdig[i] -\u003d \u00270\u0027;\n\t\tint odd \u003d dig[i] \u0026gt;\u0026gt; 1, even \u003d (dig[i] + 1) \u0026gt;\u0026gt; 1;\n\t\tret +\u003d c[part][len - 1 - i] * odd + c[part ^ 1][len - 1 - i] * even;\n\t\tpart ^\u003d dig[i] \u0026amp; 1;\n\t}\n\treturn ret;\n}\nint main() {\n\tc[0][0] \u003d 1;\n\tfor(int i \u003d 0; i \u0026lt; maxl; ++i) {\n\t\tint odd \u003d maxd \u0026gt;\u0026gt; 1, even \u003d (maxd + 1) \u0026gt;\u0026gt; 1;\n\t\tc[0][i + 1] \u003d c[0][i] * even + c[1][i] * odd;\n\t\tc[1][i + 1] \u003d c[0][i] * odd + c[1][i] * even;\n\t}\n\tbit[1] \u003d 1;\n\tfor(int i \u003d 2; i \u0026lt; maxd; ++i)\n\t\tbit[i] \u003d bit[i - 1] \u0026lt;\u0026lt; BLEN;\n\tvis[0].set(0);\n\tdfs(1, 0, 0, 0);\n\tfor(int i \u003d 2; i \u0026lt; maxd; ++i) {\n\t\tf[i][0].initialize(1);\n\t\tfor(int j \u003d 0; j \u0026lt; maxl; ++j) {\n\t\t\tStates \u0026amp;cur \u003d f[i][j], \u0026amp;nxt \u003d f[i][j + 1];\n\t\t\tfor(int idx \u003d 0, sz \u003d cur.size(); idx \u0026lt; sz; ++idx) {\n\t\t\t\tint cnt \u003d j;\n\t\t\t\tLL msk \u003d cur.keys[idx], tmp \u003d msk;\n\t\t\t\tfor(int k \u003d 1; k \u0026lt; maxd; ++k, tmp \u0026gt;\u0026gt;\u003d BLEN) {\n\t\t\t\t\tint rem \u003d tmp \u0026amp; BMSK;\n\t\t\t\t\tif(!rem)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcnt +\u003d rem;\n\t\t\t\t\tnxt.insert(msk - bit[k]);\n\t\t\t\t}\n\t\t\t\tif(cnt \u0026lt; maxl)\n\t\t\t\t\tnxt.insert(msk);\n\t\t\t}\n\t\t\tnxt.initialize(0);\n\t\t\tfor(int idx \u003d 0, sz \u003d cur.size(); idx \u0026lt; sz; ++idx) {\n\t\t\t\tint cnt \u003d j;\n\t\t\t\tLL msk \u003d cur.keys[idx], ways \u003d cur.vals[maxd - 1][idx], tmp \u003d msk;\n\t\t\t\tfor(int k \u003d 1; k \u0026lt; maxd; ++k, tmp \u0026gt;\u0026gt;\u003d BLEN) {\n\t\t\t\t\tint rem \u003d tmp \u0026amp; BMSK;\n\t\t\t\t\tif(!rem)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcnt +\u003d rem;\n\t\t\t\t\tnxt.update(k, msk - bit[k], ways);\n\t\t\t\t}\n\t\t\t\tif(cnt \u0026lt; maxl)\n\t\t\t\t\tnxt.update(0, msk, ways); \n\t\t\t}\n\t\t\tnxt.summation();\n\t\t}\n\t}\n\tint t;\n\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;t);\n\tfor(int Case \u003d 1; Case \u0026lt;\u003d t; ++Case) {\n\t\tLL L, R;\n\t\tint k;\n\t\tscanf(\u0026quot;%lld%lld%d\u0026quot;, \u0026amp;L, \u0026amp;R, \u0026amp;k);\n\t\tLL ans \u003d R + 1 - L;\n\t\tif(!k) {\n\t\t\tans -\u003d solve2(R + 1) - solve2(L);\n\t\t\tfor(int i \u003d 2; i \u0026lt; maxd; i +\u003d 2)\n\t\t\t\tans -\u003d solve(i, R + 1) - solve(i, L);\n\t\t} else {\n\t\t\tfor(int i \u003d k + 1; i \u0026lt; maxd; ++i)\n\t\t\t\tans -\u003d solve(i, R + 1) - solve(i, L);\n\t\t}\n\t\tprintf(\u0026quot;%lld\\n\u0026quot;, ans);\n\t}\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e(by \u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/Claris\" title\u003d\"International master Claris\"\u003eClaris\u003c/a\u003e and \u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/skywalkert\" title\u003d\"Master skywalkert\"\u003eskywalkert\u003c/a\u003e)\u003c/p\u003e \u003chr /\u003e\u003cp\u003eMy gratitude to the coordinators, problem authors, testers, and every participant. You made all this possible! Cheers \\(^ ^)/\u003c/p\u003e\u003c/div\u003e","tags":["vk cup","vk cup 18","472","editorial"]}}