{"status":"OK","result":{"originalLocale":"en","allowViewHistory":true,"creationTimeSeconds":1474618030,"rating":12,"authorHandle":"Azat_Yusupov","modificationTimeSeconds":1474885363,"id":47290,"title":"\u003cp\u003eSuffix array\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eMaterial: \u003ca href\u003d\"http://e-maxx.ru/algo/suffix_array\"\u003ehttp://e-maxx.ru/algo/suffix_array\u003c/a\u003e \u003cbr /\u003e Masalalar\u003cbr /\u003e \u003ca href\u003d\"http://www.spoj.com/problems/SARRAY/\"\u003ehttp://www.spoj.com/problems/SARRAY/\u003c/a\u003e \u003cbr /\u003e Uva. 719 — Glass Beads.\u003cbr /\u003e \u003ca href\u003d\"https://uva.onlinejudge.org/index.php?option\u003dcom_onlinejudge\u0026amp;Itemid\u003d8\u0026amp;category\u003d9\u0026amp;page\u003dshow_problem\u0026amp;problem\u003d660\"\u003ehttps://uva.onlinejudge.org/index.php?option\u003dcom_onlinejudge\u0026amp;Itemid\u003d8\u0026amp;category\u003d9\u0026amp;page\u003dshow_problem\u0026amp;problem\u003d660\u003c/a\u003e\u003cbr /\u003e\u003cbr /\u003e Uva. 10679 — I Love Strings!! \u003ca href\u003d\"https://uva.onlinejudge.org/index.php?option\u003donlinejudge\u0026amp;page\u003dshow_problem\u0026amp;problem\u003d1620\"\u003ehttps://uva.onlinejudge.org/index.php?option\u003donlinejudge\u0026amp;page\u003dshow_problem\u0026amp;problem\u003d1620\u003c/a\u003e \u003cbr /\u003e \u003ca href\u003d\"http://www.spoj.com/problems/MINMOVE/\"\u003ehttp://www.spoj.com/problems/MINMOVE/\u003c/a\u003e \u003cbr /\u003e\u003cbr /\u003e\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"http://acm.timus.ru/problem.aspx?space\u003d1\u0026amp;num\u003d1517\"\u003ehttp://acm.timus.ru/problem.aspx?space\u003d1\u0026amp;num\u003d1517\u003c/a\u003e \u003cbr /\u003e \u003ca href\u003d\"//codeforces.com/contest/19/problem/C\"\u003ehttp://codeforces.com/contest/19/problem/C\u003c/a\u003e \u003cbr /\u003e \u003ca href\u003d\"http://algo.ubtuit.uz/problems.php?about\u003d808\"\u003ehttp://algo.ubtuit.uz/problems.php?about\u003d808\u003c/a\u003e \u003cbr /\u003e \u003ca href\u003d\"http://acm.sgu.ru/problem.php?contest\u003d0\u0026amp;problem\u003d505\"\u003ehttp://acm.sgu.ru/problem.php?contest\u003d0\u0026amp;problem\u003d505\u003c/a\u003e \u003cbr /\u003e\u003c/p\u003e\u003cp\u003e\u003cbr /\u003e \u003ca href\u003d\"https://www.hackerrank.com/challenges/string-similarity\"\u003ehttps://www.hackerrank.com/challenges/string-similarity\u003c/a\u003e \u003cbr /\u003e \u003ca href\u003d\"http://www.spoj.com/problems/PLD/\"\u003ehttp://www.spoj.com/problems/PLD/\u003c/a\u003e \u003cbr /\u003e UVa 10526, 11107, 11512\u003cbr /\u003e \u003cbr /\u003e \u003ca href\u003d\"http://acm.timus.ru/problem.aspx?space\u003d1\u0026amp;num\u003d1393\"\u003ehttp://acm.timus.ru/problem.aspx?space\u003d1\u0026amp;num\u003d1393\u003c/a\u003e \u003cbr /\u003e \u003ca href\u003d\"//codeforces.com/contest/232/problem/D\"\u003ehttp://codeforces.com/contest/232/problem/D\u003c/a\u003e \u003cbr /\u003e \u003cbr /\u003e\u003cbr /\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSuffix Array\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e  #include \u003cp\u003eusing namespace std;\u003c/p\u003e\u003cp\u003eint p[100000]; int pn[100000]; int c[100000]; int cn[100000]; int cnt[100000];\u003c/p\u003e\u003cp\u003eint main() {  string s;  cin \u0026gt;\u0026gt; s;  s +\u003d \u0026quot;$\u0026quot;;  int n \u003d s.length();\u003c/p\u003e\n\u003cpre\u003efor (int i \u003d 0; i \u0026lt; n; i++) {\n    cnt[s[i]]++;\n}\nfor (int i \u003d 1; i \u0026lt; 256; i++) {\n    cnt[i] +\u003d cnt[i-1];\n}\nfor (int i \u003d n-1; i \u0026gt;\u003d 0; i--) {\n    p[--cnt[s[i]]] \u003d i;\n}\nc[p[0]] \u003d 0;\nint classes \u003d 1;\nfor (int i \u003d 1; i \u0026lt; n; i++) {\n    if (s[p[i]] !\u003d s[p[i-1]])\n        classes++;\n    c[p[i]] \u003d classes-1;\n}\nfor (int h \u003d 0; (1 \u0026lt;\u0026lt; h) \u0026lt; n; h++) {\n    for (int i \u003d 0; i \u0026lt; n; i++) {\n        pn[i] \u003d p[i] - (1 \u0026lt;\u0026lt; h);\n        if (pn[i] \u0026lt; 0)\n            pn[i] +\u003d n;\n    }\n    for (int i \u003d 0; i \u0026lt; classes; i++) {\n        cnt[i] \u003d 0;\n    }\n    for (int i \u003d 0; i \u0026lt; n; i++) {\n        cnt[c[pn[i]]]++;\n    }\n    for (int i \u003d 1; i \u0026lt; classes; i++) {\n        cnt[i] +\u003d cnt[i-1];\n    }\n    for (int i \u003d n-1; i \u0026gt;\u003d 0; i--) {\n        p[--cnt[c[pn[i]]]] \u003d pn[i];\n    }\n    cn[p[0]] \u003d 0;\n    classes \u003d 1;\n    for (int i \u003d 1; i \u0026lt; n; i++) {\n        int mid1 \u003d (p[i-1] + (1 \u0026lt;\u0026lt; h)) % n;\n        int mid2 \u003d (p[i] + (1 \u0026lt;\u0026lt; h)) % n;\n        if (c[p[i]] !\u003d c[p[i-1]] || c[mid2] !\u003d c[mid1])\n            classes++;\n        cn[p[i]] \u003d classes-1;\n    }\n    for (int i \u003d 0; i \u0026lt; n; i++) {\n        c[i] \u003d cn[i];\n    }\n}\nfor (int i \u003d 1; i \u0026lt; n; i++) {\n    cout \u0026lt;\u0026lt; p[i] \u0026lt;\u0026lt; endl;\n}\u003c/pre\u003e\u003cp\u003e}\u003c/p\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eIkkining barcha darajalari uchun class massiv\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\n    cin \u0026gt;\u0026gt; s;\n    for (int i \u003d 0; i \u0026lt; n; i++) {\n        cnt[s[i]]++;\n    }\n    for (int i \u003d 1; i \u0026lt; 256; i++) {\n        cnt[i] +\u003d cnt[i-1];\n    }\n    for (int i \u003d n-1; i \u0026gt;\u003d 0; i--) {\n        p[--cnt[s[i]]] \u003d i;\n    }\n    c[0][p[0]] \u003d 0;\n    int classes \u003d 1;\n    for (int i \u003d 1; i \u0026lt; n; i++) {\n        if (s[p[i]] !\u003d s[p[i-1]])\n            classes++;\n        c[0][p[i]] \u003d classes-1;\n    }\n\n    for (int h \u003d 0; (1 \u0026lt;\u0026lt; h) \u0026lt; n; h++) {\n        logn++;\n        for (int i \u003d 0; i \u0026lt; n; i++) {\n            pn[i] \u003d p[i] - (1 \u0026lt;\u0026lt; h);\n            if (pn[i] \u0026lt; 0)\n                pn[i] +\u003d n;\n        }\n        for (int i \u003d 0; i \u0026lt; classes; i++) {\n            cnt[i] \u003d 0;\n        }\n        for (int i \u003d 0; i \u0026lt; n; i++) {\n            cnt[c[h][pn[i]]]++;\n        }\n        for (int i \u003d 1; i \u0026lt; classes; i++) {\n            cnt[i] +\u003d cnt[i-1];\n        }\n        for (int i \u003d 0; i \u0026lt; n; i++) {\n            p[--cnt[c[h][pn[i]]]] \u003d pn[i];\n        }\n        c[h+1][p[0]] \u003d 0;\n        classes \u003d 1;\n        for (int i \u003d 1; i \u0026lt; n; i++) {\n            int mid1 \u003d (p[i] + (1 \u0026lt;\u0026lt; h)) % n;\n            int mid2 \u003d (p[i-1] + (1 \u0026lt;\u0026lt; h)) % n;\n            if (c[h][p[i]] !\u003d c[h][p[i-1]] || c[h][mid1] !\u003d c[h][mid2])\n                classes++;\n            c[h+1][p[i]] \u003d classes-1;\n        }\n    }\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eLCP\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\nint lcp(int i, int j) {\n    int res \u003d 0;\n    for (int k \u003d logn; k \u0026gt;\u003d 0; k--) {\n        if (c[k][i]\u003d\u003dc[k][j]) {\n            res +\u003d (1 \u0026lt;\u0026lt; k);\n            i +\u003d (1 \u0026lt;\u0026lt; k);\n            i %\u003d n;\n            j +\u003d (1 \u0026lt;\u0026lt; k);\n            j %\u003d n;\n            if (res \u0026gt;\u003d n) {\n                res \u003d n;\n                break;\n            }\n        }\n    }\n    return res;\n}\n\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e","tags":[]}}