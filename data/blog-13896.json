{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1411287328,"rating":124,"authorHandle":"OO0OOO00O0OOO0O00OOO0OO","modificationTimeSeconds":1411441704,"id":13896,"title":"\u003cp\u003eCodeforces Round #268 Editorial\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eI\u0027ll upload my example solutions and will post links to them as soon as it becomes possible.\u003c/p\u003e\u003cp\u003eAll the problems in Div 1 don\u0027t have the unique solution. I list several solutions to each problems. There are also some interesting bonus problems. I can\u0027t solve some of them yet :( If you have interesting ideas, feel free to share and discuss your ideas in the comments. :)\u003c/p\u003e\u003cp\u003eMy English is poor, so if there are some mistakes or something you can\u0027t understand, you can also discuss it in the comments.\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/469/problem/A\" title\u003d\"Codeforces Round 268 (Div. 2)\"\u003e469A - I Wanna Be the Guy\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"http://kayin.moe/iwbtg/downloads.php\"\u003eI Wanna Be the Guy\u003c/a\u003e is an interesting game. I strongly recommend it to you.\u003c/p\u003e\u003cp\u003eThe problem itself is easy. Just check if all the levels could be passed by Little X or Little Y.\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/469/submission/7894174\" title\u003d\"Посылка 7894174 от apia\"\u003e7894174\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/469/problem/B\" title\u003d\"Codeforces Round 268 (Div. 2)\"\u003e469B - Онлайн чат\u003c/a\u003e\u003c/p\u003e\u003cp\u003eThis problem is not hard. Just iterator over all possible \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003c/span\u003e, and check if the schedule of Little X and Little Z will overlap.\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/469/submission/7894252\" title\u003d\"Посылка 7894252 от apia\"\u003e7894252\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eBonus:\u003c/strong\u003e\u003c/p\u003e \u003col\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e, \u003ci\u003eq\u003c/i\u003e ≤ 50, \u003ci\u003el\u003c/i\u003e, \u003ci\u003er\u003c/i\u003e ≤ 10\u003csup class\u003d\"upper-index\"\u003e9\u003c/sup\u003e\u003c/span\u003e\u003c/li\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e, \u003ci\u003eq\u003c/i\u003e, \u003ci\u003el\u003c/i\u003e, \u003ci\u003er\u003c/i\u003e ≤ 10\u003csup class\u003d\"upper-index\"\u003e5\u003c/sup\u003e\u003c/span\u003e\u003c/li\u003e \u003c/ol\u003e\u003cp\u003e\u003ca href\u003d\"/contest/468/problem/A\" title\u003d\"Codeforces Round 268 (Div. 1)\"\u003e468A - 24 Game\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eSolution 1:\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eIf \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e ≤ 3\u003c/span\u003e, it\u0027s easy to find that it\u0027s impossible to make \u003cspan class\u003d\"tex-span\"\u003e24\u003c/span\u003e, because the maximal number they can form is \u003cspan class\u003d\"tex-span\"\u003e9\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eIf \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e \u0026gt; 5\u003c/span\u003e, we can simply add \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e - (\u003ci\u003en\u003c/i\u003e - 1) \u003d 1, 24 * 1 \u003d 24\u003c/span\u003e at the end of the solution to the number \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e - 2\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eSo we can find the solution of \u003cspan class\u003d\"tex-span\"\u003e4, 5\u003c/span\u003e by hand. \u003cspan class\u003d\"tex-span\"\u003e1 * 2 * 3 * 4 \u003d 24, (5 - 3) * 4 * (2 + 1) \u003d 24\u003c/span\u003e\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/468/submission/7894267\" title\u003d\"Посылка 7894267 от apia\"\u003e7894267\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eSolution 2:\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eWe can find the pattern like that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e + (\u003ci\u003en\u003c/i\u003e + 3) - (\u003ci\u003en\u003c/i\u003e + 1) - (\u003ci\u003en\u003c/i\u003e + 2) \u003d 0\u003c/span\u003e, and find the solution of \u003cspan class\u003d\"tex-span\"\u003e4, 5, 6, 7\u003c/span\u003e by hand or brute forces.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eSolution 3:\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eA knapsack-like solution.\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/468/submission/7894283\" title\u003d\"Посылка 7894283 от apia\"\u003e7894283\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/468/problem/B\" title\u003d\"Codeforces Round 268 (Div. 1)\"\u003e468B - Два множества\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eSolution 1:\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eIf we have number \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e - \u003ci\u003ex\u003c/i\u003e\u003c/span\u003e, they should be in the same set. If \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/e4/5a/e45a074c88e41265bf0219586f4f1d6856bace4d.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, it\u0027s obvious that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/b4/2e/b42e9737fd39628a5ec4fbd69355d14b9ddc4131.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. The contraposition of it is \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/19/bc/19bc8e225d4f92eba17c70b39460dcf2bd9c1340.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, that means if \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/a7/38/a7387bd49676aa16b56d117e5fd0a4c01be0e223.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e - \u003ci\u003ex\u003c/i\u003e\u003c/span\u003e should in the set \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eB\u003c/i\u003e\u003c/span\u003e. Same as the number \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e, \u003ci\u003eb\u003c/i\u003e - \u003ci\u003ex\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eSo we can use Disjoint Set Union to merge the number that should be in the same set.\u003c/p\u003e\u003cp\u003eIf \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e - \u003ci\u003ex\u003c/i\u003e\u003c/span\u003e doesn\u0027t exist, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e can not be in the set \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003c/span\u003e. If \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e - \u003ci\u003ex\u003c/i\u003e\u003c/span\u003e doesn\u0027t exist, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003c/span\u003e can not be in the set \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eB\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eThen check if there are any conflicts among numbers which should be in the same set.\u003c/p\u003e\u003cp\u003eThere are many other solutions to solve this problem based on the fact that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ea\u003c/i\u003e - \u003ci\u003ex\u003c/i\u003e, \u003ci\u003eb\u003c/i\u003e - \u003ci\u003ex\u003c/i\u003e\u003c/span\u003e should be in the same set, like greedy, BFS and 2-SAT.\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/468/submission/7894313\" title\u003d\"Посылка 7894313 от apia\"\u003e7894313\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eSolution 2:\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eIf \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e \u003d \u003ci\u003eb\u003c/i\u003e\u003c/span\u003e, it\u0027s easy to find the solution.\u003c/p\u003e\u003cp\u003eWe regards every number as a node. Every number \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e links to number \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e - \u003ci\u003ex\u003c/i\u003e\u003c/span\u003e and number \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e - \u003ci\u003ex\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eThe degree of every node is at most \u003cspan class\u003d\"tex-span\"\u003e2\u003c/span\u003e. So this graph consists of a lot of chains and cycles, and some node may have self loop.\u003c/p\u003e\u003cp\u003eWe only need to check if the lengths of all the chains are even or the chain ends with a self loop.\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/468/submission/7894323\" title\u003d\"Посылка 7894323 от apia\"\u003e7894323\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eBonus:\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eProve there is no cycle in the graph described in the solution 2.\u003c/p\u003e\u003cp\u003eDivided all the numbers from \u003cspan class\u003d\"tex-span\"\u003e[0, \u003ci\u003en\u003c/i\u003e - 1]\u003c/span\u003e into two sets that have parameters \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e, \u003ci\u003eb\u003c/i\u003e\u003c/span\u003e. Can you solved it in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(1)\u003c/span\u003e?\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/468/problem/C\" title\u003d\"Codeforces Round 268 (Div. 1)\"\u003e468C - Взламываем!\u003c/a\u003e\u003c/p\u003e\u003cp\u003eDefine \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/5b/32/5b32a19a15e2136cb474d610eb6a9e856a41b5c2.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/05/bc/05bc856adb704b6e000a9feea6cb3ef6f198e850.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, so we should find a pair of number \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e, \u003ci\u003eb\u003c/i\u003e\u003c/span\u003e that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/06/95/06954eb8fb992abc8d042270fe7e5cdb0779ea48.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eSolution 1:\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eFirst we choose \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e randomly. Then we can use binary search to find the minimal \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e\u003c/span\u003e that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/aa/b3/aab3388b45357d215266004562d52cd9dfb0126d.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e .\u003c/p\u003e\u003cp\u003eSo \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/d8/ee/d8eea25418e6a33f7662b02d54de2c6e32bb07be.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e is very small, between \u003cspan class\u003d\"tex-span\"\u003e0\u003c/span\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/fc/8f/fc8f399c62bb3b33c222f1e9504742fc3e71be9f.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. If \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/b7/cc/b7cc6944cedb32aaa448e56c9c80260912edf1ad.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, after choosing \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e atmost \u003cspan class\u003d\"tex-span\"\u003e9 * \u003ci\u003elen\u003c/i\u003e + 2\u003c/span\u003e times, we can definitely find a pair that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/06/95/06954eb8fb992abc8d042270fe7e5cdb0779ea48.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/468/submission/7894341\" title\u003d\"Посылка 7894341 от apia\"\u003e7894341\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eSolution 2:\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eWe can use binary search to find the minimal \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e\u003c/span\u003e that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(\u003ci\u003ed\u003c/i\u003e) ≥ \u003ci\u003ea\u003c/i\u003e, \u003ci\u003eg\u003c/i\u003e(\u003ci\u003ed\u003c/i\u003e) ≥ 2\u003ci\u003ea\u003c/i\u003e, ...\u003c/span\u003e\u003c/p\u003e\u003cp\u003eThis solution is similar to the first one.\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/468/submission/7894452\" title\u003d\"Посылка 7894452 от apia\"\u003e7894452\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eSolution 3:\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eWe can use binary search to find the minimal \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e\u003c/span\u003e that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(\u003ci\u003ed\u003c/i\u003e) ≥ \u003ci\u003ea\u003c/i\u003e\u003c/span\u003e. And we use two pointers to maintain an interval \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e, \u003ci\u003er\u003c/i\u003e]\u003c/span\u003e that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/95/62/956241f1d2006054b4f35c3e207032945270231f.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e until we find \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/b0/c8/b0c8bc9321087901433c44f4591d29fe4296c53b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/p\u003e\u003cp\u003eI can\u0027t prove the correctness of this algorithm, but it performs well in practice.\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/468/submission/7894356\" title\u003d\"Посылка 7894356 от apia\"\u003e7894356\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eSolution 4:\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eThanks \u003ca class\u003d\"rated-user user-violet\" href\u003d\"/profile/ZhouYuChen\" title\u003d\"Кандидат в мастера ZhouYuChen\"\u003eZhouYuChen\u003c/a\u003e for his talented idea.\u003c/p\u003e\u003cp\u003eIf \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e \u0026lt; 10\u003csup class\u003d\"upper-index\"\u003e18\u003c/sup\u003e\u003c/span\u003e, we can get \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(10\u003csup class\u003d\"upper-index\"\u003e18\u003c/sup\u003e + \u003ci\u003ex\u003c/i\u003e) \u003d \u003ci\u003ef\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e) + 1\u003c/span\u003e. That means if we shift the interval \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003ex\u003c/i\u003e + 1, \u003ci\u003ex\u003c/i\u003e + 10\u003csup class\u003d\"upper-index\"\u003e18\u003c/sup\u003e]\u003c/span\u003e by \u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e, the result will be increase by \u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e too. And it also not hard to find that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(10\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/sup\u003e) \u003d 45 * \u003ci\u003ex\u003c/i\u003e * 10\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ex\u003c/i\u003e - 1\u003c/sup\u003e\u003c/span\u003e. So if \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/59/cb/59cb164099d43d44847f514d4f986acef44b720b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003ea\u003c/i\u003e - \u003ci\u003ex\u003c/i\u003e, \u003ci\u003ea\u003c/i\u003e - \u003ci\u003ex\u003c/i\u003e + 10\u003csup class\u003d\"upper-index\"\u003e18\u003c/sup\u003e - 1]\u003c/span\u003e is the answer.\u003c/p\u003e\u003cp\u003eIt\u0027s easy to see that upper bound of the answer is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/span\u003e, because of pigeonhole principle (among \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(0), \u003ci\u003eg\u003c/i\u003e(1), ..., \u003ci\u003eg\u003c/i\u003e(\u003ci\u003ea\u003c/i\u003e)\u003c/span\u003e at least two are equal). So big integer is not required in this problem.\u003c/p\u003e\u003cp\u003eIf solution 3 is correct, the upper bound of the answer can be \u003cspan class\u003d\"tex-span\"\u003e2 * 10\u003csup class\u003d\"upper-index\"\u003e16\u003c/sup\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/468/submission/7878473\" title\u003d\"Посылка 7878473 от ZhouYuChen\"\u003e7878473\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eBonus:\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eProve or disprove that solution 3 is correct.\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/468/problem/D\" title\u003d\"Codeforces Round 268 (Div. 1)\"\u003e468D - Дерево\u003c/a\u003e\u003c/p\u003e\u003cp\u003eI am sorry that this problem coincides with \u003ca href\u003d\"http://acm.hdu.edu.cn/showproblem.php?pid\u003d4118\"\u003ethat one\u003c/a\u003e.\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e) \u003d \u003ci\u003edep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eu\u003c/i\u003e\u003c/sub\u003e + \u003ci\u003edep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ev\u003c/i\u003e\u003c/sub\u003e - 2 * \u003ci\u003edep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eLCA\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/sub\u003e\u003c/span\u003e, so the answer is: \u003c/p\u003e\u003cp\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/ca/6d/ca6dafd25db5c0db39f4d17111514dcfd5fb5295.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e there means the distance between node \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e and root.\u003c/p\u003e\u003cp\u003eWe choose centroid of tree as root (let\u0027s denote it \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003c/span\u003e), so we can make every pair \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e are in different subtrees, that means \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eLCA\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e)\u003c/sub\u003e \u003d 0\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eSo the answer is \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/d2/7d/d27d9a0898ce081d97db45600129833562ca87b8.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/p\u003e\u003cp\u003eThe next part of this problem is find the lexicographically smallest solution.\u003c/p\u003e\u003cp\u003eWe regards it as finding the lexicographically smallest matching in a bipartite graph.\u003c/p\u003e\u003cp\u003eFor a subtree, if the amount of nodes in this subtree in the left part \u0026gt; the amount of nodes not in this subtree in the right part, the perfect matching doesn\u0027t exist. So the amount of nodes in this subtree in the left part + the amount of nodes in this subtree in the right part should be no more than the amount of nodes unmatched, while the root is an exception.\u003c/p\u003e\u003cp\u003eWe can use a segment tree to maintain it easily. We determined the minimum possible \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e from \u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e. If there is a subtree that the amount of nodes in this subtree in the left and right part is equal to the amount of nodes unmatched, we must select a node from it, so \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e equal to the node in this subtree with the minimum id. Otherwise, we can choose a node with the minimum id that is not in the same subtree with \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/468/submission/7894417\" title\u003d\"Посылка 7894417 от apia\"\u003e7894417\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"/contest/468/problem/E\" title\u003d\"Codeforces Round 268 (Div. 1)\"\u003e468E - Перманент\u003c/a\u003e\u003c/p\u003e\u003cp\u003eThe permanent can be obtained as follows: for each \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ee\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ee\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e, ..., \u003ci\u003ee\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003et\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e such that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ex\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ee\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/sub\u003e..., \u003ci\u003ex\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ee\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003et\u003c/i\u003e\u003c/sub\u003e\u003c/sub\u003e\u003c/span\u003e are distinct and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ey\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ee\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/sub\u003e, \u003ci\u003ey\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ee\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/sub\u003e, ..., \u003ci\u003ey\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ee\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003et\u003c/i\u003e\u003c/sub\u003e\u003c/sub\u003e\u003c/span\u003e are distinct, add \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/e1/f2/e1f21770e649ef958e3c0878afc41f3d7266d6b5.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e to the answer.\u003c/p\u003e\u003cp\u003eIt can be proved by the formula : \u003c/p\u003e\u003cp\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/66/56/66568953e73ff8d7a7cd837e8a29e057956f5f87.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e,\u003c/p\u003e\u003cp\u003ewhere \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003c/span\u003e are subsets of the same size of \u003cspan class\u003d\"tex-span\"\u003e{1, 2, ..., \u003ci\u003en\u003c/i\u003e}\u003c/span\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/81/e2/81e2a46589f990c7d2b02d162857c5e22fcd5648.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/49/dd/49dd2d22c8cab0263c5e00dc84b554dcdca62e1b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e are their respective complements in that set.\u003c/p\u003e\u003cp\u003eConstruct a undirected graph \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eG\u003c/i\u003e\u003c/span\u003e with \u003cspan class\u003d\"tex-span\"\u003e2\u003ci\u003en\u003c/i\u003e\u003c/span\u003e vertices \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ev\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ev\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e, ..., \u003ci\u003ev\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003ci\u003en\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e, where the edge weight between vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ev\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e, \u003ci\u003ev\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003en\u003c/i\u003e + \u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e - 1\u003c/span\u003e. We only need to know the sum of weight of all matchings that we choose \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003c/span\u003e edges. The weight of matching is the product of all edge weights in the matching.\u003c/p\u003e\u003cp\u003eWe only need to know the sum of the weights that we choose \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e edges in the each connected components.\u003c/p\u003e\u003cp\u003eThe number of nodes in a connected component is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e\u003c/span\u003e and the number of edges in this connected component is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eAlgorithm 1:\u003c/p\u003e\u003cp\u003eBecause it\u0027s a bipartite graph, so the number of vertices in one part is at most \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e / 2\u003c/span\u003e. So we can use state compressed dp to calculate the ways to choose \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e edges in this connected component. The complexity is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(2\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003es\u003c/i\u003e / 2\u003c/sup\u003e * \u003ci\u003es\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003c/sup\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eAlgorithm 2:\u003c/p\u003e\u003cp\u003eWe can choose a spanning tree. The number of edges in spanning tree of these vertices is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e - 1\u003c/span\u003e, and the number of non-tree edges is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e - \u003ci\u003es\u003c/i\u003e + 1\u003c/span\u003e. So we can enumerate all the non-tree edge, use tree dp to calculate the ways. The complexity is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(2\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003et\u003c/i\u003e - \u003ci\u003es\u003c/i\u003e\u003c/sup\u003e * \u003ci\u003es\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003c/sup\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eCombined with these two algorithm, the complexity is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003emin\u003c/i\u003e(2\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003es\u003c/i\u003e / 2\u003c/sup\u003e, 2\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e - \u003ci\u003es\u003c/i\u003e\u003c/sup\u003e) * \u003ci\u003es\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003c/sup\u003e)) \u003d \u003ci\u003eO\u003c/i\u003e(2\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ek\u003c/i\u003e / 3\u003c/sup\u003e * \u003ci\u003ek\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003c/sup\u003e)\u003c/span\u003e.\u003c/p\u003e\u003c/div\u003e","tags":[]}}