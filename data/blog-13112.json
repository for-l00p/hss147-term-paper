{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1405814691,"rating":25,"authorHandle":"jzzhu","modificationTimeSeconds":1431953692,"id":13112,"title":"\u003cp\u003eCodeforces Round #257 Editorial\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003ch4\u003e\u003ca href\u003d\"/contest/450/problem/A\" title\u003d\"Codeforces Round 257 (Div. 2)\"\u003e450A - Jzzhu and Children\u003c/a\u003e\u003c/h4\u003e\u003cp\u003eYou can simply simulate it or find the last maximum \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eceil\u003c/i\u003e(\u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e / \u003ci\u003em\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003ch4\u003e\u003ca href\u003d\"/contest/450/problem/B\" title\u003d\"Codeforces Round 257 (Div. 2)\"\u003e450B - Jzzhu and Sequences\u003c/a\u003e\u003c/h4\u003e\u003cp\u003eWe can easily find that every \u003cspan class\u003d\"tex-span\"\u003e6\u003c/span\u003e numbers are the same. It\u0027s like \u003cspan class\u003d\"tex-span\"\u003e{\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e - \u003ci\u003ex\u003c/i\u003e,  - \u003ci\u003ex\u003c/i\u003e,  - \u003ci\u003ey\u003c/i\u003e, \u003ci\u003ex\u003c/i\u003e - \u003ci\u003ey\u003c/i\u003e, \u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e - \u003ci\u003ex\u003c/i\u003e, ...}\u003c/span\u003e.\u003c/p\u003e\u003ch4\u003e\u003ca href\u003d\"/contest/449/problem/A\" title\u003d\"Codeforces Round 257 (Div. 1)\"\u003e449A - Jzzhu and Chocolate\u003c/a\u003e / \u003ca href\u003d\"/contest/450/problem/C\" title\u003d\"Codeforces Round 257 (Div. 2)\"\u003e450C - Jzzhu and Chocolate\u003c/a\u003e\u003c/h4\u003e\u003cp\u003eWe assume that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e ≤ \u003ci\u003em\u003c/i\u003e\u003c/span\u003e (if \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e \u0026gt; \u003ci\u003em\u003c/i\u003e\u003c/span\u003e, we can simply swap \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e).\u003c/p\u003e\u003cp\u003eIf we finally cut the chocolate into \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e rows and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ey\u003c/i\u003e\u003c/span\u003e columns \u003cspan class\u003d\"tex-span\"\u003e(1 ≤ \u003ci\u003ex\u003c/i\u003e ≤ \u003ci\u003en\u003c/i\u003e, 1 ≤ \u003ci\u003ey\u003c/i\u003e ≤ \u003ci\u003em\u003c/i\u003e, \u003ci\u003ex\u003c/i\u003e + \u003ci\u003ey\u003c/i\u003e \u003d \u003ci\u003ek\u003c/i\u003e + 2)\u003c/span\u003e, we should maximize the narrowest row and maximize the narrowest column, so the answer will be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003efloor\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e / \u003ci\u003ex\u003c/i\u003e) * \u003ci\u003efloor\u003c/i\u003e(\u003ci\u003em\u003c/i\u003e / \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eThere are two algorithms to find the optimal \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e \u003col\u003e   \u003cli\u003e\u003cp\u003eNotice that if \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e * \u003ci\u003ey\u003c/i\u003e\u003c/span\u003e is smaller, the answer usually will be better. Then we can find that if \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e \u0026lt; \u003ci\u003en\u003c/i\u003e\u003c/span\u003e, the optimal \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e can only be \u003cspan class\u003d\"tex-span\"\u003e{\u003ci\u003ex\u003c/i\u003e \u003d 1, \u003ci\u003ey\u003c/i\u003e \u003d \u003ci\u003ek\u003c/i\u003e + 1}\u003c/span\u003e or \u003cspan class\u003d\"tex-span\"\u003e{\u003ci\u003ex\u003c/i\u003e \u003d \u003ci\u003ek\u003c/i\u003e + 1, \u003ci\u003ey\u003c/i\u003e \u003d 1}\u003c/span\u003e. If \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e ≤ \u003ci\u003ek\u003c/i\u003e \u0026lt; \u003ci\u003em\u003c/i\u003e\u003c/span\u003e, the optimal \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e can only be \u003cspan class\u003d\"tex-span\"\u003e{\u003ci\u003ex\u003c/i\u003e \u003d 1, \u003ci\u003ey\u003c/i\u003e \u003d \u003ci\u003ek\u003c/i\u003e + 1}\u003c/span\u003e. If \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e ≤ \u003ci\u003ek\u003c/i\u003e ≤ \u003ci\u003en\u003c/i\u003e + \u003ci\u003em\u003c/i\u003e - 2\u003c/span\u003e, the optimal \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e can only be \u003cspan class\u003d\"tex-span\"\u003e{\u003ci\u003ex\u003c/i\u003e \u003d \u003ci\u003ek\u003c/i\u003e + 2 - \u003ci\u003em\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e \u003d \u003ci\u003em\u003c/i\u003e}\u003c/span\u003e, because let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e \u003d \u003ci\u003em\u003c/i\u003e - \u003ci\u003en\u003c/i\u003e\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e / (\u003ci\u003ek\u003c/i\u003e + 2 - \u003ci\u003em\u003c/i\u003e) ≥ (\u003ci\u003en\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e) / (\u003ci\u003ek\u003c/i\u003e + 2 - \u003ci\u003em\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e) ≥ 1\u003c/span\u003e.\u003c/p\u003e\u003c/li\u003e   \u003cli\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003efloor\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e / \u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e has at most \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/23/25/23252b0fc4d48df9962f8b56307b87565eba520a.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e values, so we can enum it and choose the maximum \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e for each value.\u003c/p\u003e\u003c/li\u003e \u003c/ol\u003e\u003ch4\u003e\u003ca href\u003d\"/contest/449/problem/B\" title\u003d\"Codeforces Round 257 (Div. 1)\"\u003e449B - Jzzhu and Cities\u003c/a\u003e / \u003ca href\u003d\"/contest/450/problem/D\" title\u003d\"Codeforces Round 257 (Div. 2)\"\u003e450D - Jzzhu and Cities\u003c/a\u003e\u003c/h4\u003e\u003cp\u003eWe consider a train route \u003cspan class\u003d\"tex-span\"\u003e(1, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e as an undirected deletable edge \u003cspan class\u003d\"tex-span\"\u003e(1, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eLet \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edist\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e)\u003c/span\u003e be the shortest path between \u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003c/span\u003e. We add all of the edges \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e weighted \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ew\u003c/i\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edist\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e) + \u003ci\u003ew\u003c/i\u003e \u003d \u003ci\u003edist\u003c/i\u003e(\u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e into a new directed graph.\u003c/p\u003e\u003cp\u003eA deletable edge \u003cspan class\u003d\"tex-span\"\u003e(1, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e can be deleted only if it isn\u0027t in the new graph or the in-degree of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ev\u003c/i\u003e\u003c/span\u003e in the new graph is more than \u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e, because the connectivity of the new graph won\u0027t be changed after deleting these edges. Notice that you should subtract one from the in-degree of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ev\u003c/i\u003e\u003c/span\u003e after you delete an edge \u003cspan class\u003d\"tex-span\"\u003e(1, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003ch4\u003e\u003ca href\u003d\"/contest/449/problem/C\" title\u003d\"Codeforces Round 257 (Div. 1)\"\u003e449C - Jzzhu and Apples\u003c/a\u003e / \u003ca href\u003d\"/contest/450/problem/E\" title\u003d\"Codeforces Round 257 (Div. 2)\"\u003e450E - Jzzhu and Apples\u003c/a\u003e\u003c/h4\u003e\u003cp\u003eFirstly, we should notice that \u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e and the primes larger than \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e / 2\u003c/span\u003e can not be matched anyway, so we ignore these numbers.\u003c/p\u003e\u003cp\u003eLet\u0027s consider each prime \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eP\u003c/i\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e2 \u0026lt; \u003ci\u003eP\u003c/i\u003e ≤ \u003ci\u003eN\u003c/i\u003e / 2\u003c/span\u003e. For each prime \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eP\u003c/i\u003e\u003c/span\u003e, we find all of the numbers which are unmatched and have a divisor \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eP\u003c/i\u003e\u003c/span\u003e. Let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eM\u003c/i\u003e\u003c/span\u003e be the count of those numbers we found. If \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eM\u003c/i\u003e\u003c/span\u003e is even, then we can match those numbers perfectly. Otherwise, we throw the number \u003cspan class\u003d\"tex-span\"\u003e2\u003ci\u003eP\u003c/i\u003e\u003c/span\u003e and the remaining numbers can be matched perfectly.\u003c/p\u003e\u003cp\u003eFinally, only even numbers may be unmatched and we can match them in any way.\u003c/p\u003e\u003ch4\u003e\u003ca href\u003d\"/contest/449/problem/D\" title\u003d\"Codeforces Round 257 (Div. 1)\"\u003e449D - Jzzhu and Numbers\u003c/a\u003e\u003c/h4\u003e\u003cp\u003eFirstly, we can use inclusion-exclusion principle in this problem. Let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e be the count of number \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u0026amp;x \u003d \u003ci\u003ex\u003c/i\u003e\u003c/span\u003e. Let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e be the number of \u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e in the binary respresentation of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e. Then the answer equals to \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/b8/ef/b8ef0aa8cb4f894c4cf4c84ef5600d1779108b16.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/p\u003e\u003cp\u003eNow the task is to calculate \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e for every integer \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e between \u003cspan class\u003d\"tex-span\"\u003e0\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e2\u003csup class\u003d\"upper-index\"\u003e20\u003c/sup\u003e\u003c/span\u003e. Let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sub\u003e(\u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e be the count of number \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eY\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e0\u003c/sub\u003e\u0026amp;X\u003csub class\u003d\"lower-index\"\u003e0\u003c/sub\u003e \u003d \u003ci\u003eX\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e0\u003c/sub\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e \u003d \u003ci\u003eY\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e (they are defined below).\u003c/p\u003e\u003cp\u003eWe divide \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e into two parts, the first \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e binary bits and the other \u003cspan class\u003d\"tex-span\"\u003e20 - \u003ci\u003ek\u003c/i\u003e\u003c/span\u003e binary bits. Let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e0\u003c/sub\u003e\u003c/span\u003e be the first part of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e be the second part of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e. Let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eY\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e0\u003c/sub\u003e\u003c/span\u003e be the first part of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eY\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e be the second part of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eWe can calculate \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sub\u003e(\u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(1)\u003c/span\u003e:\u003c/p\u003e\u003cp\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/af/c1/afc1daf719d1c888e96811c5b79f9e5bb1d82df6.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eThe problem can be solved in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e * 2\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/sup\u003e)\u003c/span\u003e now (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e \u003d 20\u003c/span\u003e in this problem).\u003c/p\u003e\u003ch4\u003e\u003ca href\u003d\"/contest/449/problem/E\" title\u003d\"Codeforces Round 257 (Div. 1)\"\u003e449E - Jzzhu and Squares\u003c/a\u003e\u003c/h4\u003e\u003cp\u003eConsider there is only one query.\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"http://yc5-yc.github.io/psb.jpg\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eLet me descripe the picture above.\u003c/p\u003e\u003cp\u003eA grid-square can be exactly contained by a bigger square which coincide with grid lines. Let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eL\u003c/i\u003e\u003c/span\u003e be the length of a side of the bigger square. Let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e be the minimum distance between a vertice of the grid-square and a vertice of the bigger square. Let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003eL\u003c/i\u003e, \u003ci\u003ei\u003c/i\u003e)\u003c/span\u003e be the number of cells which are fully contained by the grid-square.\u003c/p\u003e\u003cp\u003eWe can divide a grid-square into four right triangles and a center square. For each right triangle, the number of cells which are crossed by an edge of the triangle is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eL\u003c/i\u003e - \u003ci\u003egcd\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003eL\u003c/i\u003e)\u003c/span\u003e. Then, the number of cells which are fully contained by the triangle is \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003ei\u003c/i\u003e(\u003ci\u003eL\u003c/i\u003e - \u003ci\u003ei\u003c/i\u003e) - \u003ci\u003eL\u003c/i\u003e + \u003ci\u003egcd\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003eL\u003c/i\u003e)] / 2\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003eL\u003c/i\u003e, \u003ci\u003ei\u003c/i\u003e) \u003d (\u003ci\u003eL\u003c/i\u003e - 2\u003ci\u003ei\u003c/i\u003e)\u003csup class\u003d\"upper-index\"\u003e2\u003c/sup\u003e + 2[\u003ci\u003ei\u003c/i\u003e(\u003ci\u003eL\u003c/i\u003e - \u003ci\u003ei\u003c/i\u003e) - \u003ci\u003eL\u003c/i\u003e + \u003ci\u003egcd\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003eL\u003c/i\u003e)] \u003d \u003ci\u003eL\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003c/sup\u003e - 2\u003ci\u003eiL\u003c/i\u003e + 2\u003ci\u003ei\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003c/sup\u003e - 2\u003ci\u003eL\u003c/i\u003e + 2\u003ci\u003egcd\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003eL\u003c/i\u003e)\u003c/span\u003e\u003c/p\u003e\u003cp\u003eFirstly, we enum \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eL\u003c/i\u003e\u003c/span\u003e from \u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emin\u003c/i\u003e(\u003ci\u003eN\u003c/i\u003e, \u003ci\u003eM\u003c/i\u003e)\u003c/span\u003e. Then the task is to calculate \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/84/e9/84e9fa5d7d89b7415c562cf446ccbacc1a8f63a7.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/2e/88/2e88c5f43fa58319b51807d61ab6c8fdcc5b5171.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e can be calculated by the following steps: \u003c/p\u003e \u003col\u003e   \u003cli\u003e\u003cp\u003eEnum all of the divisor \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eL\u003c/i\u003e\u003c/span\u003e and the task is to calculate the count of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003egcd\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003eL\u003c/i\u003e) \u003d \u003ci\u003ek\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003c/li\u003e   \u003cli\u003e\u003cp\u003eThe count of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003egcd\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003eL\u003c/i\u003e) \u003d \u003ci\u003ek\u003c/i\u003e\u003c/span\u003e equals to \u003cspan class\u003d\"tex-span\"\u003eφ(\u003ci\u003eL\u003c/i\u003e / \u003ci\u003ek\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003c/li\u003e \u003c/ol\u003e\u003cp\u003eFinally, \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/90/e7/90e78fc5e0bc640a1dac5092affe93266e134361.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/p\u003e\u003cp\u003eIf there are multiple queries, we can calculate the prefix sum of \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/0e/50/0e5062d03f8d75c263e78c52cae1ac7232b8f070.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/cb/40/cb401ed2741dabed96853d97289e7a17f1835f3c.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/3d/a8/3da8839e3e2410b76a7fcd51f731d376a981a2d9.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, then we can answer each query in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(1)\u003c/span\u003e.\u003c/p\u003e\u003c/div\u003e","tags":[]}}