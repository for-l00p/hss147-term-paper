{"status":"OK","result":{"originalLocale":"ru","allowViewHistory":false,"creationTimeSeconds":1420124936,"rating":8,"authorHandle":"KonanMentor","modificationTimeSeconds":1420124936,"id":15527,"title":"\u003cp\u003eПрибавление на отрезке + количество чисел на отрезке\u003c/p\u003e","locale":"ru","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eЕсть массив чисел. Как быстро отвечать на запросы\u003c/p\u003e \u003cul\u003e   \u003cli\u003eприбавить число на отрезке\u003c/li\u003e   \u003cli\u003eузнать сколько раз число встречается на отрезке?\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eПока что ничего быстрее \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/9a/f4/9af4b06f8f17d32c53609242d0543d6137721ed1.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e не придумал.\u003c/p\u003e\u003cp\u003eЕсли кому интересно, идея sqrt-декомпозиции:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eразобьем массив на \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/90/d5/90d5a6cd550a25d4a1e92f4f6e6a222c64aa7a2e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e блоков\u003c/li\u003e   \u003cli\u003eдля каждого блока будем хранить   \u003cul\u003e     \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ecnt\u003c/i\u003e[\u003ci\u003ex\u003c/i\u003e]\u003c/span\u003e — количество чисел \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e в блоке\u003c/li\u003e     \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edelta\u003c/i\u003e\u003c/span\u003e — число, которое надо прибавить ко всем числам в этом блоке\u003c/li\u003e   \u003c/ul\u003e\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eТогда на запрос прибавления числа \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eD\u003c/i\u003e\u003c/span\u003e на отрезке будем отвечать так:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eЕсли блок полностью входит в отрезок, то изменим его \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edelta\u003c/i\u003e\u003c/span\u003e на \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eD\u003c/i\u003e\u003c/span\u003e\u003c/li\u003e   \u003cli\u003e\u003cp\u003eИначе пройдемся по элементам, которые лежат в границах запроса, и просто добавим к ним \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eD\u003c/i\u003e\u003c/span\u003e\u003c/p\u003e   \u003cpre\u003e\u003ccode\u003ecnt[a[i]] --;\na[i] +\u003d D;\ncnt[a[i]] ++;\n\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eЗапрос о количестве чисел \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e\u003c/span\u003e на отрезке:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eЕсли блок полностью входит в отрезок, просто вернем \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ecnt\u003c/i\u003e[\u003ci\u003eX\u003c/i\u003e - \u003ci\u003edelta\u003c/i\u003e]\u003c/span\u003e\u003c/li\u003e   \u003cli\u003eСреди остальных элементов учтем те, которые равны \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e - \u003ci\u003edelta\u003c/i\u003e\u003c/span\u003e\u003c/li\u003e \u003c/ul\u003e\u003c/div\u003e","tags":["хочу","log n"]}}