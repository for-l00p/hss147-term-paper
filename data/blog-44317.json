{"status":"OK","result":{"originalLocale":"en","allowViewHistory":true,"creationTimeSeconds":1460450905,"rating":9,"authorHandle":"shadowfax","modificationTimeSeconds":1460495648,"id":44317,"title":"\u003cp\u003eHow to solve ICPC Amritapuri 2015 regional\u0027s Coprimes problem?\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eHi Codeforces,\u003c/p\u003e\u003cp\u003eI have been trying to solve \u003ca href\u003d\"https://icpcarchive.ecs.baylor.edu/index.php?option\u003dcom_onlinejudge\u0026amp;Itemid\u003d8\u0026amp;page\u003dshow_problem\u0026amp;problem\u003d5585\"\u003ethis\u003c/a\u003e problem for quite a while but failed. Any help would be appreciated :)\u003c/p\u003e\u003cp\u003eThe problem: Given an array of N integers and Q queries, in each query find number of subsets of size K of the subarray [L, R] such that each subsets\u0027 GCD is 1. Answer is modulo 10^9 + 7. \u003cbr /\u003e \u003ca href\u003d\"https://icpcarchive.ecs.baylor.edu/external/75/7563.pdf\"\u003eProblem Link\u003c/a\u003e\u003c/p\u003e\u003cp\u003eConstraints: \u003cbr /\u003e 1 ≤ N ≤ 50000 \u003cbr /\u003e 1 ≤ L ≤ R ≤ N \u003cbr /\u003e 1 ≤ Q ≤ 50000 \u003cbr /\u003e 1 ≤ A[i] ≤ 10000 \u003cbr /\u003e 1 ≤ K ≤ R − L + 1\u003c/p\u003e\u003cp\u003eI have tried with Mobius function and inclusion-exclusion technique but it takes too much time and memory (\u003ca href\u003d\"http://ideone.com/5yszjX\"\u003emy code\u003c/a\u003e). I guess I will have to use some kind of data structure but can not figure out which one and how? Thank you.\u003c/p\u003e\u003c/div\u003e","tags":["number theory","inclusion-exclusion"]}}