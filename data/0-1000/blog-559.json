{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1280403253,"rating":6,"authorHandle":"YuukaKazami","modificationTimeSeconds":1280417316,"id":559,"title":"Code Force Beta Round 19 Solution","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cdiv style\u003d\"text-align: left;\"\u003e\u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 13.5pt;font-family: Simsun , serif;color: black;\"\u003eI find that no one write a solution about this contest..So I write one..\u003c/span\u003e\u003c/p\u003e  \u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 19.0pt;font-family: Arial , sans-serif;color: black;\"\u003eA. World Football Cup\u003c/span\u003e\u003cb\u003e\u003cspan style\u003d\"font-size: 21.5pt;font-family: Verdana , sans-serif;color: black;\"\u003e\u003c/span\u003e\u003c/b\u003e\u003c/p\u003e  \u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 14.0pt;font-family: Simsun , serif;color: black;\"\u003eI think is\u0027 just a problem about writing code \u003c/span\u003e\u003c/p\u003e  \u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 14.0pt;font-family: Simsun , serif;color: black;\"\u003equickly and correctly.Just follow the statement.\u003c/span\u003e\u003c/p\u003e  \u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 14.0pt;font-family: Simsun , serif;color: black;\"\u003eif you use c++ STL will make you life easier\u003c/span\u003e\u003c/p\u003e  \u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 19.0pt;font-family: Arial , sans-serif;color: black;\"\u003eB. Checkout Assistant\u003c/span\u003e\u003cb\u003e\u003cspan style\u003d\"font-size: 21.5pt;font-family: Verdana , sans-serif;color: black;\"\u003e\u003c/span\u003e\u003c/b\u003e\u003c/p\u003e  \u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 14.0pt;font-family: Simsun , serif;color: black;\"\u003eFirst,for every i increase t\u003csub\u003ei\u003c/sub\u003e by 1..then you will\u003c/span\u003e\u003c/p\u003e  \u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 14.0pt;font-family: Simsun , serif;color: black;\"\u003e see that statement require sum of t of the items\u003cb\u003e\u003c/b\u003e\u003c/span\u003e\u003c/p\u003e  \u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 14.0pt;font-family: Simsun , serif;color: black;\"\u003e bigger or equal to n..and their sum of c should \u003cb\u003e\u003c/b\u003e\u003c/span\u003e\u003c/p\u003e  \u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 14.0pt;font-family: Simsun , serif;color: black;\"\u003ebe minimal..so it\u0027s just a 0-1 knapsack problem.\u003cb\u003e\u003c/b\u003e\u003c/span\u003e\u003c/p\u003e  \u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 19.0pt;font-family: Arial , sans-serif;color: black;\"\u003eC. Deletion of Repeats\u003c/span\u003e\u003cb\u003e\u003cspan style\u003d\"font-size: 17.0pt;font-family: Verdana , sans-serif;color: black;\"\u003e\u003c/span\u003e\u003c/b\u003e\u003c/p\u003e  \u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 14.0pt;font-family: Simsun , serif;color: black;\"\u003eFirst let\u0027s generate all repeats.In a repeat,the\u003cbr /\u003e  first number and the middle number must be the \u003cbr /\u003e same, so we just look at all pair of postion which \u003cbr /\u003e have same number..Thank to the statement..There \u003cbr /\u003e are at most O(10N) such pair..And use suffix array \u003cbr /\u003e to check if each pair can build a repeat...Then \u003cbr /\u003e just sort all the interval and go through then to \u003cbr /\u003e get the answer...\u003cbr /\u003e\u003ca href\u003d\"http://en.wikipedia.org/wiki/Suffix_array\"\u003ehttp://en.wikipedia.org/wiki/Suffix_array\u003c/a\u003e\u003cbr /\u003emaybe you think suffix array is hard to code..you \u003cbr /\u003ecan use hash and binary search to do the same..\u003cbr /\u003emy code here \u003c/span\u003e\u003ca href\u003d\"http://www.ideone.com/N5zPS\"\u003ehttp://www.ideone.com/N5zPS\u003c/a\u003e\u003c/p\u003e  \u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 19.0pt;font-family: Arial , sans-serif;color: black;\"\u003eD. Points\u003cbr /\u003e \u003c/span\u003e\u003cspan style\u003d\"font-size: 14.0pt;font-family: Simsun , serif;color: black;\"\u003eFirst of all,do the discretization.Then the biggest \u003cbr /\u003e value of x is n,so we can build a Segment Tree to \u003cbr /\u003e Ask the question \u0026quot;what is the first place from  \u003cbr /\u003e postion x and its value is bigger than y\u0026quot;..if we \u003cbr /\u003e find such postion we just find the smallest Y-value \u003cbr /\u003e bigger than y in such postion--it can be done using \u003cbr /\u003e set\u0027s operation upper_bound...\u003cbr /\u003e\u003ca href\u003d\"http://en.wikipedia.org/wiki/Segment_tree\"\u003ehttp://en.wikipedia.org/wiki/Segment_tree\u003c/a\u003e\u003cbr /\u003e so the algorithm is clear..For every possible value \u003cbr /\u003e of x use a set to store all y value in it..And every \u003cbr /\u003e time the action is \u0026quot;find\u0026quot; or \u0026quot;remove\u0026quot; just change \u003cbr /\u003e this set and update the Segment Tree..otherwise use \u003cbr /\u003e Segment Tree to find the answer..\u003c/span\u003e\u003c/p\u003e\u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 14.0pt;font-family: Simsun , serif;color: black;\"\u003e\u003c/span\u003e\u003cspan style\u003d\"font-family: Simsun , serif;font-size: 22.0px;\"\u003emy code here \u003c/span\u003e\u003ca href\u003d\"http://www.ideone.com/4iNol\"\u003ehttp://www.ideone.com/4iNol\u003c/a\u003e\u003c/p\u003e\u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 19.0pt;font-family: Arial , sans-serif;color: black;\"\u003eE. Fairy\u003c/span\u003e\u003cspan style\u003d\"font-size: 14.0pt;font-family: Arial , sans-serif;color: black;\"\u003e\u003cbr /\u003e \u003c/span\u003e\u003cspan style\u003d\"font-size: 14.0pt;font-family: Simsun , serif;color: black;\"\u003eIt\u0027s a interesting problem.If you for every edge, \u003cbr /\u003e try to remove it and check if it is a bipartite \u003cbr /\u003e graph..I think it will get TLE..so let\u0027s analysis \u003cbr /\u003e the property of bipartite graph..\u003cbr /\u003e\u003ca href\u003d\"http://en.wikipedia.org/wiki/Bipartite_graph\"\u003ehttp://en.wikipedia.org/wiki/Bipartite_graph\u003c/a\u003e\u003cbr /\u003eAfter reading it...we know..\u003cbr /\u003e It should never contain a cycle of odd length...\u003cbr /\u003e and it can be 2-colored..\u003cbr /\u003e so first build a spanning forest for the graph..\u003cbr /\u003e and do the 2-color on it(Tree can be 2-colored).\u003cbr /\u003e for convenience.\u003cbr /\u003e Let TreeEdge\u003d{all edge in forest}\u003cbr /\u003e NotTreeEdge\u003d{All edge}/TreeEdge\u003cbr /\u003e ErrorEdge\u003d{all edge that two endpoint have the same color..}\u003cbr /\u003e NotErorEdge\u003dNotTreeEdge/ErroEdge..\u003cbr /\u003e First,consider a edge form NotTreeEdge,remove it \u003cbr /\u003e can\u0027t change any node\u0027s color..so..\u003c/span\u003e\u003c/p\u003e  \u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 14.0pt;font-family: Simsun , serif;color: black;\"\u003eif |ErrorEdge|\u003d0 of course we can remove all NotTreeEdge\u003c/span\u003e\u003c/p\u003e  \u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 14.0pt;font-family: Simsun , serif;color: black;\"\u003eif \u003d1 we just can remove the ErrorEdge\u003c/span\u003e\u003c/p\u003e  \u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 14.0pt;font-family: Simsun , serif;color: black;\"\u003eif \u0026gt;1 we can\u0027t remove any from NotTreeEdge\u003cbr /\u003e Now,Let consider a Edge e from TreeEdge..\u003cbr /\u003e Let Path(Edge e)\u003dthe path in forest between e\u0027s two endpoints..\u003cbr /\u003e if there is a Edge e\u0027 from ErrorEdge that Path(e\u0027) \u003cbr /\u003e didn\u0027t  go through e..it will destroy the bipartite \u003cbr /\u003e graph..\u003cbr /\u003e if there is a Edge e\u0027 from ErrorEdge that Path(e\u0027) go through e and there is a Edge e\u0027\u0027 from NotErrorEdge that Path(e\u0027\u0027) go through e..it will also destroy the bipartite graph..\u003cbr /\u003e so now we need to know for every edge,how many such path go through it..it require a data structure...\u003cbr /\u003e one way is to use heavy-light decomposition then we can update every path in O(LogN^2)...\u003cbr /\u003e another way is to use Link-Cut Tree..It can do the same in O(LogN)....\u003cbr /\u003eif you didn\u0027t see Link-Cut tree before,you can read this\u003c/span\u003e\u003c/p\u003e\u003cp align\u003d\"left\" style\u003d\"text-align: left;\"\u003e\u003cspan style\u003d\"font-size: 14.0pt;font-family: Simsun , serif;color: black;\"\u003e\u003ca href\u003d\"http://en.wikipedia.org/wiki/Link/cut_tree\"\u003ehttp://www.cs.cmu.edu/~sleator/papers/dynamic-trees.pdf\u003c/a\u003e\u003cbr /\u003eor my code..use heavy-light decomposition \u003c/span\u003e\u003ca href\u003d\"http://www.ideone.com/dPS5N\"\u003ehttp://www.ideone.com/dPS5N\u003c/a\u003e\u003c/p\u003e\u003c/div\u003e\u003c/div\u003e","tags":["solution"]}}