{"status":"OK","result":{"originalLocale":"ru","allowViewHistory":false,"creationTimeSeconds":1281999222,"rating":29,"authorHandle":"ivan.popelyshev","modificationTimeSeconds":1282063384,"id":611,"title":"Разбор Codeforces Beta Round #26 (ещё один)","locale":"ru","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cdiv class\u003d\"from-renderer\"\u003e\u003cdiv class\u003d\"from-renderer\"\u003e   \u003cdiv class\u003d\"from-renderer\"\u003e     \u003cdiv class\u003d\"from-renderer\"\u003e       \u003cdiv class\u003d\"from-renderer\"\u003e         \u003cdiv class\u003d\"from-renderer\"\u003e           \u003cdiv class\u003d\"from-renderer\"\u003e             \u003cdiv class\u003d\"from-renderer\"\u003e               \u003cdiv class\u003d\"from-renderer\"\u003e                 \u003cdiv class\u003d\"from-renderer\"\u003e                   \u003cdiv class\u003d\"from-renderer\"\u003e                     \u003cdiv class\u003d\"from-renderer\"\u003eНачнём с конца.\u003cbr /\u003e\u003cbr /\u003e                       \u003ch2\u003e\u003ca href\u003d\"http://codeforces.ru/contest/26/problem/E\"\u003eЗадача E. Multithreading\u003c/a\u003e\u003cbr /\u003e\u003c/h2\u003eПридётся разобрать несколько случаев. Пусть \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003c/span\u003e это сумма всех \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e. Если \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eW\u003c/i\u003e ≤ 0\u003c/span\u003e или \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eW\u003c/i\u003e \u0026gt; \u003ci\u003eS\u003c/i\u003e\u003c/span\u003e то, очевидно, ответ IMPOSSIBLE. В случае \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e \u003d 1\u003c/span\u003e ответ существует только при \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eW\u003c/i\u003e \u003d \u003ci\u003eS\u003c/i\u003e\u003c/span\u003e, это \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003c/span\u003e итераций единственного потока.\u003cbr /\u003e\u003cbr /\u003eЗапишем вместо номеров потока скобки разных видов, расставить открывающие и закрывающие просто - соответствующие пары скобок одного типа должны идти последовательно, не пересекаяся. Если в программе есть подпоследовательность типа [(]) то можно заменить её на ([]), понятно, что результат будет тот же. Таким образом, достаточно помещать итерации разных потоков одну в другую, как скобки.\u003cbr /\u003e\u003cbr /\u003eПолучить \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eW\u003c/i\u003e \u003d 1\u003c/span\u003e можно только поместив все пары скобок внутрь какой-то одной. Поскольку пара скобок не может содержать пару такого же типа, найти найти такой \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e, что \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e \u003d 1\u003c/span\u003e. Если же такого \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e нету, ответ IMPOSSIBLE.\u003cbr /\u003e \u003cbr /\u003eВ остальных случаях помогает следующая стратегия. Пусть \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eW\u003c/i\u003e - \u003ci\u003eS\u003c/i\u003e \u003d \u003ci\u003eK\u003c/i\u003e\u003c/span\u003e, значит надо \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eK\u003c/i\u003e ≤ \u003ci\u003eS\u003c/i\u003e - 2\u003c/span\u003e пар скобок поместить внутрь. Возьмём два потока, \u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e и \u003cspan class\u003d\"tex-span\"\u003e2\u003c/span\u003e, зарезервируем по одной итерации (паре скобок) каждого из этих потоков для того, чтобы помещать них \u0026quot;лишние\u0026quot; итерации, назовём их \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e и \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e. В качестве \u0026quot;лишних\u0026quot; итераций можно взять любые \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eK\u003c/i\u003e\u003c/span\u003e итераций относящиеся к любым потокам, только итерации второго потока следует размещать внутрь \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e, а итерации первого - в \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e.\u003cbr /\u003eОставшиеся \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eW\u003c/i\u003e - 2\u003c/span\u003e итераций расположим последовательно, без пересечений.\u003cbr /\u003e\u003cbr /\u003e                       \u003ch2\u003e\u003ca href\u003d\"http://codeforces.ru/contest/26/problem/D\"\u003eЗадача D. Билеты\u003c/a\u003e\u003ca href\u003d\"../../../contest/2/problem/B\"\u003e\u003cbr /\u003e\u003c/a\u003e\u003c/h2\u003eВсё просто. Если пришёл покупатель с десяткой, то записываем открывающую скобку, с двадцаткой - закрывающую. Будет \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e открывающих скобок и \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e закрывающих. Требуется посчитать вероятность того, что в баланс в получившейся скобочной последовательности баланс не падал меньше \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e.\u003cbr /\u003eПонятно, что если \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e ≥ \u003ci\u003em\u003c/i\u003e\u003c/span\u003e, то ответ \u003cspan class\u003d\"tex-span\"\u003e1.0\u003c/span\u003e, а если \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e + \u003ci\u003en\u003c/i\u003e \u0026lt; \u003ci\u003em\u003c/i\u003e\u003c/span\u003e то ответ \u003cspan class\u003d\"tex-span\"\u003e0.0\u003c/span\u003e.\u003cbr /\u003eВ остальных случаях можно применить принцип отражения, использующийся при \u003ca href\u003d\"http://e-maxx.ru/algo/catalan_numbers\"\u003eаналитическом выводе формулы для чисел Каталана\u003c/a\u003e.\u003cbr /\u003eТребуется найти количество монотонных путей в решётке \u003cspan class\u003d\"tex-span\"\u003e(0, 0) × (\u003ci\u003en\u003c/i\u003e, \u003ci\u003em\u003c/i\u003e)\u003c/span\u003e таких, что не содержат точек \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e + \u003ci\u003ek\u003c/i\u003e \u0026lt; \u003ci\u003ey\u003c/i\u003e\u003c/span\u003e. В каждом не подходящем нам пути можно взять первое ребро, лежащее выше линии \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e + \u003ci\u003ek\u003c/i\u003e \u003d \u003ci\u003ey\u003c/i\u003e\u003c/span\u003e, и отразить весь оставшийся за ним путь, получив таким образом монотонный путь в решётке \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003en\u003c/i\u003e + \u003ci\u003ek\u003c/i\u003e + 1) × (\u003ci\u003em\u003c/i\u003e - \u003ci\u003ek\u003c/i\u003e - 1)\u003c/span\u003e. Соответствие является биективным.\u003cbr /\u003eПолучим, что количество путей не подходящих путей  равно \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eC\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003em\u003c/i\u003e - \u003ci\u003ek\u003c/i\u003e - 1\u003c/sup\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003em\u003c/i\u003e + \u003ci\u003en\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e. Общее число путей равно \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eC\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/sup\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003en\u003c/i\u003e + \u003ci\u003em\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e. Значит вероятность того что баланс нарушится - \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eP\u003c/i\u003e \u003d \u003ci\u003eC\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003em\u003c/i\u003e - \u003ci\u003ek\u003c/i\u003e - 1\u003c/sup\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003em\u003c/i\u003e + \u003ci\u003en\u003c/i\u003e\u003c/sub\u003e / \u003ci\u003eC\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/sup\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003en\u003c/i\u003e + \u003ci\u003em\u003c/i\u003e\u003c/sub\u003e \u003d \u003ci\u003em\u003c/i\u003e(\u003ci\u003em\u003c/i\u003e - 1)(\u003ci\u003em\u003c/i\u003e - 2)...(\u003ci\u003em\u003c/i\u003e - \u003ci\u003ek\u003c/i\u003e) / (\u003ci\u003en\u003c/i\u003e + \u003ci\u003ek\u003c/i\u003e + 1) / (\u003ci\u003en\u003c/i\u003e + \u003ci\u003ek\u003c/i\u003e) / ... / (\u003ci\u003en\u003c/i\u003e + 1)\u003c/span\u003e.\u003cbr /\u003eОтветом является число \u003cspan class\u003d\"tex-span\"\u003e1.0 - \u003ci\u003eP\u003c/i\u003e\u003c/span\u003e\u003cbr /\u003e\u003cbr /\u003e\u003ch2\u003e\u003ca href\u003d\"http://codeforces.ru/contest/26/problem/C\"\u003eЗадача С. Паркет\u003c/a\u003e\u003c/h2\u003eПри нечётном числе строк и столбцов ответа нет.\u003cbr /\u003eПри чётном числе строк и столбцов можно объединить пары вертикальных и горизонтальных паркетин чтобы получить недостающие квадратики \u003cspan class\u003d\"tex-span\"\u003e2 × 2\u003c/span\u003e.\u003cbr /\u003eПри нечётном числе строк надо выложить одну строку из горизонтальных кусочков паркета, перейдя таким образом к случаю чётное \u003cspan class\u003d\"tex-span\"\u003e × \u003c/span\u003e чётное.\u003cbr /\u003eАналогично с нечётным числом столбцов.\u003cbr /\u003e\u003cbr /\u003eНумеровать куски можно по-разному, лично я для обозначения кусочка с левым верхним углом \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e использовал букву номер \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e + 5\u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e mod \u003cspan class\u003d\"tex-span\"\u003e26\u003c/span\u003e. Это гарантирует что в квадрате длиной 5 с центром \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e таких же букв нет.\u003cbr /\u003e\u003ca href\u003d\"http://codeforces.ru/contest/26/problem/B\"\u003e\u003cbr /\u003e\u003c/a\u003e\u003ch2\u003e\u003ca href\u003d\"http://codeforces.ru/contest/26/problem/B\"\u003eЗадача B. Правильная скобочная последовательность\u003c/a\u003e\u003ca href\u003d\"../../../contest/26/problem/C\"\u003e\u003cbr /\u003e\u003c/a\u003e\u003c/h2\u003eПройдём по строчке, попутно считая ответ. Будем складывать открывающие скобки без пары в стек (достаточно хранить их количество). Если встретили открывающую - кладём её в стек. Если встретили закрывающую скобку, и в запасе есть хоть одна открывающая - достаём её из запаса, а ответ увеличиваем на \u003cspan class\u003d\"tex-span\"\u003e2\u003c/span\u003e.\u003cbr /\u003e\u003cbr /\u003e\u003ch2\u003e\u003ca href\u003d\"http://codeforces.ru/contest/26/problem/A\"\u003eЗадача A. Почти простые числа\u003c/a\u003e\u003ca href\u003d\"../../../contest/26/problem/C\"\u003e\u003cbr /\u003e   \u003c/a\u003e\u003c/h2\u003eРассчитаем все простые числа до \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e. Для каждого натурального числа меньшего \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e проверим, что оно делится ровно на два простых, затем увеличим ответ.\u003cbr /\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e","tags":["codeforces beta","tutorial","разбор"]}}