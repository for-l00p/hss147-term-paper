{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1403628131,"rating":1,"authorHandle":"ikbal","modificationTimeSeconds":1403628131,"id":12826,"title":"\u003cp\u003eB\u0027nin Cozumu\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;algorithm\u0026gt;\n#include \u0026lt;iostream\u0026gt;\n#include \u0026lt;cstring\u0026gt;\n#include \u0026lt;complex\u0026gt;\n#include \u0026lt;cassert\u0026gt;\n#include \u0026lt;cstdlib\u0026gt;\n#include \u0026lt;climits\u0026gt;\n#include \u0026lt;cstdio\u0026gt;\n#include \u0026lt;vector\u0026gt;\n#include \u0026lt;string\u0026gt;\n#include \u0026lt;cmath\u0026gt;\n#include \u0026lt;ctime\u0026gt;\n#include \u0026lt;queue\u0026gt;\n#include \u0026lt;list\u0026gt;\n#include \u0026lt;map\u0026gt;\n#include \u0026lt;set\u0026gt;\n\n#define all(x) (x).begin(), (x).end()\n#define type(x) __typeof((x).begin())\n#define foreach(it,x) for(__typeof(x.begin()) it \u003d x.begin() ; it!\u003dx.end() ; it++ )\n\n#ifdef KAZAR\n    #define eprintf(...) fprintf(stderr,__VA_ARGS__)\n#else\n    #define eprintf(...) 0\n#endif\n\nusing namespace std;\n\ntemplate\u0026lt;class T\u0026gt; inline void umax(T \u0026amp;a,T b){if(a\u0026lt;b) a \u003d b ; }\ntemplate\u0026lt;class T\u0026gt; inline void umin(T \u0026amp;a,T b){if(a\u0026gt;b) a \u003d b ; }\ntemplate\u0026lt;class T\u0026gt; inline T abs(T a){return a\u0026gt;0 ? a : -a;}\ntemplate\u0026lt;class T\u0026gt; inline T gcd(T a,T b){return __gcd(a, b);}\ntemplate\u0026lt;class T\u0026gt; inline T lcm(T a,T b){return a/gcd(a,b)*b;}\n\nconst int inf \u003d 1e9 + 143;\nconst long long longinf \u003d 1e18 + 143;\n\ninline int read(){int x;scanf(\u0026quot; %d\u0026quot;,\u0026amp;x);return x;}\n\nconst int N \u003d 1 \u0026lt;\u0026lt; 17;\n\nchar s[N];\nint sa[N], lcp[N], rank[N];\npair\u0026lt;pair\u0026lt;int, int\u0026gt;, int\u0026gt; p[N];\n\npair\u0026lt;int, int\u0026gt; f[N \u0026lt;\u0026lt; 1];\n\nint get(int l,int r){\n    l +\u003d N - 1; r +\u003d N - 1;\n    pair\u0026lt;int, int\u0026gt; res \u003d make_pair(inf, inf);\n    while(l \u0026lt;\u003d r){\n        if(l \u0026amp; 1)\n            umin(res, f[l++]);\n        if(~r \u0026amp; 1)\n            umin(res, f[r--]);\n        l \u0026gt;\u0026gt;\u003d 1;\n        r \u0026gt;\u0026gt;\u003d 1;\n    }\n    return res.second;\n}\n\nlong long calc(int x){\n    return (long long)x * (x + 1) / 2;\n}\n\nlong long solve(int l,int r,int del){\n    if(l \u0026gt; r)\n        return 0;\n    int p \u003d get(l, r);\n    return solve(l, p - 1, lcp[p]) + solve(p + 1, r, lcp[p]) + calc(r - l + 1) * (lcp[p] - del);\n}\n\nint main(){\n\n#ifdef KAZAR\n    freopen(\u0026quot;f.input\u0026quot;,\u0026quot;r\u0026quot;,stdin);\n    freopen(\u0026quot;f.output\u0026quot;,\u0026quot;w\u0026quot;,stdout);\n    freopen(\u0026quot;error\u0026quot;,\u0026quot;w\u0026quot;,stderr);\n#endif\n\n    scanf(\u0026quot; %s\u0026quot;,s + 1);\n\n    int n \u003d strlen(s + 1);\n\n    for(int i \u003d 1; i \u0026lt;\u003d n; i++) rank[i] \u003d s[i] - \u0027a\u0027 + 1;\n    for(int g \u003d 1; g \u0026lt;\u003d n; g \u0026lt;\u0026lt;\u003d 1){\n        for(int i \u003d 1; i \u0026lt;\u003d n; i++){\n            p[i] \u003d make_pair(make_pair(rank[i], rank[i + g]), i);\n        }\n        sort(p + 1, p + 1 + n);\n        int ptr \u003d 1;\n        for(int i \u003d 1; i \u0026lt;\u003d n; i++){\n            if(i \u0026gt; 1 \u0026amp;\u0026amp; p[i].first !\u003d p[i - 1].first)\n                ++ptr;\n            rank[p[i].second] \u003d ptr;\n        }\n    }\n\n    for(int i \u003d 1; i \u0026lt;\u003d n; i++) sa[rank[i]] \u003d i;\n\n    int cur \u003d 0;\n    for(int i \u003d 1; i \u0026lt;\u003d n; i++){\n        int next \u003d sa[rank[i] + 1];\n        while(i + cur \u0026lt;\u003d n \u0026amp;\u0026amp; next + cur \u0026lt;\u003d n \u0026amp;\u0026amp; s[i + cur] \u003d\u003d s[next + cur])\n            ++cur;\n        lcp[rank[i]] \u003d cur;\n        if(cur \u0026gt; 0)\n            --cur;\n    }\n\n    for(int i \u003d 0; i \u0026lt; N + N; i++) f[i] \u003d make_pair(inf, inf);\n    for(int i \u003d 1; i \u0026lt; n; i++)\n        f[i + N - 1] \u003d make_pair(lcp[i], i);\n\n    for(int i \u003d N - 1; i \u0026gt; 0; i--)\n        f[i] \u003d min(f[i + i], f[i + i + 1]);\n\n    cout \u0026lt;\u0026lt; solve(1, n - 1, 0) \u0026lt;\u0026lt; endl;\n\n    return 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":[]}}