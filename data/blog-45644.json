{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1466839765,"rating":10,"authorHandle":"I_love_Hoang_Yen","modificationTimeSeconds":1466878551,"id":45644,"title":"\u003cp\u003eTH Training 3 — Solutions\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003ch1\u003e\u003ca href\u003d\"/group/ThSS9mn0dy/contest/207665/problem/A\" title\u003d\"TH Training 3\"\u003e207665A - Hình chữ nhật\u003c/a\u003e\u003c/h1\u003e\u003ch2\u003eN^4\u003c/h2\u003e\u003cp\u003eDùng kĩ thuật mảng cộng dồn, ta dễ dàng tính được tổng của 1 hình chữ nhật có 2 đỉnh đối nhau là \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e\u003c/p\u003e\u003cp\u003eKhởi tạo mảng cộng dồn:\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e \u003d tổng các số trong hình chữ nhật có 2 đỉnh đối nhau là \u003cspan class\u003d\"tex-span\"\u003e(1, 1)\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e--\u0026gt; \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e) \u003d \u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e - 1, \u003ci\u003ej\u003c/i\u003e) + \u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e - 1) - \u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e - 1, \u003ci\u003ej\u003c/i\u003e - 1) + \u003ci\u003eA\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e với \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e là số ở ô \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e--\u0026gt; tổng các số trong 1 hình chữ nhật có 2 đỉnh đối diện \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e, nếu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e ≤ \u003ci\u003eu\u003c/i\u003e\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e ≤ \u003ci\u003ev\u003c/i\u003e\u003c/span\u003e là:\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e) - \u003ci\u003eS\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e - 1) - \u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e - 1, \u003ci\u003ev\u003c/i\u003e) + \u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e - 1, \u003ci\u003ej\u003c/i\u003e - 1)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eNhư vậy ta có thể tính tổng 1 hình chữ nhật bất kỳ trong \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(1)\u003c/span\u003e. Từ đó ta có thuật toán \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e4\u003c/sup\u003e\u003c/span\u003e rất đơn giản: Xét tất cả các hình chữ nhật con trong bảng, với mỗi hình kiểm tra tổng các phần tử bên trong nó có đủ \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eK\u003c/i\u003e\u003c/span\u003e hay không.\u003c/p\u003e\u003ch2\u003eN^3\u003c/h2\u003e\u003cp\u003e1 hình chữ nhật được xác định bởi 4 biến: tọa độ của 2 đỉnh đối diện. \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e. Thông thường cách tiếp cận các bài toán có nhiều biến chưa biết là ta duyệt 1 vài biến và tìm các biến còn lại trong thời gian đủ nhanh.\u003c/p\u003e\u003cp\u003eỞ đây ta duyệt 2 biến i và u. Nói cách khác là ta cố định cạnh trên và cạnh dưới của hình chữ nhật. Khi đó, mỗi cột luôn gồm các số từ hàng i đến hàng u. Nếu ta đặt\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e(\u003ci\u003ej\u003c/i\u003e) \u003d \u003ci\u003esum\u003c/i\u003e(\u003ci\u003eA\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e) + \u003ci\u003eA\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e + 1, \u003ci\u003ej\u003c/i\u003e) + ... + \u003ci\u003eA\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e))\u003c/span\u003e\u003c/p\u003e\u003cp\u003ethì bài toán trở thành bài toán 1 chiều: cho 1 dãy số \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e. Tìm l và r sao cho \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e - \u003ci\u003el\u003c/i\u003e + 1\u003c/span\u003e nhỏ nhất và tổng các phần tử từ l đến r lớn hơn hoặc bằng \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eK\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eĐể giải bài toán này, thì ta nhận thấy, khi r di chuyển sang phải, thì l cũng di chuyển sang phải, nên ta có thể thu được thuật toán \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003eN\u003c/i\u003e)\u003c/span\u003e như sau:\u003c/p\u003e \u003cpre\u003e\u003ccode\u003eint l \u003d 1;\nfor (int r \u003d 1; r \u0026lt;\u003d N; r++) {\n    // chạy l theo r chừng nào vẫn có thể chạy được\n    while (l \u0026lt; r \u0026amp;\u0026amp; sum(l+1, r) \u0026lt;\u003d K) ++l; // hàm sum(l, r) trả lại tổng các số l --\u0026gt; r trong O(1)\n                                           // dùng kĩ thuật mảng cộng dồn\n    if (sum(l, r) \u0026gt;\u003d K) {\n        // cập nhật kết quả theo [l, r]\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003ca href\u003d\"http://ideone.com/n2wdOC\"\u003eCode\u003c/a\u003e\u003c/p\u003e\u003ch1\u003e\u003ca href\u003d\"/group/ThSS9mn0dy/contest/207665/problem/B\" title\u003d\"TH Training 3\"\u003e207665B - Xử lý xâu\u003c/a\u003e\u003c/h1\u003e\u003ch2\u003eTư tưởng\u003c/h2\u003e\u003cp\u003eNhận xét: các bài toán vòng tròn (ví dụ như bài này là xoay xâu theo vòng tròn) thường rất khó giải quyết. Kĩ năng thông thường là ta tìm các đưa các bài đó về đường thẳng rồi giải quyết. Có 2 cách thông thường:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eCắt vòng tròn tại 1 điểm\u003c/li\u003e   \u003cli\u003eNhân đôi\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eỞ bài này ta sẽ nhân đôi xâu lên.\u003c/p\u003e\u003cp\u003eXét xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027 \u003d \u003ci\u003eAHYANGYIAHYANGYI\u003c/i\u003e\u003c/span\u003e. Ta thấy mỗi cách xoay vòng tròn xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003c/span\u003e tương ứng với 1 substring của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027\u003c/span\u003e độ dài \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eLS\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eNhư vậy, bài toán trở thành: với mỗi đoạn con dài \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027\u003c/span\u003e, đếm số cách để biến nó thành xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eVới mỗi đoạn con dài \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027\u003c/span\u003e, có 3 trường hợp:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eNó và xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e không khác nhau --\u0026gt; Có \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e cách thay đổi\u003c/li\u003e   \u003cli\u003eNó và xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e khác nhau ở đúng 1 vị trí --\u0026gt; Có 1 cách thay đổi\u003c/li\u003e   \u003cli\u003eNó và xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e khác nhau ở ít nhất 2 vị trí --\u0026gt; Không có cách thay đổi nào cả.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eNhư vậy, việc quan trọng nhất là đếm số vị trí khác nhau của 2 xâu.\u003c/p\u003e\u003cp\u003eCụ thể, với mỗi đoạn \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e, \u003ci\u003er\u003c/i\u003e]\u003c/span\u003e trên xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027\u003c/span\u003e, ta sẽ cần biết:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eĐoạn kết thúc ở \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027\u003c/span\u003e khớp với bao nhiêu kí tự cuối của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e\u003c/li\u003e   \u003cli\u003eĐoạn bắt đầu ở \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027\u003c/span\u003e khớp với bao nhiêu kí tự đầu của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eTừ 2 thông tin đó ta có thể xác định được đoạn \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e, \u003ci\u003er\u003c/i\u003e]\u003c/span\u003e thuộc trường hợp nào trong 3 trường hợp nói trên.\u003c/p\u003e\u003ch2\u003eHash\u003c/h2\u003e\u003cp\u003eSử dụng hash, ta dễ dàng so sánh 2 xâu con có bằng nhau hay không trong \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(1)\u003c/span\u003e. Như vậy, bằng chặt nhị phân, ta có thể tính được các thông tin trên trong \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003elogN\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003ch2\u003eKMP\u003c/h2\u003e\u003cp\u003eKhi áp dụng thuật toán KMP với xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e, ở mỗi vị trí trên xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027\u003c/span\u003e ta biết được nó khớp với nhiều nhất bao nhiêu kí tự đầu của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e. Ví dụ:\u003c/p\u003e \u003cpre\u003e\u003ccode\u003eS \u003d ABCABC\nT \u003d ABC\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThì ta biết ở vị trí 5 trên xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003c/span\u003e khớp được với 2 vị trí đầu của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e, vị trí 6 của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003c/span\u003e khớp với 3 vị trí đầu của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e. Cái này bị ngược với cái mà ta cần tính --\u0026gt; \u003ccode\u003e:@)\u003c/code\u003e. Cách giải quyết xem trong code kỳ diệu phía dưới.\u003c/p\u003e\u003ch2\u003eZ-function\u003c/h2\u003e\u003cp\u003eĐịnh nghĩa hàm Z giống hệt như cái mình cần tính ở bài này --\u0026gt; nếu biết Z chỉ cần chép vào là AC.\u003c/p\u003e\u003cp\u003eCode:\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003ca href\u003d\"http://ideone.com/aHOzb7\"\u003eKMP\u003c/a\u003e\u003c/li\u003e   \u003cli\u003e\u003ca href\u003d\"http://ideone.com/9Hz5Zy\"\u003eHash\u003c/a\u003e\u003c/li\u003e   \u003cli\u003e\u003ca href\u003d\"http://ideone.com/FjPB7k\"\u003eZ-Function\u003c/a\u003e\u003c/li\u003e \u003c/ul\u003e\u003ch1\u003e\u003ca href\u003d\"/group/ThSS9mn0dy/contest/207665/problem/C\" title\u003d\"TH Training 3\"\u003e207665C - Vòng tròn nhị phân\u003c/a\u003e\u003c/h1\u003e\u003cp\u003eBài này là 1 bài tìm 1 nghiệm với \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e cho trước. Với bài kiểu này ta có 1 vài hướng thông thường:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eDuyệt để tìm pattern.\u003c/li\u003e   \u003cli\u003eXây dựng nghiệm với \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e từ các nghiệm với các \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e nhỏ hơn.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eỞ bài này ta xây dựng nghiệm \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e từ nghiệm của \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e - 2\u003c/span\u003e.\u003c/p\u003e \u003cul\u003e   \u003cli\u003eVới \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e ≤ 3\u003c/span\u003e, nghiệm đã được cho trong đề bài.\u003c/li\u003e   \u003cli\u003eVới \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e ≥ 4\u003c/span\u003e, đầu tiên ta sinh kết quả cho \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e - 2\u003c/span\u003e, sau đó ta ghép 4 bộ nghiệm lại, đồng thời thêm các cặp 2 ký tự cuối vào sao cho phù hợp. Chú ý rằng ta có thể làm như vậy được do tính chất vòng tròn của bài toán.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eKhi ghép, ta cần đảm bảo:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eKhông có 2 xâu nào trùng nhau. Vì ta lặp lại kết quả của \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e - 2\u003c/span\u003e 4 lần, nên với xâu, trong 4 lần lặp, ta phải thêm các cặp 2 bit khác nhau.\u003c/li\u003e   \u003cli\u003eĐảm bảo 2 xâu liên tiếp khác nhau \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e / 2\u003c/span\u003e bit: với 2 xâu liên tiếp, nó đã khác nhau \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eN\u003c/i\u003e - 2) / 2\u003c/span\u003e bit rồi, nên khi thêm 2 bit mới, 1 trong 2 bit của 2 xâu liên tiếp phải khác nhau.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eCode:\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003ca href\u003d\"http://ideone.com/89WIQj\"\u003eRR\u003c/a\u003e\u003c/li\u003e   \u003cli\u003e\u003ca href\u003d\"http://ideone.com/kHn8E7\"\u003eVinh\u003c/a\u003e\u003c/li\u003e \u003c/ul\u003e\u003ch1\u003e\u003ca href\u003d\"/group/ThSS9mn0dy/contest/207665/problem/D\" title\u003d\"TH Training 3\"\u003e207665D - Cuộc tụ tập của đàn mèo\u003c/a\u003e\u003c/h1\u003e\u003ch2\u003e1D\u003c/h2\u003e\u003cp\u003eTrước tiên, ta tìm cách giải bài toán trên 1D.\u003c/p\u003e\u003cp\u003eTrên 1D, mỗi mèo có tọa độ \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003exi\u003c/i\u003e\u003c/span\u003e và các mèo có thể di chuyển sang trái hoặc phải.\u003c/p\u003e\u003cp\u003eTọa độ khá nhỏ nên ta có thể duyệt tất cả các điểm gặp gỡ, mỗi điểm gặp gỡ thì ta xét lần lượt từng mèo, tính số cách để mèo đấy đến điểm gặp nhau.\u003c/p\u003e\u003cp\u003eCó khoảng \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003emaxtọađộ\u003c/i\u003e + \u003ci\u003eM\u003c/i\u003e)\u003c/span\u003e vị trí gặp nhau. Với mỗi vị trí gặp nhau, với mỗi mèo, ta tính số cách để mèo di chuyển từ vị trí X đến vị trí gặp nhau Y.\u003c/p\u003e\u003cp\u003eĐặt \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e là số lần mèo di chuyển sang trái Đặt \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e là số lần mèo di chuyển sang phải\u003c/p\u003e\u003cp\u003e--\u0026gt; \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e + \u003ci\u003er\u003c/i\u003e \u003d \u003ci\u003eM\u003c/i\u003e\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e - \u003ci\u003el\u003c/i\u003e + \u003ci\u003er\u003c/i\u003e \u003d \u003ci\u003eY\u003c/i\u003e\u003c/span\u003e\u003c/p\u003e\u003cp\u003eTừ đó tính được \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e. Dùng tổ hợp tính đc số cách di chuyển là \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eC\u003c/i\u003e(\u003ci\u003eM\u003c/i\u003e, \u003ci\u003el\u003c/i\u003e)\u003c/span\u003e\u003c/p\u003e\u003ch2\u003e2D\u003c/h2\u003e\u003cp\u003eĐiểm khó nhất của bài này là 2 tọa độ ảnh hưởng nhau: mỗi lần di chuyển 1 tọa độ, mà tổng số lần di chuyển có hạn. Ví dụ ta di chuyển \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e lần theo trục trái phải, thì chỉ còn \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eM\u003c/i\u003e - \u003ci\u003ex\u003c/i\u003e\u003c/span\u003e lần theo trục lên xuống.\u003c/p\u003e\u003cp\u003eTa thực hiện phép xoay hệ tọa độ góc 45 độ:\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e) -  \u0026gt; (\u003ci\u003ex\u003c/i\u003e + \u003ci\u003ey\u003c/i\u003e, \u003ci\u003ex\u003c/i\u003e - \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eSau khi xoay hệ tọa độ, từ 1 điểm \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e, ta đi sang 4 ô: \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e - 1, \u003ci\u003ev\u003c/i\u003e - 1)\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e - 1, \u003ci\u003ev\u003c/i\u003e + 1)\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e + 1, \u003ci\u003ev\u003c/i\u003e - 1)\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e + 1, \u003ci\u003ev\u003c/i\u003e + 1)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eKhi xoay trục như vậy, 1 cách kỳ diệu, ta thấy rằng 2 hướng di chuyển không còn phụ thuộc nhau \u003ccode\u003e:-O\u003c/code\u003e. (mỗi bước di chuyển di chuyển theo cả 2 trục --\u0026gt; ta di chuyển theo mỗi trục đúng \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eM\u003c/i\u003e\u003c/span\u003e bước).\u003c/p\u003e\u003cp\u003eDo đó, ta có thể xét riêng 2 trục tọa độ rồi nhân kết quả lại.\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"http://ideone.com/KmBJ2E\"\u003eCode\u003c/a\u003e\u003c/p\u003e\u003c/div\u003e","tags":[]}}