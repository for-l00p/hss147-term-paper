{"status":"OK","result":{"originalLocale":"ru","allowViewHistory":true,"creationTimeSeconds":1517326226,"rating":-1,"authorHandle":"Dekabr","modificationTimeSeconds":1517326226,"id":57440,"title":"\u003cp\u003eMKTHNUM\u003c/p\u003e","locale":"ru","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003e\u003ca href\u003d\"http://www.spoj.com/problems/MKTHNUM/\"\u003eMasala shartini ochish\u003c/a\u003e\u003c/p\u003e \u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\n#define N 1\u0026lt;\u0026lt;22\nint L[N];\nint R[N];\nint t[N];\nint root[N];\nint a[N];\n\nint n,next_free_index\u003d0;\nvoid build(int v,int tl\u003d1,int tr\u003dn) {\n    if (tl!\u003dtr) {\n        int tm\u003d(tl+tr)\u0026gt;\u0026gt;1;\n        L[v]\u003d++next_free_index;\n        R[v]\u003d++next_free_index;\n        build(L[v],tl,tm);\n        build(R[v],tm+1,tr);\n    }\n}\nvoid update(int v,int orig_v,int pos,int tl\u003d1,int tr\u003dn) {\n    if (tl\u003d\u003dtr) {\n        t[v]\u003d1;\n    } else {\n        int tm\u003d(tl+tr)\u0026gt;\u0026gt;1;\n        if (pos\u0026lt;\u003dtm) {\n            L[v]\u003d++next_free_index;\n            R[v]\u003dR[orig_v];\n            update(L[v],L[orig_v],pos,tl,tm);\n        } else {\n            L[v]\u003dL[orig_v];\n            R[v]\u003d++next_free_index;\n            update(R[v],R[orig_v],pos,tm+1,tr);\n        }\n        t[v]\u003dt[L[v]]+t[R[v]];\n    }\n}\nint sum(int v,int l,int r,int tl\u003d1,int tr\u003dn) {\n    if (l\u0026gt;tr||r\u0026lt;tl) return 0;\n    if (l\u0026lt;\u003dtl\u0026amp;\u0026amp;tr\u0026lt;\u003dr) return t[v];\n    int tm\u003d(tl+tr)\u0026gt;\u0026gt;1;\n\n    return (sum(L[v],l,r,tl,tm)+sum(R[v],l,r,tm+1,tr));\n}\nvoid answer(int lv,int v,int k,int tl\u003d1,int tr\u003dn) {\n    if (tl\u003d\u003dtr) {\n        cout\u0026lt;\u0026lt;tl\u0026lt;\u0026lt;endl;\n    } else {\n        int tm\u003d(tl+tr)\u0026gt;\u0026gt;1;\n        int X\u003dt[L[v]]-t[L[lv]];\n        if (X\u0026gt;\u003dk) answer(L[lv],L[v],k,tl,tm);\n        else answer(R[lv],R[v],k-X,tm+1,tr);\n    }\n}\nvoid print(int v,int tl\u003d1,int tr\u003dn) {\n    if (tl\u003d\u003dtr) {\n        if (t[v]) cout\u0026lt;\u0026lt;\u0026quot;@\u0026quot;; else cout\u0026lt;\u0026lt;\u0026quot;_\u0026quot;;\n        if (tr\u003d\u003dn) cout\u0026lt;\u0026lt;endl;\n    } else {\n        int tm\u003d(tl+tr)\u0026gt;\u0026gt;1;\n        print(L[v],tl,tm);\n        print(R[v],tm+1,tr);\n    }\n}\nint main() {\n    int m;\n    cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;m;\n    for (int i\u003d1;i\u0026lt;\u003dn;i++) cin\u0026gt;\u0026gt;a[i];\n    build(0);\n\n    for (int i\u003d1;i\u0026lt;\u003dn;i++) {\n        root[i]\u003d++next_free_index;\n        update(root[i],root[i-1],a[i]);\n        print(root[i]);\n    }\n\n    for (int i\u003d0;i\u0026lt;m;i++) {\n        int l,r,k;\n        cin\u0026gt;\u0026gt;l\u0026gt;\u0026gt;r\u0026gt;\u0026gt;k;\n        answer(root[l-1],root[r],k);\n    }\n\n\n\n\n    return 0;\n}\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["persistent","tree","data structure","sample code"]}}