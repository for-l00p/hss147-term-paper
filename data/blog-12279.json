{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1399960203,"rating":26,"authorHandle":"johnathan79717","modificationTimeSeconds":1400122417,"id":12279,"title":"\u003cp\u003eAlternative solution for part 2 of SEAGM — May Challenge 2014 — CodeChef\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003e\u003ca href\u003d\"http://www.codechef.com/problems/SEAGM\"\u003eProblem\u003c/a\u003e, \u003ca href\u003d\"http://discuss.codechef.com/questions/42555/seagm-editorial\"\u003eEditorial\u003c/a\u003e\u003c/p\u003e \u003cblockquote\u003e\u003cp\u003eGiven n numbers a[1] to a[n], 2 player play a game alternately as follows. In the beginning of game, we have a number g \u003d 0. They chose one of the numbers in the array a which is not thrown out and replace g by gcd(g, a[i]). After that they throw a[i]. If at any time in the game g becomes 1, the person who made the value g of equal to 1 loses. If a person is not able to move, then also he loses.\u003c/p\u003e\u003cp\u003eThere are two questions to answer. 1. Who will win if they play optimally. 2. What is probability of winning of first player if they play randomly. \u003c/p\u003e \u003c/blockquote\u003e\u003cp\u003eI\u0027d like to share my solution to part 2 which is different from the editorial.\u003c/p\u003e\u003cp\u003eAny game they play is a permutation of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/span\u003e (let them play all \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e numbers, even someone already lose). Let\u0027s call this permutation \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003c/span\u003e. Since they play uniformly randomly, the permutation is also chosen uniformly randomly from all \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e!\u003c/span\u003e permutations.\u003c/p\u003e\u003cp\u003eLet \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/69/5c/695ccdb4e0d7792ffb9942e3a1d03ce33cb1b8f4.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e for \u003cspan class\u003d\"tex-span\"\u003e1 ≤ \u003ci\u003ek\u003c/i\u003e ≤ \u003ci\u003en\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eIf the game ends exactly on the \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e th turn, that means \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/1c/f0/1cf07a41bbe18cfbac4a88d83102a29b44a239af.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, but \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/d7/93/d7934b837e2c5489433d0342ad735961f922dd8d.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Therefore the probability is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eprob\u003c/i\u003e(\u003ci\u003ek\u003c/i\u003e - 1) - \u003ci\u003eprob\u003c/i\u003e(\u003ci\u003ek\u003c/i\u003e)\u003c/span\u003e. If \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eprob\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e + 1)\u003c/span\u003e is defined as \u003cspan class\u003d\"tex-span\"\u003e0\u003c/span\u003e, then \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e \u003d \u003ci\u003en\u003c/i\u003e + 1\u003c/span\u003e is also applied. Sereja wins if and only if the game ends on even number turns, so the answer is \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eprob\u003c/i\u003e(1) - \u003ci\u003eprob\u003c/i\u003e(2)) + (\u003ci\u003eprob\u003c/i\u003e(3) - \u003ci\u003eprob\u003c/i\u003e(4)) + ...\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eAll that\u0027s left is calculate \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eprob\u003c/i\u003e(\u003ci\u003ek\u003c/i\u003e)\u003c/span\u003e. Let \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/83/7e/837e52a391111863d64fb3b66b55858315199ea6.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, we can calculate separately the probability that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e is a multiple of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e, where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e is a prime, and add them up. By the inclusion-exclusion principle, we also have to subtract the probability that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e is a multiple of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e \u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e, where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e are primes, and add back the probability that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e is a multiple of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e \u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e \u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e3\u003c/sub\u003e\u003c/span\u003e, where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e3\u003c/sub\u003e\u003c/span\u003e are primes. Fortunately, there is no number under \u003cspan class\u003d\"tex-span\"\u003e100\u003c/span\u003e having \u003cspan class\u003d\"tex-span\"\u003e4\u003c/span\u003e different prime factors.\u003c/p\u003e\u003cp\u003eFinally, let\u0027s calculate the probability that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e is a multiple of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e. Say there are \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003c/span\u003e numbers in a that are multiples of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e. Note that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e, ..., \u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e must all be multiples of m, so all chosen from these \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003c/span\u003e numbers. The number of combinations is \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/46/fc/46fc748ab37d116897483e74a342ceea53dceb08.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and the number of permutations is \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/fc/51/fc51b805a0171a7f98928136c466c5bb922c783f.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. So the probability is \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/37/93/3793ae30467a0b1abea1006be5dfb51f67fcf4f5.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/p\u003e\u003cp\u003eMy solution: \u003ca href\u003d\"http://www.codechef.com/viewsolution/3906540\"\u003ehttp://www.codechef.com/viewsolution/3906540\u003c/a\u003e\u003c/p\u003e\u003c/div\u003e","tags":["codechef","game","combinatorics"]}}