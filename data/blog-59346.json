{"status":"OK","result":{"originalLocale":"en","allowViewHistory":true,"creationTimeSeconds":1525811594,"rating":0,"authorHandle":"diegorpc","modificationTimeSeconds":1525811594,"id":59346,"title":"\u003cp\u003e86D — Powerful Array (TLE)\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eHi guys\u003c/p\u003e\u003cp\u003eI was solving the problem 86D — Powerful Array using Mo\u0027s algorithm. But I get TLE.\u003c/p\u003e\u003cp\u003eSomeone can help me?\u003c/p\u003e\u003cp\u003eMy solution \u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eCod\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e/*input\n3 2\n1 2 1\n1 2\n1 3\n*/\n\n#include \u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\n#define all(x) x.rbegin(), x.rend()\n#define sz(x) (int) x.size()\n#define pb push_back\n#define fst first\n#define snd second\n\ntypedef string st;\ntypedef long long ll;\ntypedef unsigned long long int ull;\ntypedef vector \u0026lt;int\u0026gt; vi;\ntypedef pair \u0026lt;int,int\u0026gt; ii;\ntypedef pair \u0026lt;int, ii\u0026gt; iii;\n\nint block;\n#define maxn 1000005\n#define maxf 200004\n\nstruct Mo{\n\tint l, r, id;\n\tMo(){}\n\tMo(int l, int r, int id){\n\t\tthis-\u0026gt;l \u003d l, this-\u0026gt;r \u003d r, this-\u0026gt;id \u003d id;\n\t}\n\tbool operator \u0026lt; (const Mo o){\n\t\tif(l/block !\u003d o.l/block)\n\t\t\treturn l/block \u0026lt; o.l/block;\n\t\treturn r \u0026lt; o.r;\n\t}\n};\n\nint see[maxf];\nll ans[maxf], v[maxf], freq[maxn];;\nMo q[maxf];\nll resp;\n\nvoid update(int x){\n\tif(!see[x]){\n\t\tresp -\u003d (freq[v[x]]*freq[v[x]])*v[x];\n\t\tfreq[v[x]]++;\n\t\tresp +\u003d (freq[v[x]]*freq[v[x]])*v[x];\n\t}\n\telse{\n\t\tresp -\u003d (freq[v[x]]*freq[v[x]])*v[x];\n\t\tfreq[v[x]]--;\n\t\tresp +\u003d (freq[v[x]]*freq[v[x]])*v[x];\n\t}\n\tsee[x] ^\u003d 1;\n}\n\n\nint main(){\n\tint n, t, x, y;\n\tscanf(\u0026quot;%d %d\u0026quot;, \u0026amp;n, \u0026amp;t);\n\tblock \u003d sqrt(n);\n\tfor(int i \u003d 0; i \u0026lt; n; i++)\n\t\tscanf(\u0026quot;%lld\u0026quot;, v+i);\n\tfor(int i \u003d 0; i \u0026lt; t; i++){\n\t\tscanf(\u0026quot;%d %d\u0026quot;, \u0026amp;x, \u0026amp;y);\n\t\tq[i] \u003d {x, y, i};\n\t}\n\tsort(q, q+t);\n\tint L \u003d 0, R \u003d 0;\n\tresp \u003d 0;\n\tfor(int i \u003d 0; i \u0026lt; t; i++){\n\t\tint l \u003d q[i].l-1, r \u003d q[i].r-1;\n\t\tint id \u003d q[i].id;\n\t\twhile(L \u0026lt; l)\n\t\t\tupdate(L++);\n\t\twhile(L \u0026gt; l)\n\t\t\tupdate(--L);\n\t\twhile(R \u0026lt;\u003d r)\n\t\t\tupdate(R++);\n\t\twhile(R \u0026gt; r+1)\n\t\t\tupdate(--R);\n\t\tans[id] \u003d resp;\n\t}\n\tfor(int i \u003d 0; i \u0026lt; t; i++)\n\t\tprintf(\u0026quot;%I64d\\n\u0026quot;, ans[i]);\n\treturn 0;\n}\t\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e","tags":[]}}