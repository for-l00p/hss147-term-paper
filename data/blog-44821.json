{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1462994074,"rating":63,"authorHandle":"muratt","modificationTimeSeconds":1469055644,"id":44821,"title":"\u003cp\u003eCodeforces Round #352 Editorial\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003ch3\u003e\u003ca href\u003d\"/contest/672/problem/A\" title\u003d\"Codeforces Round 352 (Div. 2)\"\u003e672A - Summer Camp\u003c/a\u003e\u003c/h3\u003e\u003cp\u003eThis one is a simple brute force problem, we will construct our array. Adding numbers between \u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e370\u003c/span\u003e will be enough. After construction we just have to print \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e-th element of array. \u003c/p\u003e\u003ch3\u003e\u003ca href\u003d\"/contest/672/problem/B\" title\u003d\"Codeforces Round 352 (Div. 2)\"\u003e672B - Different is Good\u003c/a\u003e\u003c/h3\u003e\u003cp\u003eWe observe that in a good string all letters must be different, because all substrings in size 1 must be different. So if size of string is greater than \u003cspan class\u003d\"tex-span\"\u003e26\u003c/span\u003e then answer must be \u003cspan class\u003d\"tex-span\"\u003e - 1\u003c/span\u003e since we only have 26 different letters. \u003c/p\u003e\u003cp\u003eOtherwise, Let\u0027s suppose we have \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e different letters in string sized \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e, in our string \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e elements must be stay as before, all others must be changed. So will be (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e — \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e). Here is the \u003ca href\u003d\"https://ideone.com/NJw7V2\"\u003ecode\u003c/a\u003e.\u003c/p\u003e\u003ch3\u003e\u003ca href\u003d\"/contest/671/problem/A\" title\u003d\"Codeforces Round 352 (Div. 1)\"\u003e671A - Recycling Bottles\u003c/a\u003e\u003c/h3\u003e\u003cp\u003eLet\u0027s solve the problem when Adil and Bera in the same coordinate with bin. Then answer will be \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/d4/f5/d4f5728e0bd7eb91fa047e8c874b7e23f0b49f09.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, let\u0027s say \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e to this value. If Adil will take \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e-th bottle and Bera will take \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e-th bottle \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e ≠ \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e, then answer will be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e + \u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eAdil\u003c/i\u003e, \u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e) - \u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eBin\u003c/i\u003e, \u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e) + \u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eBera\u003c/i\u003e, \u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e) - \u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eBin\u003c/i\u003e, \u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eBecause for all bottles but the chosen ones we have to add \u003cspan class\u003d\"tex-span\"\u003e2\u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e * \u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edistance\u003c/i\u003e(\u003ci\u003ebottle\u003c/i\u003e,  \u003ci\u003ebin\u003c/i\u003e)\u003c/span\u003e. \u003c/p\u003e\u003cp\u003eFor example if we choose a bottle \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e for Adil to take first then we have to add \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eAdil\u003c/i\u003e,  \u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e + \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e,  \u003ci\u003eBin\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eIn defined \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e we already count \u003cspan class\u003d\"tex-span\"\u003e2\u003c/span\u003e * \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e,  \u003ci\u003eBin\u003c/i\u003e)\u003c/span\u003e but we have to count \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eAdil\u003c/i\u003e, \u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e + \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e,  \u003ci\u003eBin\u003c/i\u003e)\u003c/span\u003e for \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e. \u003c/p\u003e\u003cp\u003eSo we have to add \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eAdil\u003c/i\u003e,  \u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e,  \u003ci\u003eBin\u003c/i\u003e)\u003c/span\u003e to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e. \u003c/p\u003e\u003cp\u003eBecause \u003cspan class\u003d\"tex-span\"\u003e2\u003c/span\u003e * \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eBin\u003c/i\u003e,  \u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e+\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eAdil\u003c/i\u003e,  \u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eBin\u003c/i\u003e,  \u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e is equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eAdil\u003c/i\u003e,  \u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e+\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e,  \u003ci\u003eBin\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eLets construct two arrays, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e will be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eAdil\u003c/i\u003e, \u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e) - \u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eBin\u003c/i\u003e, \u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e, and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e will be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eBera\u003c/i\u003e, \u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e) - \u003ci\u003edistance\u003c/i\u003e(\u003ci\u003eBin\u003c/i\u003e, \u003ci\u003eBottle\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eWe will choose \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e naively, after that we have to find minimum \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e is not equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e. This one easily be calculated with precalculations, let\u0027s find optimal \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eopt\u003c/i\u003e1\u003c/span\u003e for Bera, also we will find second optimal \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eopt\u003c/i\u003e2\u003c/span\u003e for Bera, if our chosen \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e is equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eopt\u003c/i\u003e1\u003c/span\u003e then Bera will go \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eopt\u003c/i\u003e2\u003c/span\u003e, otherwise he will go \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eopt\u003c/i\u003e1\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eDon\u0027t forget to cases that all bottles taken by Adil or Bera!\u003c/p\u003e\u003cp\u003eHere is the \u003ca href\u003d\"https://ideone.com/Qs5ItS\"\u003ecode\u003c/a\u003e.\u003c/p\u003e\u003ch3\u003e\u003ca href\u003d\"/contest/671/problem/B\" title\u003d\"Codeforces Round 352 (Div. 1)\"\u003e671B - Robin Hood\u003c/a\u003e\u003c/h3\u003e\u003cp\u003eWe observe that we can apply operations separately this means first we will apply all increase operations, and after will apply all decrease operations, vice versa. We will use following algorithm.\u003c/p\u003e\u003cp\u003eWe have to apply following operation \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e times, add one to minimum number in array. We will simply binary search over minimum value after applying k operation. Let\u0027s look how to check if minimum will be great or equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e. If \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/88/45/8845e2e62547d8d85ffffc971d78264ce8ab63e8.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e is less or equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e then we can increase all elements to at least \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e. In this way we can find what will be minimum value after \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e operations. \u003c/p\u003e\u003cp\u003eLet\u0027s say this minimum value to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e. After we find it we will increase all numbers less than \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e. But there may be some operations we still didn\u0027t apply yet, this number can be at most \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e - 1\u003c/span\u003e, otherwise minimum would be greater than \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e because we can increase all numbers equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e by one with this number of increases. Since minimum has to be same we just have to increase some elements in our array that equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e. \u003c/p\u003e\u003cp\u003eWe will use same algorithm for decreasing operations. Finally we will print \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emax\u003c/i\u003e \u003ci\u003eelement\u003c/i\u003e\u003c/span\u003e — \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emin\u003c/i\u003e \u003ci\u003eelement\u003c/i\u003e\u003c/span\u003e in final array. Overall complexity will be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003enlogk\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eHere is the \u003ca href\u003d\"https://ideone.com/cc3KO5\"\u003ecode\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eSolution with another approach \u003ca href\u003d\"https://ideone.com/WT1j4B\"\u003ecode\u003c/a\u003e.\u003c/p\u003e\u003ch3\u003e\u003ca href\u003d\"/contest/671/problem/C\" title\u003d\"Codeforces Round 352 (Div. 1)\"\u003e671C - Ultimate Weirdness of an Array\u003c/a\u003e\u003c/h3\u003e\u003cp\u003eIf we calculate an array \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eH\u003c/i\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eH\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e is how many \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003el\u003c/i\u003e - \u003ci\u003er\u003c/i\u003e)\u003c/span\u003es there are that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003el\u003c/i\u003e,  \u003ci\u003er\u003c/i\u003e)\u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e ≤ \u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e, then we can easily calculate the answer. \u003c/p\u003e\u003cp\u003eHow to calculate array \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eH\u003c/i\u003e\u003c/span\u003e. Let\u0027s keep a vector, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ev\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e keeps all elements indexes which contain \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e as a divisor \u003cspan class\u003d\"tex-span\"\u003e—\u003c/span\u003e in sorted order. We will iterate over \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emax\u003c/i\u003e \u003ci\u003eelement\u003c/i\u003e\u003c/span\u003e to \u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e. When we are iterating we will keep another array \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003c/span\u003e, Let\u0027s suppose we are iterating over \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e will keep leftmost \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ej\u003c/i\u003e,  \u003ci\u003ek\u003c/i\u003e)\u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e ≤ \u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e. Sometimes there is no such \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e, then \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e will be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e + 1\u003c/span\u003e. \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eH\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e will be equal to \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/7f/d5/7fd53809c25fd7aa338dde2adc2d0cfdf95575d1.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, because if we choose p as \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e must be at least \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e, so for \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e we can choose \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e+\u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e different \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e s.\u003c/p\u003e\u003cp\u003eLet\u0027s look how we update \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003c/span\u003e array when we iterate \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e - 1\u003c/span\u003e. \u003c/p\u003e\u003cp\u003eLet \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ev\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e, \u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e3\u003c/sub\u003e...\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e. Note that our \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e - \u003ci\u003er\u003c/i\u003e\u003c/span\u003e must be cover at least \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e - 1\u003c/span\u003e of this indexes. \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e must less or equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e. So we have to maximize all \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e with \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e + 1\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e \u0026gt; \u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e. Otherwise If \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e ≥ \u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e + 1\u003c/span\u003e then \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e must be at least \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e, that\u0027s we will maximize all \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e\u0027s where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e \u0026lt; \u003ci\u003ep\u003c/i\u003e ≤ \u003ci\u003eb\u003c/i\u003e2\u003c/span\u003e with \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e. And finally for all \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e\u0027s where \u003cspan class\u003d\"tex-span\"\u003e(1 ≤ \u003ci\u003ep\u003c/i\u003e ≤ \u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e)\u003c/span\u003e we have to maximize them with \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ek\u003c/i\u003e - 1\u003c/sub\u003e\u003c/span\u003e. Observe that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003c/span\u003e array will be monotonic \u003cspan class\u003d\"tex-span\"\u003e - \u003c/span\u003e in non decreasing order \u003cspan class\u003d\"tex-span\"\u003e - \u003c/span\u003e after all operations. So we can easily make our updates with a segment tree that can perform following operations:\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e - \u003c/span\u003eReturns rightmost index \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e is less than some \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e. \u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e - \u003c/span\u003eReturns sum of all elements in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003c/span\u003e array.\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e - \u003c/span\u003eCan assign some \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e to all elements between some \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eIf all update and queries performed in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003elogn\u003c/i\u003e)\u003c/span\u003e then overall complexity will be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003enlogn\u003c/i\u003e)\u003c/span\u003e, we can also apply all this operations with STL set in same complexity.\u003c/p\u003e\u003cp\u003eCode with set structure: \u003ca href\u003d\"https://ideone.com/QhwMPF\"\u003elink\u003c/a\u003e\u003c/p\u003e\u003cp\u003eCode with segment tree: \u003ca href\u003d\"https://ideone.com/MyQfZz\"\u003elink\u003c/a\u003e\u003c/p\u003e\u003ch3\u003e\u003ca href\u003d\"/contest/671/problem/D\" title\u003d\"Codeforces Round 352 (Div. 1)\"\u003e671D - Roads in Yusland\u003c/a\u003e\u003c/h3\u003e\u003cp\u003eI want to thank \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/GlebsHP\" title\u003d\"Grandmaster GlebsHP\"\u003eGlebsHP\u003c/a\u003e, i originally came up with another problem similar to it, \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/GlebsHP\" title\u003d\"Grandmaster GlebsHP\"\u003eGlebsHP\u003c/a\u003e suggested to use this one in stead of it.\u003c/p\u003e\u003cp\u003eLet\u0027s look for a optimal subset of paths, paths may intersect. To prevent from this let\u0027s change the problem litte bit. A worker can repair all nodes between \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e and some \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e, where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e is in the path between \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ev\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e with cost \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e, also paths must not intersect. In this way we will never find better solution from original problem and we can express optimal subset in original problem without any path intersections in new problem.\u003c/p\u003e\u003cp\u003eLet\u0027s keep a \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edp\u003c/i\u003e\u003c/span\u003e array, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edp\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e keeps minimum cost to cover all edges in subtree of node \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e, also the edge between \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eparent\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e. How to find answer of some \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e. Let\u0027s choose a worker which \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e is in the subtree of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ev\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e is a parent of node \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e. Then if we choose this worker answer must be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e + (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edp\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e is child of a node in the path from \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e for all \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e\u0027s). Of course we have to exclude nodes chosen as \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e and in the path from \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e since we will cover them with \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e-th worker. We will construct a segment tree by dfs travel times so that for all nodes, workers which start his path in subtree of this node can be reached by looking a contiguous segment in tree. In node \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e, segment will keep values what will be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edp\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e equal to if we choose this worker to cover path between \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eparent\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e. We will travel our tree with dfs, in each \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e after we calculated node \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e\u0027s children dp\u0027s we will update our segment in following way, add all workers to segment where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e \u003d \u003ci\u003ei\u003c/i\u003e\u003c/span\u003e with value \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e + (sum of node \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e\u0027s children dp\u0027s). For all workers \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ev\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e, we must delete it from segment, this is assigning \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003einf\u003c/i\u003e\u003c/span\u003e to it. The only thing we didn\u0027t handle is what to do with workers under this node. Imagine all updates in subtree of node \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e is a child of node \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e. We have to increase all of them by (sum of node \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e\u0027s children dp\u0027s-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edp\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e). After applying all of this operations answer will be minimum value of workers start their path from a node in subtree of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e in segment tree.\u003c/p\u003e\u003cp\u003eOverall complexity will be \u003cspan class\u003d\"tex-span\"\u003e((\u003ci\u003en\u003c/i\u003e + \u003ci\u003em\u003c/i\u003e)\u003ci\u003elogm\u003c/i\u003e)\u003c/span\u003e. \u003c/p\u003e\u003cp\u003ePlease look at the \u003ca href\u003d\"https://ideone.com/oxuDlE\"\u003ecode\u003c/a\u003e to be more clear. \u003c/p\u003e\u003ch3\u003e\u003ca href\u003d\"/contest/671/problem/E\" title\u003d\"Codeforces Round 352 (Div. 1)\"\u003e671E - Organizing a Race\u003c/a\u003e\u003c/h3\u003e\u003cp\u003eIntended solution was \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/b2/6d/b26d316f4171c9a67b52fb7fdcb6c08805da779b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Here is \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/Zlobober\" title\u003d\"International Grandmaster Zlobober\"\u003eZlobober\u003c/a\u003e\u0027s \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/b2/6d/b26d316f4171c9a67b52fb7fdcb6c08805da779b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e code: \u003ca href\u003d\"https://ideone.com/mYPIwi\"\u003eLink\u003c/a\u003e. \u003c/p\u003e\u003ch4\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003c/sup\u003e) \u003ci\u003eSolution\u003c/i\u003e\u003c/span\u003e\u003c/h4\u003e\u003cp\u003eLet \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ecost\u003c/i\u003e(\u003ci\u003el\u003c/i\u003e,  \u003ci\u003er\u003c/i\u003e)\u003c/span\u003e be minimum cost to make \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e suitable for a race. In task we have to find such \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ecost\u003c/i\u003e(\u003ci\u003el\u003c/i\u003e,  \u003ci\u003er\u003c/i\u003e)\u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e ≤ \u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e+\u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e is maximum. \u003c/p\u003e\u003cp\u003eHow to calculate \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ecost\u003c/i\u003e(\u003ci\u003el\u003c/i\u003e,  \u003ci\u003er\u003c/i\u003e)\u003c/span\u003e: Let\u0027s look at how we do our increases to make race from \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e (first stage) possible. Greedily we will make our increases in right as much as possible. So if we run out of gas in road between \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e+\u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e we will add just enough gasoline to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eG\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e. After make first stage possible we will add gasoline to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e just enough to make second stage possible. This solution will be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e3\u003c/sup\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eLet\u0027s find \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e will keep leftmost \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e that we can\u0027t reach with current gasoline, we will also keep \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eneed\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e that keeps how many liter gasoline we have to add to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e-1. After applying this increase city \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e will be reachable from \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e, cars will be consumed all of their gasoline just before taking gasoline in city \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e. \u003c/p\u003e\u003cp\u003eHow to find it: We will keep an array \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003epre\u003c/i\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003epre\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e \u003d \u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003epre\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e - 1\u003c/sub\u003e\u003c/span\u003e + \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eG\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eW\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e. If \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003epre\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003epre\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e - 1\u003c/sub\u003e\u003c/span\u003e \u0026lt; 0 then we can\u0027t reach to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e + \u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e. If we find leftmost \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e ≥ \u003ci\u003ei\u003c/i\u003e\u003c/span\u003e) where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003epre\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e is strictly smaller than \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003epre\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e then \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e will be equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eneed\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e will be equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003epre\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003epre\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e - 1\u003c/sub\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eBuilding tree: Let\u0027s make a tree where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e is father of node \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e. In dfs travel, when we are in a node \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e all increases will be made to make all first stages possible from \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e to all \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e\u0027s, now we will keep an array \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003esuff\u003c/i\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003esuff\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e \u003d \u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003esuff\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e - 1\u003c/sub\u003e\u003c/span\u003e + \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eG\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eW\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e - 1\u003c/sub\u003e\u003c/span\u003e. So when we are increasing a city \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003c/span\u003e\u0027s \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eG\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eu\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e we have to increase all \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003esuff\u003c/i\u003e\u003c/span\u003e values from u to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e. We will also keep another array \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ecost\u003c/i\u003e\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ecost\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e will keep the cost to make stage 1 possible from \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e+\u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e. Increases will be nearly same, for \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003c/span\u003e we will increase all \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ev\u003c/i\u003e\u003c/span\u003e\u0027s costs \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ev\u003c/i\u003e ≥ \u003ci\u003eu\u003c/i\u003e\u003c/span\u003e. So when we reach a node \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e we will apply increases to make first stage possible between \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e ans \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e. When we are done with this node, we will revert increases. \u003c/p\u003e\u003cp\u003eLast part: Now we have to find rightmost \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e for all \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e\u0027s. Let\u0027s look at whether it is possible or not for a j. We can check it in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(1)\u003c/span\u003e. First \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ecost\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e - 1\u003c/sub\u003e\u003c/span\u003e must be less or equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e, also \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emaximum\u003c/i\u003e(\u003ci\u003esuff\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sub\u003e \u003ci\u003ei\u003c/i\u003e ≤ \u003ci\u003ek\u003c/i\u003e \u0026lt; \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e-(\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003esuff\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edelta\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e) + (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ecost\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edelta\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e) \u003cspan class\u003d\"tex-span\"\u003e ≤ \u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e. \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edelta\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e keeps how many increases we apply to node \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e. We will decrease them since direct increases in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e are made for \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e+\u003cspan class\u003d\"tex-span\"\u003e1\u003c/span\u003e, we don\u0027t need to keep \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edelta\u003c/i\u003e\u003c/span\u003e array since it will not effect expression. Also observe that the only thing changes in expression is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emaximum\u003c/i\u003e(\u003ci\u003esuff\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sub\u003e \u003ci\u003ei\u003c/i\u003e ≤ \u003ci\u003ek\u003c/i\u003e \u0026lt; \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e. In this way problem can be solved in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003c/sup\u003e)\u003c/span\u003e. Both sqrt dec. solutions are using the same idea. Main solution will be posted soon.\u003c/p\u003e\u003ch4\u003eHow to Reduce it to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003enlog\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003c/sup\u003e\u003ci\u003en\u003c/i\u003e)\u003c/span\u003e\u003c/h4\u003e\u003cp\u003eLet \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ecost\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003esuff\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e. As we said before this value will never change.\u003c/p\u003e\u003cp\u003eLet\u0027s keep a segment tree. In each node we will keep such values. Assume this node of segment covers between \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e. We will keep such \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eind\u003c/i\u003e1\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eind\u003c/i\u003e2\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emx\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003esuff\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eind\u003c/i\u003e1\u003c/span\u003e will keep minimum \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e\u0027s index where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e ≤ \u003ci\u003ej\u003c/i\u003e ≤ \u003ci\u003er\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eind\u003c/i\u003e2\u003c/span\u003e will keep minimum (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emaximum\u003c/i\u003e{\u003ci\u003esuff\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003el\u003c/i\u003e≤ \u003ci\u003ek\u003c/i\u003e \u0026lt; \u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e}\u003c/span\u003e+\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e)\u0027s index where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emid\u003c/i\u003e + 1 ≤ \u003ci\u003ej\u003c/i\u003e ≤ \u003ci\u003er\u003c/i\u003e\u003c/span\u003e this means we have to choose \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e from this nodes right child.\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emx\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003esuff\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e will keep \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emaximum\u003c/i\u003e{\u003ci\u003esuff\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003el\u003c/i\u003e≤\u003ci\u003ek\u003c/i\u003e≤\u003ci\u003er\u003c/i\u003e\u003c/sub\u003e}\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eWe also have to keep values for \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eind\u003c/i\u003e1\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eind\u003c/i\u003e2\u003c/span\u003e (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eind\u003c/i\u003e1\u003c/sub\u003e\u003c/span\u003e and (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emaximum\u003c/i\u003e{\u003ci\u003esuff\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003el\u003c/i\u003e≤ \u003ci\u003ek\u003c/i\u003e \u0026lt; \u003ci\u003eind\u003c/i\u003e2\u003c/sub\u003e}\u003c/span\u003e+\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eind\u003c/i\u003e2\u003c/sub\u003e\u003c/span\u003e)).\u003c/p\u003e\u003cp\u003eHow to update them: In a update we will increase some some suffixes \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ecost\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003esuff\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e values. So \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eind\u003c/i\u003e1\u003c/span\u003e will be same for each node. For every covered node \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emx\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003esuff\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e will increase by \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e is increase value in update). Tricky part is how to update \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eind\u003c/i\u003e2\u003c/span\u003e. Let\u0027s define a function \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003erelax\u003c/i\u003e()\u003c/span\u003e. \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003erelax\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e)\u003c/span\u003e calculates \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eind\u003c/i\u003e2\u003c/span\u003e value for node \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003c/span\u003e. Note that for relax function to work all nodes in subtree of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003c/span\u003e must be calculated already. We will call relax function after calculating this nodes children. We will come to relax function later. \u003c/p\u003e\u003cp\u003eHow to query: We can use pretty much same function as relax. We have to query find values for a \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e segment. We will keep an extra value in function, let\u0027s call it \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003c/span\u003e. If this node covers segment \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003c/span\u003e then \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003c/span\u003e will keep \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emaximum\u003c/i\u003e{\u003ci\u003esuff\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003el\u003c/i\u003e≤ \u003ci\u003ek\u003c/i\u003e \u0026lt; \u003ci\u003ea\u003c/i\u003e\u003c/sub\u003e}}\u003c/span\u003e. If this node doesn\u0027t intersect with \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e segment we will return worst values (for example for mx_suff value we will return -inf). Let\u0027s look what to do when this node is covered by \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e. If \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emx\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003esuff\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e value of this node\u0027s left child is greater or equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003c/span\u003e then \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eind\u003c/i\u003e2\u003c/span\u003e value will be same. So if \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emaximum\u003c/i\u003e{\u003ci\u003esuff\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003el\u003c/i\u003e≤ \u003ci\u003ek\u003c/i\u003e \u0026lt; \u003ci\u003eind\u003c/i\u003e2\u003c/sub\u003e}\u003c/span\u003e+\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eind\u003c/i\u003e2\u003c/sub\u003e\u003c/span\u003e) is lower or equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e for this node answer is ind2, it is greater than \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e then we will go this nodes left child to calculate answer. If \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emx\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003esuff\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e value of this node\u0027s left child is lower than \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003c/span\u003e value then (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emaximum\u003c/i\u003e{\u003ci\u003esuff\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003el\u003c/i\u003e≤ \u003ci\u003ej\u003c/i\u003e \u0026lt; \u003ci\u003emid\u003c/i\u003e\u003c/sub\u003e}\u003c/span\u003e) will equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003c/span\u003e for each \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e. So we just have to rightmost \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e ≤ \u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e - \u003ci\u003et\u003c/i\u003e\u003c/span\u003e in subtree of this node. This can be calculated in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003elogn\u003c/i\u003e)\u003c/span\u003e time. We didn\u0027t look at right child yet, so we will go to right child again with same \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003c/span\u003e value. What to do when this node intersects with \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e-\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e doesn\u0027t cover it. We will go both children, first to left, after we will update \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003c/span\u003e value for right child by \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emx\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003esuff\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e value returned from left child. We will lazy prop to push values.\u003c/p\u003e\u003cp\u003eOther condition: In node \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e we have to query between \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e is rightmost index that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ecost\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003er\u003c/i\u003e - 1\u003c/sub\u003e\u003c/span\u003e \u0026lt; \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e. Since cost values are monotonic this \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e can be found easily in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003elogn\u003c/i\u003e)\u003c/span\u003e. \u003c/p\u003e\u003cp\u003eRelax function can be calculated nearly same as query. But this will work in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003elogn\u003c/i\u003e)\u003c/span\u003e, since we just have to go exactly one child, since we don\u0027t interested in rightmost values.\u003c/p\u003e\u003c/div\u003e","tags":["round #352","editorial"]}}