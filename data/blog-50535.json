{"status":"OK","result":{"originalLocale":"en","allowViewHistory":true,"creationTimeSeconds":1487585648,"rating":30,"authorHandle":"Togrul_Gasimov","modificationTimeSeconds":1487585648,"id":50535,"title":"\u003cp\u003eSieve Eratosthenes\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003e\u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/uwi\" title\u003d\"International Grandmaster uwi\"\u003euwi\u003c/a\u003e uses this function to find prime numbers.This works to n\u003d10^8 in 1 second. Can someone explain in detail?\u003c/p\u003e \u003cpre\u003e\u003ccode\u003epublic static int[] sieveEratosthenes(int n) {\n\t\tif(n \u0026lt;\u003d 32){\n\t\t\tint[] primes \u003d { 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31 };\n\t\t\tfor(int i \u003d 0;i \u0026lt; primes.length;i++){\n\t\t\t\tif(n \u0026lt; primes[i]){\n\t\t\t\t\treturn Arrays.copyOf(primes, i);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn primes;\n\t\t}\n\n\t\tint u \u003d n + 32;\n\t\tdouble lu \u003d Math.log(u);\n\t\tint[] ret \u003d new int[(int) (u / lu + u / lu / lu * 1.5)];\n\t\tret[0] \u003d 2;\n\t\tint pos \u003d 1;\n\n\t\tint[] isp \u003d new int[(n + 1) / 32 / 2 + 1];\n\t\tint sup \u003d (n + 1) / 32 / 2 + 1;\n\n\t\tint[] tprimes \u003d { 3, 5, 7, 11, 13, 17, 19, 23, 29, 31 };\n\t\tfor(int tp : tprimes){\n\t\t\tret[pos++] \u003d tp;\n\t\t\tint[] ptn \u003d new int[tp];\n\t\t\tfor(int i \u003d (tp - 3) / 2;i \u0026lt; tp \u0026lt;\u0026lt; 5;i +\u003d tp)\n\t\t\t\tptn[i \u0026gt;\u0026gt; 5] |\u003d 1 \u0026lt;\u0026lt; (i \u0026amp; 31);\n\t\t\tfor(int i \u003d 0;i \u0026lt; tp;i++){\n\t\t\t\tfor(int j \u003d i;j \u0026lt; sup;j +\u003d tp)\n\t\t\t\t\tisp[j] |\u003d ptn[i];\n\t\t\t}\n\t\t}\n\n\t\t// 3,5,7\n\t\t// 2x+3\u003dn\n\t\tint[] magic \u003d { 0, 1, 23, 2, 29, 24, 19, 3, 30, 27, 25, 11, 20, 8, 4,\n\t\t\t\t13, 31, 22, 28, 18, 26, 10, 7, 12, 21, 17, 9, 6, 16, 5, 15, 14 };\n\t\tint h \u003d n / 2;\n\t\tfor(int i \u003d 0;i \u0026lt; sup;i++){\n\t\t\tfor(int j \u003d ~isp[i];j !\u003d 0;j \u0026amp;\u003d j - 1){\n\t\t\t\tint pp \u003d i \u0026lt;\u0026lt; 5 | magic[(j \u0026amp; -j) * 0x076be629 \u0026gt;\u0026gt;\u0026gt; 27];\n\t\t\t\tint p \u003d 2 * pp + 3;\n\t\t\t\tif(p \u0026gt; n)\n\t\t\t\t\tbreak;\n\t\t\t\tret[pos++] \u003d p;\n\t\t\t\tfor(int q \u003d pp;q \u0026lt;\u003d h;q +\u003d p)\n\t\t\t\t\tisp[q \u0026gt;\u0026gt; 5] |\u003d 1 \u0026lt;\u0026lt; (q \u0026amp; 31);\n\t\t\t}\n\t\t}\n\n\t\treturn Arrays.copyOf(ret, pos);\n\t}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":[]}}