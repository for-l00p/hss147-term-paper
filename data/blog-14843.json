{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1416791053,"rating":16,"authorHandle":"Robert_Alonso_29","modificationTimeSeconds":1416791053,"id":14843,"title":"\u003cp\u003eIs this a bug in e-maxx manacher algorithm implementation?\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eHi everyone. I\u0027ve been learning the manacher algorithm for finding the longest palindromic substring these days, and when I started to practice with the implementation I found on \u003ca href\u003d\"http://e-maxx.ru/algo/palindromes_count\"\u003ehttp://e-maxx.ru/algo/palindromes_count\u003c/a\u003e, the result I got was okay in every vector value except a single one for a small test case.\u003c/p\u003e\u003cp\u003eI tried this code, which, as the description says, takes care of the odd-length subpalindromes\u003c/p\u003e \u003cpre\u003e\u003ccode\u003evector\u0026lt;int\u0026gt; d1 (n);\nint l\u003d0, r\u003d-1;\nfor (int i\u003d0; i\u0026lt;n; ++i) {\n\tint k \u003d (i\u0026gt;r ? 0 : min (d1[l+r-i], r-i)) + 1;\n\twhile (i+k \u0026lt; n \u0026amp;\u0026amp; i-k \u0026gt;\u003d 0 \u0026amp;\u0026amp; s[i+k] \u003d\u003d s[i-k])  ++k;\n\td1[i] \u003d k--;\n\tif (i+k \u0026gt; r)\n\t\tl \u003d i-k,  r \u003d i+k;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThen I tried the test case where \u003ccode\u003es\u003d\u0026quot;xxxxxxxaxxx\u0026quot;\u003c/code\u003e, and the resulting vector d1 was \u003ccode\u003ed1[] \u003d {1,2,3,4,3,2,1,4,3,2,1}\u003c/code\u003e\u003c/p\u003e\u003cp\u003eHowever, the last 3 in d1 would be wrong, because it intends to say that the longest palindrome with center at index 8 is \u003ccode\u003e\u0026quot;xaxxx\u0026quot;\u003c/code\u003e with length \u003ccode\u003ed1[8]*2-1 \u003d 3*2-1 \u003d 5\u003c/code\u003e.\u003c/p\u003e\u003cp\u003eDoes this say that there is a bug in this implementation? I hope that\u0027s not the case. I\u0027ve directly copied and pasted the code I found on e-maxx. Please check it out, thank you.\u003c/p\u003e\u003c/div\u003e","tags":["strings","manacher","e-maxx"]}}