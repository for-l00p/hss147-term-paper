{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1472830673,"rating":0,"authorHandle":"I_love_Hoang_Yen","modificationTimeSeconds":1472876478,"id":46911,"title":"\u003cp\u003eSP Training 8 — Solutions\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003ch1\u003e[problem:208575A]\u003c/h1\u003e\u003cp\u003eĐầu tiên ta xét thuật toán duyệt hồn nhiên như sau:\u003c/p\u003e \u003cpre\u003e\u003ccode\u003efor i \u003d 1..n:\n  res \u003d res + n / i\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThuật toán này có độ phức tạp \u003ccode\u003eO(N)\u003c/code\u003e và dĩ nhiên không thể chạy được với \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e lên đến \u003ccode\u003e10^12\u003c/code\u003e.\u003c/p\u003e\u003cp\u003eĐể cải tiến, ta nhận thấy rằng có rất nhiều giá trị của \u003ccode\u003ei\u003c/code\u003e mà \u003ccode\u003en/i\u003c/code\u003e bằng nhau.\u003c/p\u003e\u003cp\u003eVí dụ:\u003c/p\u003e \u003cpre\u003e\u003ccode\u003en \u003d 12\n\ni \u003d 1, n/i \u003d 12\ni \u003d 2, n/i \u003d 6\ni \u003d 3, n/i \u003d 4\ni \u003d 4, n/i \u003d 3\ni \u003d 5, n/i \u003d 2\ni \u003d 6, n/i \u003d 2\ni \u003d 7, n/i \u003d 1\ni \u003d 8, n/i \u003d 1\ni \u003d 9, n/i \u003d 1\ni \u003d 10, n/i \u003d 1\ni \u003d 11, n/i \u003d 1\ni \u003d 12, n/i \u003d 1\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eỞ ví dụ trên, có thể thấy giá trị 1 và 2 xuất hiện nhiều lần. Thật vậy, khi \u003ccode\u003ei \u0026gt; sqrt(N)\u003c/code\u003e thì rõ ràng \u003ccode\u003en/i \u0026lt; sqrt(N)\u003c/code\u003e. Do đó có không quá \u003ccode\u003esqrt(N)\u003c/code\u003e giá trị khác nhau của \u003ccode\u003eN/i\u003c/code\u003e.\u003c/p\u003e\u003cp\u003eNhư vậy, đến đây ta thu được thuật toán với độ phức tạp \u003ccode\u003esqrt(N)\u003c/code\u003e như sau:\u003c/p\u003e \u003col\u003e   \u003cli\u003eXét các giá trị \u003ccode\u003ei\u003c/code\u003e mà \u003ccode\u003ei \u0026lt;\u003d sqrt(N)\u003c/code\u003e. Làm như cách duyệt.\u003c/li\u003e   \u003cli\u003eVới các giá trị \u003ccode\u003ei\u003c/code\u003e mà \u003ccode\u003ei \u0026gt; sqrt(N)\u003c/code\u003e, ta xét các giá trị của \u003ccode\u003en/i\u003c/code\u003e. Với mỗi giá trị của \u003ccode\u003en/i\u003c/code\u003e, đếm xem có bao nhiêu giá trị của \u003ccode\u003ei\u003c/code\u003e thoả mãn. Ví dụ, với \u003ccode\u003eN \u003d 12\u003c/code\u003e:\u003c/li\u003e \u003c/ol\u003e \u003cul\u003e   \u003cli\u003eVới \u003ccode\u003eN/i \u003d 2\u003c/code\u003e, có 2 giá trị của \u003ccode\u003ei\u003c/code\u003e thoả mãn (\u003ccode\u003ei \u003d 5, 6\u003c/code\u003e), ta cộng kết quả thêm \u003ccode\u003e2 * 2 \u003d 4\u003c/code\u003e.\u003c/li\u003e   \u003cli\u003eVới \u003ccode\u003eN/i \u003d 1\u003c/code\u003e, có 6 giá trị của \u003ccode\u003ei\u003c/code\u003e thoả mãn (\u003ccode\u003ei \u003d 7, ..., 12\u003c/code\u003e), ta cộng kết quả thêm \u003ccode\u003e1 * 6 \u003d 6\u003c/code\u003e.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eNhận thấy, ở trường hợp 1, số giá trị của \u003ccode\u003eN/i\u003c/code\u003e cũng không quá \u003ccode\u003esqrt(N)\u003c/code\u003e, nên thay vì tách riêng 2 trường hợp, ta chỉ cần cài đặt trường hợp 2. Như vậy, ta thu được code rất đơn giản như sau:\u003c/p\u003e \u003cpre\u003e\u003ccode\u003e// sumdiv(n) \u003d [n/1] + [n/2] + [n/3] + ... + [n/n]\nlong long sumdiv(long long n) {\n    long long s\u003d0, i\u003d1;\n    while (i \u0026lt;\u003d n) {\n        long long q\u003dn/i, r\u003dn/q;\n        s+\u003d(long long)(r-i+1) * q;\n        i\u003dr+1;\n    }\n    return s;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch1\u003e[problem:208575B]\u003c/h1\u003e\u003ch2\u003eXây dựng đồ thị\u003c/h2\u003e\u003cp\u003eMỗi đỉnh gồm:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eĐang chở những thú nào.   \u003cul\u003e     \u003cli\u003eMỗi thú 3 trạng thái: chưa nhặt, chưa trả, đã trả --\u0026gt; số hệ 3\u003c/li\u003e   \u003c/ul\u003e\u003c/li\u003e   \u003cli\u003eĐang ở vị trí nào --\u0026gt; 2 cách   \u003cul\u003e     \u003cli\u003eTọa độ --\u0026gt; 36 vị trí khác nhau\u003c/li\u003e     \u003cli\u003eCon vật / nhà --\u0026gt; 22 vị trí khác nhau\u003c/li\u003e   \u003c/ul\u003e\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eCạnh:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eTừ 1 vị trí đến vị trí cạnh nó --\u0026gt; trọng số \u003d 1\u003c/li\u003e   \u003cli\u003eNhặt 1 thú lên / trả 1 thú về nhà --\u0026gt; trọng số \u003d 0.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eSau khi có đồ thị, có thể cài bằng Dijkstra hoặc BFS01.\u003c/p\u003e\u003cp\u003eCode:\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003ca href\u003d\"http://ideone.com/VxpoWP\"\u003eBFS 01\u003c/a\u003e\u003c/li\u003e   \u003cli\u003e\u003ca href\u003d\"http://ideone.com/TAKYV8\"\u003eDijkstra\u003c/a\u003e\u003c/li\u003e \u003c/ul\u003e\u003ch1\u003e[problem:208575C]\u003c/h1\u003e\u003ch2\u003eToán\u003c/h2\u003e\u003cp\u003eCó thể đọc: \u003ca href\u003d\"http://vnoi.info/wiki/translate/topcoder/Hieu-ve-xac-suat\"\u003eVNOI wiki\u003c/a\u003e\u003c/p\u003e\u003cp\u003eĐể định nghĩa 1 cách toán học Expected value, mình cần giải thích 1 số khái niệm toán học trước. Xét bài toán tung 1 xúc sắc (6 mặt):\u003c/p\u003e \u003cul\u003e   \u003cli\u003eSample space: tập hợp tất cả các khả năng có thể xảy ra (tung xúc sắc thì có 6 khả năng)\u003c/li\u003e   \u003cli\u003eEvents: một tập hợp gồm 1 hoặc nhiều khả năng (ví dụ: event xúc sắc \u003d 1, event xúc sắc chẵn, ...)\u003c/li\u003e   \u003cli\u003eProbability: khả năng 1 event xảy ra.\u003c/li\u003e   \u003cli\u003eRandom Variable: Một biến mà giá trị của nó là random, nó có thể nhận các giá trị khác nhau với xác suất cho trước theo 1 hàm nào đó. Ví dụ:   \u003cul\u003e     \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e1\u003c/span\u003e là giá trị của xúc sắc.\u003c/li\u003e     \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e2\u003c/span\u003e là 2 lần giá trị xúc sắc (có thể viết \u003cspan class\u003d\"tex-span\"\u003e2 * \u003ci\u003eX\u003c/i\u003e1\u003c/span\u003e)\u003c/li\u003e     \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e3\u003c/span\u003e là bình phương giá trị xúc sắc\u003c/li\u003e     \u003cli\u003e...\u003c/li\u003e   \u003c/ul\u003e\u003c/li\u003e   \u003cli\u003eProbability space: bao gồm 3 cái sample space, events và probability của các event.\u003c/li\u003e \u003c/ul\u003e\u003ch2\u003eExpected value\u003c/h2\u003e\u003cp\u003eVới \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e\u003c/span\u003e là 1 random variable, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eE\u003c/i\u003e(\u003ci\u003eX\u003c/i\u003e)\u003c/span\u003e là giá trị trung bình của X, nếu ta thực hiện thí nghiệm vô số lần. Cái này cũng có thể hình dung như giá trị trung bình có trọng số.\u003c/p\u003e\u003cp\u003eVí dụ:\u003c/p\u003e\u003cp\u003eCó 2 lớp học:\u003c/p\u003e \u003cul\u003e   \u003cli\u003elớp A có 40 học sinh và điểm trung bình là 5\u003c/li\u003e   \u003cli\u003elớp B có 30 học sinh và điểm trung bình là 6\u003c/li\u003e \u003c/ul\u003e\u003cp\u003e--\u0026gt; điểm trung bình của tất cả học sinh là:\u003c/p\u003e\u003cp\u003e\u003ccode\u003e(5 * 40 + 6 * 30) / (40 + 30) \u003d 5 * (40 / 70) + 6 * (30 / 70)\u003c/code\u003e\u003c/p\u003e\u003cp\u003eCác trọng số \u003cspan class\u003d\"tex-span\"\u003e40 / 70\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e30 / 70\u003c/span\u003e được nhân thêm do số lượng trường hợp điểm 5 và 6 khác nhau.\u003c/p\u003e\u003cp\u003eCông thức tổng quát:\u003c/p\u003e\u003cp\u003e\u003ccode\u003eE(X) \u003d prob(X \u003d 1) * 1 + prob(X \u003d 2) * 2 + ...\u003c/code\u003e\u003c/p\u003e\u003ch2\u003eLinearity of Expectation\u003c/h2\u003e\u003cp\u003eLinearity of Expectation là kĩ năng quan trọng nhất khi làm các bài về Expected value.\u003c/p\u003e\u003cp\u003eVí dụ:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eTung 2 xúc sắc\u003c/li\u003e   \u003cli\u003eTính Expected value của tổng giá trị 2 xúc sắc.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eXét riêng từng xúc sắc:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eĐặt \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eE\u003c/i\u003e(\u003ci\u003eX\u003c/i\u003e1)\u003c/span\u003e là expected value của giá trị xúc sắc 1\u003c/li\u003e   \u003cli\u003eĐặt \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eE\u003c/i\u003e(\u003ci\u003eX\u003c/i\u003e2)\u003c/span\u003e là expected value của giá trị xúc sắc 2\u003c/li\u003e \u003c/ul\u003e\u003cp\u003e\u003ccode\u003eE(X1) \u003d E(X2) \u003d (1/6) * 1 + (1/6) * 2 + ... + (1/6) * 6 \u003d 3.5\u003c/code\u003e.\u003c/p\u003e\u003cp\u003eLinearity of Expectation cho ta công thức vô cùng kỳ diệu sau:\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eE\u003c/i\u003e(\u003ci\u003eX\u003c/i\u003e1 + \u003ci\u003eX\u003c/i\u003e2) \u003d \u003ci\u003eE\u003c/i\u003e(\u003ci\u003eX\u003c/i\u003e1) + \u003ci\u003eE\u003c/i\u003e(\u003ci\u003eX\u003c/i\u003e2) \u003d 7\u003c/span\u003e.\u003c/p\u003e\u003cp\u003ePhát biểu chính xác:\u003c/p\u003e\u003cp\u003eNếu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e1\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e2\u003c/span\u003e, ..., \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eXk\u003c/i\u003e\u003c/span\u003e là các random variable có cùng probability space:\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eE\u003c/i\u003e(\u003ci\u003eX\u003c/i\u003e1 * \u003ci\u003ea\u003c/i\u003e1 + \u003ci\u003eX\u003c/i\u003e2 * \u003ci\u003ea\u003c/i\u003e2 + ... + \u003ci\u003eXk\u003c/i\u003e * \u003ci\u003eak\u003c/i\u003e) \u003d \u003ci\u003ea\u003c/i\u003e1 * \u003ci\u003eE\u003c/i\u003e(\u003ci\u003eX\u003c/i\u003e1) + \u003ci\u003ea\u003c/i\u003e2 * \u003ci\u003eE\u003c/i\u003e(\u003ci\u003eX\u003c/i\u003e2) + ... + \u003ci\u003eak\u003c/i\u003e * \u003ci\u003eE\u003c/i\u003e(\u003ci\u003eXk\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eChú ý rằng các variable không cần independent.\u003c/p\u003e\u003ch2\u003eBài toán\u003c/h2\u003e\u003cp\u003eGiờ quay lại bài toán. Xét lượt lật xu đầu tiên:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eTrước lần đầu tiên: \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e ngửa, 0 úp\u003c/li\u003e   \u003cli\u003eLật \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003c/span\u003e đồng xu\u003c/li\u003e   \u003cli\u003eĐặt ngửa \u003d 1, xấp \u003d 0\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eGiờ giả sử ta xét 1 đồng xu độc lập:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eNếu nó đang ngửa:   \u003cul\u003e     \u003cli\u003eVới xác suất \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e / \u003ci\u003eN\u003c/i\u003e\u003c/span\u003e, nó trở thành xấp\u003c/li\u003e     \u003cli\u003eVới xác suất \u003cspan class\u003d\"tex-span\"\u003e1 - \u003ci\u003eA\u003c/i\u003e / \u003ci\u003eN\u003c/i\u003e\u003c/span\u003e, nó trở thành ngửa.\u003c/li\u003e     \u003cli\u003eNhư vậy, với 1 đồng xu đang ngửa, ta có expected value của giá trị đồng xu sau khi thực hiện phép lật là: \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eA\u003c/i\u003e / \u003ci\u003eN\u003c/i\u003e) * 0 + (1 - \u003ci\u003eA\u003c/i\u003e / \u003ci\u003eN\u003c/i\u003e) * 1\u003c/span\u003e.\u003c/li\u003e     \u003cli\u003eVới \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e đồng xu ngửa, tổng expected value của giá trị các đồng xu là \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e lần giá trị trên. Đây chính là số đồng xu ngửa sau lượt 1 (do mỗi đồng xu ngửa giá trị 1 và xấp giá trị 0).\u003c/li\u003e   \u003c/ul\u003e\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eĐể làm tổng quát cho \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eK\u003c/i\u003e\u003c/span\u003e lượt, ta cần hiểu các điều sau:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eĐặt \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eE\u003c/i\u003e(\u003ci\u003eH\u003c/i\u003e)\u003c/span\u003e là số xu ngửa, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eE\u003c/i\u003e(\u003ci\u003eT\u003c/i\u003e)\u003c/span\u003e là số xu xấp. Dễ thấy \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eE\u003c/i\u003e(\u003ci\u003eH\u003c/i\u003e) + \u003ci\u003eE\u003c/i\u003e(\u003ci\u003eT\u003c/i\u003e) \u003d \u003ci\u003eN\u003c/i\u003e\u003c/span\u003e, theo cách hiểu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eE\u003c/i\u003e\u003c/span\u003e là giá trị trung bình. Cái này các em có thể chứng minh chặt chẽ theo định nghĩa của \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eE\u003c/i\u003e\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003eĐặt \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eH\u003c/i\u003e\u0027\u003c/span\u003e là số xu ngửa sau 1 lượt lật \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003c/span\u003e xu. Theo logic tương tự 1 lượt và linearity of expectation:\u003c/li\u003e \u003c/ul\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eE\u003c/i\u003e(\u003ci\u003eH\u003c/i\u003e\u0027) \u003d \u003ci\u003eE\u003c/i\u003e(\u003ci\u003eH\u003c/i\u003e) * (1 - \u003ci\u003eA\u003c/i\u003e / \u003ci\u003eN\u003c/i\u003e) + \u003ci\u003eE\u003c/i\u003e(\u003ci\u003eT\u003c/i\u003e) * (\u003ci\u003eA\u003c/i\u003e / \u003ci\u003eN\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eChú ý phép nhân ở đây thực hiện được do \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eE\u003c/i\u003e\u003c/span\u003e là 1 số thực, và nó đại diện cho tổng các \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eprob\u003c/i\u003e * \u003ci\u003evalue\u003c/i\u003e\u003c/span\u003e. Do đó khi thực hiện phép nhân này bản chất có thể hiểu là ta đang lấy tổng nhiều cặp \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eprob\u003c/i\u003e * \u003ci\u003evalue\u003c/i\u003e\u003c/span\u003e rồi nhân với \u003cspan class\u003d\"tex-span\"\u003e(1 - \u003ci\u003eA\u003c/i\u003e / \u003ci\u003eN\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003ch2\u003eCode\u003c/h2\u003e\u003cp\u003e\u003ca href\u003d\"http://ideone.com/vmiCwg\"\u003eRR\u003c/a\u003e\u003c/p\u003e\u003c/div\u003e","tags":[]}}