{"status":"OK","result":{"originalLocale":"en","allowViewHistory":true,"creationTimeSeconds":1528099114,"rating":0,"authorHandle":"simplecomplex","modificationTimeSeconds":1528099114,"id":59837,"title":"\u003cp\u003ePlease explain this solution of C(n,r) modulo P.\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eI was trying to solve a problem on LightOJ which says to calculate C(n,r) modulo P where (1\u0026lt;\u003dn,r\u0026lt;\u003d1000000 and P\u003d1000003). It has at most 2000 queries.\u003c/p\u003e\u003cp\u003eI found this solution on the web,but I can not find how it works. can anyone explain it please?\u003c/p\u003e \u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\nusing namespace std;\n\ntypedef long long ll;\n\nconst int N\u003d1e6+3;\nconst int mod\u003d1e6+3;\nll A[N],B[N];\nll bigmod(ll n,ll p)\n{\n\tif(p\u003d\u003d0)return 1LL;\n\tif(p\u0026amp;1)return ((n%mod)*bigmod(n,p-1))%mod;\n\tll a\u003dbigmod(n,p/2);\n\treturn (a*a)%mod;\n}\n\nint main()\n{\n\tint tc;\n\tscanf(\u0026quot;%d\u0026quot;,\u0026amp;tc);\n\tA[1]\u003dB[1]\u003d1;\n\tA[0]\u003dB[0]\u003d1;\n\tfor(int i\u003d2;i\u0026lt;N;++i){\n\t\tA[i]\u003d(A[i-1]*i)%mod;\n\t\tB[i]\u003d(B[i-1]*bigmod((ll)i,mod-2))%mod;\n\t}\n\tfor(int cs\u003d1;cs\u0026lt;\u003dtc;++cs){\n\t\tint n,r;\n\t\tscanf(\u0026quot;%d%d\u0026quot;,\u0026amp;n,\u0026amp;r);\n\t\tprintf(\u0026quot;Case %d: %lld\\n\u0026quot;,cs,(A[n]*((B[n-r]*B[r])%mod))%mod);\n\t}\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["#combination","#number theory","#math"]}}