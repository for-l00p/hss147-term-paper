{"status":"OK","result":{"originalLocale":"ru","allowViewHistory":false,"creationTimeSeconds":1425850818,"rating":35,"authorHandle":"MikeMirzayanov","modificationTimeSeconds":1425851730,"id":16853,"title":"\u003cp\u003eРазбор задач VK Cup 2015 — Квалификация 1\u003c/p\u003e","locale":"ru","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003ch2\u003e\u003ca href\u003d\"/contest/522/problem/A\" title\u003d\"VK Cup 2015 - Квалификация 1\"\u003e522A - Репосты\u003c/a\u003e\u003c/h2\u003e\u003cp\u003eДля решения этой задачи надо было проитерироваться по записям о репостах и поддерживать для каждого пользователя длину цепочки, которая заканчивается в нем. Здесь удобно воспользоваться ассоциативным массивом из строки (имени пользователя) в целое число (длину цепочки). Например, для С++ такой структурой данных будет просто map\u0026lt;string,int\u0026gt;. Назовем такую структуру \u003ccode\u003echainLengths\u003c/code\u003e, тогда при обработки строки вида \u0026lt;\u0026lt;\u003ccode\u003ea reposted b\u003c/code\u003e\u0026gt;\u0026gt; надо просто выполнить присвоение \u003ccode\u003echainLengths[a] \u003d chainLengths[b] + 1\u003c/code\u003e. В качестве ответа надо вывести максимальное из значений \u003ccode\u003echainLengths\u003c/code\u003e, что можно подсчитывать на лету.\u003c/p\u003e\u003cp\u003eПара тонкостей: в начале надо занести \u003ccode\u003echainLengths[\u0026quot;polycarp\u0026quot;] \u003d 1;\u003c/code\u003e, а всюду при работе со строками приводить их к нижнему регистру (или верхнему), чтобы сделать сравнение строк нечувствительным к регистру букв.\u003c/p\u003e\u003cp\u003eПример такого решения: \u003ca href\u003d\"/contest/522/submission/10209456\" title\u003d\"Посылка 10209456 от Toshiksvg\"\u003e10209456\u003c/a\u003e.\u003c/p\u003e\u003ch2\u003e\u003ca href\u003d\"/contest/522/problem/B\" title\u003d\"VK Cup 2015 - Квалификация 1\"\u003e522B - Фото на память\u003c/a\u003e\u003c/h2\u003e\u003cp\u003eВ этой задаче для каждого \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e фактически надо было найти:\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eW\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e, равное сумме всех заданных \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ew\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e без \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ew\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e,\u003c/li\u003e   \u003cli\u003eи \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eH\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e, равное максимуму всех \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e без \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eДля подсчета первой величины достаточно найти сумму \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e\u003c/span\u003e всех значений \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ew\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e, тогда \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eW\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e \u003d \u003ci\u003es\u003c/i\u003e - \u003ci\u003ew\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eДля подсчета второй величины достаточно заметить, что либо искомое значение есть просто максимум по \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e\u003c/span\u003e, либо (если \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e совпало с максимумом) это второй максимум (т.е. предпоследний элемент при сортировке по неубыванию). Второй максимум, как и максимум ищется за один проход по массиву.\u003c/p\u003e\u003cp\u003eВ таком случае, для нахождения как \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eW\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e, так и \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eH\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e требуется \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(1)\u003c/span\u003e действий, то есть \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e)\u003c/span\u003e суммарно на всё решение.\u003c/p\u003e\u003cp\u003eПример решения: \u003ca href\u003d\"/contest/522/submission/10193758\" title\u003d\"Посылка 10193758 от Saratov SU: Chadin, Baybakov\"\u003e10193758\u003c/a\u003e.\u003c/p\u003e\u003ch2\u003e\u003ca href\u003d\"/contest/522/problem/C\" title\u003d\"VK Cup 2015 - Квалификация 1\"\u003e522C - Chicken or Fish?\u003c/a\u003e\u003c/h2\u003e\u003cp\u003eДля решения задачи необходимо заметить, что при наличии недовольных пассажиров (т.е. тех, для кого \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e \u003d 1\u003c/span\u003e), существенную роль играет только первый из них, так как остальные вполне могут быть недовольными именно тем блюдом, которое не хватило первому из таковых.\u003c/p\u003e\u003cp\u003eПусть массив \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003c/span\u003e — это массив максимальных возможных количеств порций каждого из блюда на момент старта обслуживания Поликарпа. То есть просто массив \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003c/span\u003e надо заинициализировать массивом \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/span\u003e, а каждый раз, когда \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e отлично от 0, то делать \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e[\u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e] \u003d \u003ci\u003eb\u003c/i\u003e[\u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e] - 1\u003c/span\u003e (уменьшать количество порций блюда). Кроме того, пусть \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eunknown\u003c/i\u003e\u003c/span\u003e — это количество пассажиров, про которых неизвестно какие точно блюда им достались (то есть для них \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e \u003d 0\u003c/span\u003e). Пусть величина \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eunknownBeforeUpset\u003c/i\u003e\u003c/span\u003e — это такое же количество, но до первого недовольного.\u003c/p\u003e\u003cp\u003eТаким образом, есть два основных случая:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eнедовольных пассажиров нет вообще, тогда блюдо \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e могло закончится тогда и только тогда, когда \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e] ≤ \u003ci\u003eunknown\u003c/i\u003e\u003c/span\u003e (жадно отдаем это блюдо всем пассажирам, для кого их точное блюдо неизвестно),\u003c/li\u003e   \u003cli\u003eнедовольный пассажир есть, этот случай разберем подробнее.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eКаким блюдом мог быть недоволен первый из таких пассажиров? Очевидно из списка кандидатов надо выкинуть все такие блюда, которые упоминаются не раньше него (значит, что они закончится до него не могли). Из оставшегося набора блюд достаточно перебрать все блюда и проверить могли ли они закончиться до этого пассажира. То есть блюдо \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e могло быть тем блюдом, что привело в недовольство первого недовольного, если одновременно верно:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eэто блюдо \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e не упоминается на этом пассажире или позже,\u003c/li\u003e   \u003cli\u003eэто блюдо \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e такое, что \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e] ≤ \u003ci\u003eunknownBeforeUpset\u003c/i\u003e\u003c/span\u003e.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eДля всех таких блюд, очевидно, в ответе должно стоять \u003ccode\u003eY\u003c/code\u003e (они могли закончится к Поликарпу). Кроме того, из всех таких блюд наибольшую степень свободы дает блюдо с наименьшим расходом (количеством порций b[i]). Выберем именно такое блюдо и в остаток пассажиров с неизвестным блюдом \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003erestUnknown\u003c/i\u003e \u003d \u003ci\u003eunknown\u003c/i\u003e - \u003ci\u003eb\u003c/i\u003e[\u003ci\u003eminFirstFinished\u003c/i\u003e]\u003c/span\u003e попробуем поместить все вхождения каждого из других блюд. То есть блюдо \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e могло закончится до Поликарпа тогда и только тогда, если для него \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e[\u003ci\u003ej\u003c/i\u003e] ≤ \u003ci\u003erestUnknown\u003c/i\u003e\u003c/span\u003e (то есть закончилось то блюдо, что расстроило первого из недовольных, а следом — \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e-е).\u003c/p\u003e\u003cp\u003eТакое решение работает за \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003em\u003c/i\u003e + \u003ci\u003ek\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eПример решения: \u003ca href\u003d\"/contest/522/submission/10212686\" title\u003d\"Посылка 10212686 от MikeMirzayanov\"\u003e10212686\u003c/a\u003e.\u003c/p\u003e\u003ch2\u003e\u003ca href\u003d\"/contest/522/problem/D\" title\u003d\"VK Cup 2015 - Квалификация 1\"\u003e522D - Ближайшие равные\u003c/a\u003e\u003c/h2\u003e\u003cp\u003eВоспользуемся тем, что задача задана в офлайн-формулировке, то есть все запросы можно считать до нахождения ответов на них.\u003c/p\u003e\u003cp\u003eПройдем слева направо по массиву и составим новый массив \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003c/span\u003e, записав в \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e[\u003ci\u003ej\u003c/i\u003e]\u003c/span\u003e расстояние до ближайшего слева парного \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e-му элементу значения, то есть \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e[\u003ci\u003ej\u003c/i\u003e - \u003ci\u003eb\u003c/i\u003e[\u003ci\u003ej\u003c/i\u003e]] \u003d \u003ci\u003ea\u003c/i\u003e[\u003ci\u003ej\u003c/i\u003e]\u003c/span\u003e. Если такового нет, то запишем в ячейку бесконечность.\u003c/p\u003e\u003cp\u003eЭти значения соответствуют расстояниям между парными элементами и записаны они в позициях правых элементов в этих парах.\u003c/p\u003e\u003cp\u003eПри рассмотрении запроса на отрезке \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e, \u003ci\u003er\u003c/i\u003e]\u003c/span\u003e нам не нужны вообще такие пары, что начинаются левее \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e, а минимум надо искать среди пар, что заканчиваются не правее \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eОтсортируем все запросы по \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e слева направо. Тогда при прохождении по запросам можно поддерживать, что для запроса \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e, \u003ci\u003er\u003c/i\u003e]\u003c/span\u003e в массиве \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003c/span\u003e установлены бесконечности для всех пар, в которых левый элемент левее \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e. Для этого просто предподсчитаем для каждого элемента ближайший справа парный \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003enext\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e]\u003c/span\u003e (то есть верно, что \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e[\u003ci\u003enext\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e]] \u003d \u003ci\u003enext\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e] - \u003ci\u003ei\u003c/i\u003e\u003c/span\u003e), и при покидании ячейки \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e будем записывать в \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e[\u003ci\u003enext\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e]]\u003c/span\u003e значение бесконечность.\u003c/p\u003e\u003cp\u003eВ таком случае, для ответа на запрос \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e, \u003ci\u003er\u003c/i\u003e]\u003c/span\u003e надо просто найти минимум на префиксе до индекса \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e включительно по массиву \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003c/span\u003e. Это можно делать быстро разными способами (дерево отрезков, дерево Фенвика).\u003c/p\u003e\u003cp\u003eАсимптотическая временная сложность такого решения составляет \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/3d/5c/3d5c78f97b744eda7119540839ad7ef06dc52838.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/p\u003e\u003cp\u003eПример решения: \u003ca href\u003d\"/contest/522/submission/10192075\" title\u003d\"Посылка 10192075 от Беспонтовый пирожок\"\u003e10192075\u003c/a\u003e.\u003c/p\u003e\u003c/div\u003e","tags":["vkcup2015"]}}