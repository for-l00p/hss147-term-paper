{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1435247474,"rating":18,"authorHandle":"keyvankhademi","modificationTimeSeconds":1435307765,"id":18877,"title":"\u003cp\u003eProject Euler Problem #511\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eRecently i was trying to solve some Project Euler question. Then i met problem #511 in which i interested a lot.\u003cbr /\u003e I want to share the problem and my solution with you. Here it the \u003ca href\u003d\"https://projecteuler.net/problem\u003d511\"\u003elink\u003c/a\u003e to the problem.\u003cbr /\u003e\u003c/p\u003e\u003ch2\u003eThe Problem:\u003c/h2\u003e\u003cp\u003elet define \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eseq\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e, \u003ci\u003ek\u003c/i\u003e)\u003c/span\u003e number of sequences \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e...\u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e which has this two property. \u003cbr /\u003e 1) \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e is divisible by \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e \u003cbr /\u003e 2) \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e + \u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e + \u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e + ... + \u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e is divisible by \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e \u003cbr /\u003e\u003cbr /\u003e Two numbers \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e ans \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e are given, output \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eseq\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e, \u003ci\u003ek\u003c/i\u003e)\u003c/span\u003e mod \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eM\u003c/i\u003e\u003c/span\u003e \u003cbr /\u003e you may consider \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e \u0026lt;  \u003d 10\u003csup class\u003d\"upper-index\"\u003e12\u003c/sup\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e \u0026lt;  \u003d 5000\u003c/span\u003e \u003cbr /\u003e\u003c/p\u003e\u003ch2\u003eSolution:\u003c/h2\u003e\u003cp\u003eMy solution idea came from \u003ca href\u003d\"//codeforces.com/blog/entry/14385\"\u003ethis blog\u003c/a\u003e. Thanks from \u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/kien_coi_1997\" title\u003d\"Master kien_coi_1997\"\u003ekien_coi_1997\u003c/a\u003e. \u003cbr /\u003e Consider \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edp\u003c/i\u003e(\u003ci\u003em\u003c/i\u003e, \u003ci\u003erem\u003c/i\u003e)\u003c/span\u003e which mean the answer to the problem if the the sequence size is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e and sum of numbers in sequence is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003erem\u003c/i\u003e\u003c/span\u003e mod \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eM\u003c/i\u003e\u003c/span\u003e.\u003cbr /\u003e You can recursively call function dp. consider \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e is odd then you can brute force \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e and find the rest with \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edp\u003c/i\u003e(\u003ci\u003em\u003c/i\u003e - 1, \u003ci\u003erem\u003c/i\u003e - \u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e. and if \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e was even you can split the sequence in to two equal sized sub-sequence. By brute forcing the sum of the first sub-sequence you can find the answer with \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edp\u003c/i\u003e(\u003ci\u003em\u003c/i\u003e / 2, \u003ci\u003er\u003c/i\u003e1) * \u003ci\u003edp\u003c/i\u003e(\u003ci\u003em\u003c/i\u003e / 2, \u003ci\u003erem\u003c/i\u003e - \u003ci\u003er\u003c/i\u003e1)\u003c/span\u003e .\u003cbr /\u003e\u003c/p\u003e \u003cpre\u003e\u003ccode\u003elong long dp(long long m, long long rem)\n{\n    long long ans \u003d 0;\n    if(m\u0026amp;1)\n    {\n\tfor(int i \u003d 0; i \u0026lt; dv.size(); i++)\n\t{\n\t    ans +\u003d dp(m-1, ( rem - dv[i] + k )%k );\n\t}\n    }\n    else\n    {\n\tfor(int i \u003d 0; i \u0026lt; k; i++)\n\t{\n\t    ans +\u003d dp(m/2, i)*dp(m/2, (rem - i + k)%k );\n\t}\n    }\n    return ans;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThen you can call function \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edp\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e,  - \u003ci\u003en\u003c/i\u003e)\u003c/span\u003e as the answer for the problem.\u003cbr /\u003e The time complexity of this solution is \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/8b/d7/8bd7779a0ed2f3dfb55a4917899169d60246fcff.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e \u003cbr /\u003e which \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003edv\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e)\u003c/span\u003e is number of divisors of n and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003elog\u003c/i\u003e(\u003ci\u003elog\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e))\u003c/span\u003e is because we should memoized with map\u003cbr /\u003e Although this solution is not very efficient but it was enough for PE, any faster solution will be appreciate.\u003c/p\u003e\u003cp\u003eUPD: With optimization we can reach \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/aa/8c/aa8cb30bfab600c31c5acf7f8c256ac682e1d90d.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e time complexity.\u003c/p\u003e\u003c/div\u003e","tags":["dp","matrix exponentiation","project euler"]}}