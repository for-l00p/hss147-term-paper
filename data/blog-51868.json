{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1494063333,"rating":12,"authorHandle":"I_love_Hoang_Yen","modificationTimeSeconds":1494068569,"id":51868,"title":"\u003cp\u003eVNOI Marathon 2008 — Div 2 — Lời giải\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eSolution của 1 số bài được copy của bạn \u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/MofK\" title\u003d\"International master MofK\"\u003eMofK\u003c/a\u003e \u003ca href\u003d\"https://www.facebook.com/groups/163215593699283/permalink/1444474055573424/?comment_id\u003d1444507905570039\"\u003eLink\u003c/a\u003e\u003c/p\u003e\u003cp\u003eCode: \u003ca href\u003d\"https://github.com/ngthanhtrung23/VNOI_contests/tree/master/VM08/Div2\"\u003eGithub\u003c/a\u003e. Các solution này nhằm mục đích để các bạn tham khảo khi bí. Vì nó ko đc viết theo solution trình bày trong post này nên sẽ có thể ko liên quan :))\u003c/p\u003e\u003ch1\u003e\u003ca href\u003d\"/group/FLVn1Sc504/contest/212939/problem/A\" title\u003d\"VNOI Marathon 2008 - div 2\"\u003e212939A - Bậc thang\u003c/a\u003e\u003c/h1\u003e\u003cp\u003eĐể làm được bài này bạn chỉ cần biết Quy hoạch động cơ bản. Bạn có thể đọc trong:\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003ca href\u003d\"http://vnoi.info/wiki/algo/basic/Tai-Lieu-Thuat-Toan\"\u003eSách thầy Hoàng hoặc Tài liệu giáo khoa chuyên Tin\u003c/a\u003e.\u003c/li\u003e   \u003cli\u003eMột số bài viết trên VNOI wiki: \u003ca href\u003d\"http://vnoi.info/wiki/translate/topcoder/dynamic-programming\"\u003e1\u003c/a\u003e, \u003ca href\u003d\"http://vnoi.info/wiki/algo/dp/palindrome-problems\"\u003e2\u003c/a\u003e, \u003ca href\u003d\"http://vnoi.info/wiki/algo/dp/basic-problems\"\u003e3\u003c/a\u003e.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eĐặt \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e]\u003c/span\u003e là số cách để đi đến bậc thang thứ \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e. Dễ dàng tìm được công thức quy hoạch động:\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e] \u003d \u003ci\u003ef\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e - 1] + \u003ci\u003ef\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e - 2]\u003c/span\u003e nếu ô \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e ko bị cấm, nếu bị cấm thì \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e] \u003d 0\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eĐáp án là \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e[\u003ci\u003eN\u003c/i\u003e]\u003c/span\u003e. ---\u003c/p\u003e\u003ch1\u003e\u003ca href\u003d\"/group/FLVn1Sc504/contest/212939/problem/B\" title\u003d\"VNOI Marathon 2008 - div 2\"\u003e212939B - Bàn cờ\u003c/a\u003e\u003c/h1\u003e\u003cp\u003eĐể làm được bài này, bạn cần biết \u003ca href\u003d\"http://vnoi.info/wiki/algo/data-structures/data-structures-overview#2-ctdl-truy-vấn_2-1-mảng-cộng-dồn-partial-sum\"\u003emảng cộng dồn\u003c/a\u003e. Đây là kĩ thuật cơ bản dùng trong rất nhiều bài toán.\u003c/p\u003e\u003cp\u003eTrên bảng 2D, thông thường bạn sẽ phải tính \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e là tổng các số trong hình chữ nhật có 2 góc đối diện là \u003cspan class\u003d\"tex-span\"\u003e(1, 1)\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e) \u003d \u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e - 1, \u003ci\u003ej\u003c/i\u003e) + \u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e - 1) - \u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e - 1, \u003ci\u003ej\u003c/i\u003e - 1) + \u003ci\u003ea\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eTính 2 cái tổng dồn các ô trắng và ô đen trong hình chữ nhật con có góc trên trái là (1,1) góc dưới phải là (i,j) rồi trả lời truy vấn trong O(1).\u003c/p\u003e\u003ch1\u003e\u003ca href\u003d\"/group/FLVn1Sc504/contest/212939/problem/C\" title\u003d\"VNOI Marathon 2008 - div 2\"\u003e212939C - Đếm đường đi trên đồ thị đầy đủ\u003c/a\u003e\u003c/h1\u003e\u003ch2\u003eSố đường đi\u003c/h2\u003e\u003cp\u003eĐặt \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e)\u003c/span\u003e là số đường đi độ dài \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eChú ý là trong quá trình xây dựng đường đi độ dài \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e, ta không được đi qua đỉnh kết thúc. Cách xử lý đơn giản là ta hình dung là ta bỏ đỉnh kết thúc khỏi đồ thị, và tìm 1 đường đi bất kỳ trong đồ thị mới:\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"https://lh3.googleusercontent.com/zaIMfXGjMSM028agg5K1-8Kjy0waHjgVACMHC5DQ4GnWC1cTPzsY9nWotHqfvJ0Yamo6vxBiZb1bwyVvy5UKi5I-zmntOaeXyoDB_QZYvvrAYU9SODtYjzN3A-3tLUvAWqcT8p0jtZyE8FO2-eRjyQq1kJZHGKtNbUAmiS7aBH5Fmvw8oNkdNF4c5IotFF1BH-B4fU92EdUILbLs1O82V5-j3bSGRqysXr2F48ZyxCeExJBHMrc3FZdhh4C0N3y3Qfq8wYb4KHD9jmbcV0VG5XRdXpCkJsBiaxpg2xWpGq_ob0kLJ-IkFUtLrBDSDn_AI1z4wGFug-7H3Ef6ylaKngOUSiKZm7qafU6DCbdtfxTzP5O3YLKRAwRiHSJmfzxjK8EQXdqlPawyxBHdAXEADi9pH-7D-oepYuWnrLhK4HqUoAH9dmryLUTVZJXchmTv6Ck0IK0BlmkdNN6mv-D1D643yC55u0N238zR2X_2pvo8O6RFAzlYSvDS65r3E1HecqId2TK-pEe8aoyUEVxEXlOh586LFfylGxVPMSn9sZJzXCkuTyB_jUrCrcrQp9izgMYiki4IHwlCBZSD-cGElFSYxStvvZ2kjoJF9coxj2feOiKH\u003dw200-h156-no\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eSau khi tìm được đường đi màu xanh trong đồ thị \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e - 1\u003c/span\u003e đỉnh, ta nối thêm 1 đỉnh kết thúc ở ngoài.\u003c/p\u003e\u003cp\u003eĐể tính số đường đi màu xanh độ dài \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e:\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e + 1) \u003d (\u003ci\u003eN\u003c/i\u003e - 1 - \u003ci\u003ei\u003c/i\u003e) * \u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e)\u003c/span\u003e\u003c/p\u003e\u003cp\u003eGiải thích: lấy 1 đường đi độ dài \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e bất kỳ và kéo dài thêm 1 đỉnh mới trong các đỉnh chưa đi qua.\u003c/p\u003e\u003ch2\u003eCài đặt\u003c/h2\u003e\u003cp\u003eVì kết quả lớn hơn phạm vi số 64-bit, nên cần cài đặt số lớn với bài này.\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"https://sites.google.com/site/kc97ble/container/bignum-cpp\"\u003eCode số lớn\u003c/a\u003e\u003c/p\u003e\u003ch1\u003e\u003ca href\u003d\"/group/FLVn1Sc504/contest/212939/problem/D\" title\u003d\"VNOI Marathon 2008 - div 2\"\u003e212939D - Xóa số\u003c/a\u003e\u003c/h1\u003e\u003ch2\u003eSinh số nguyên tố\u003c/h2\u003e\u003cp\u003eSố số nguyên tố nhỏ hơn hoặc bằng \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e là \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003eN\u003c/i\u003e / \u003ci\u003elog\u003c/i\u003e(\u003ci\u003eN\u003c/i\u003e))\u003c/span\u003e, nên để sinh được 50k số nguyên tố, thì ta cần xét đến tầm 1 triệu (có thể kiểm chứng cận trên chính xác bằng code). Dễ dàng sinh được các số nguyên tố cần thiết bằng sàng.\u003c/p\u003e\u003ch2\u003eXóa tối ưu\u003c/h2\u003e\u003cp\u003eThay vì nghĩ là ta cần xóa \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eK\u003c/i\u003e\u003c/span\u003e chữ số, hãy nghĩ là ta cần giữ lại \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e - \u003ci\u003eK\u003c/i\u003e\u003c/span\u003e chữ số.\u003c/p\u003e\u003cp\u003eGiờ giả sử ta có số \u003cspan class\u003d\"tex-span\"\u003e91435\u003c/span\u003e và ta cần giữ lại 2 chữ số, rõ ràng ta sẽ giữ lại số \u003cspan class\u003d\"tex-span\"\u003e95\u003c/span\u003e. Tại sao? Rõ ràng số lớn nhất nếu chữ số đầu tiên lớn nhất, nên ta giữ lại 9. Ta luôn giữ lại chữ số to nhất có thể, sao cho nếu giữ lại chữ số đó thì ta vẫn đủ chữ số. Ví dụ khác: \u003cspan class\u003d\"tex-span\"\u003e11199\u003c/span\u003e và cần giữ lại 3 chữ số --\u0026gt; không thể để chữ số đầu tiên là 9, vì như thế thì sẽ không có đủ 3 chữ số.\u003c/p\u003e\u003cp\u003eDo đó, cách làm là: đi từ trái sang phải, chọn chữ số lớn nhất để giữ lại sao cho vẫn còn đủ \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eX\u003c/i\u003e\u003c/span\u003e chữ số cần giữ lại. Ví dụ:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eChữ số đầu tiên giữ lại là \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emax\u003c/i\u003e(\u003ci\u003eA\u003c/i\u003e1..\u003ci\u003eA\u003c/i\u003e(\u003ci\u003eN\u003c/i\u003e - \u003ci\u003eX\u003c/i\u003e + 1)\u003c/span\u003e. Đặt chỉ số của nó là \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e1\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003eChữ số thứ 2 giữ lại là \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emax\u003c/i\u003e(\u003ci\u003eA\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e1)..\u003ci\u003eA\u003c/i\u003e(\u003ci\u003eN\u003c/i\u003e - \u003ci\u003eX\u003c/i\u003e + 2)\u003c/span\u003e. ...\u003c/li\u003e \u003c/ul\u003e\u003ch2\u003eTìm số lớn nhất\u003c/h2\u003e\u003cp\u003eNhư vậy để làm được bài này, ta cần sử dụng 1 CTDL nào đó giúp tìm chữ số lớn nhất trong 1 đoạn. Có 2 cách:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eCách 1: \u003ca href\u003d\"http://vnoi.info/wiki/translate/wcipeg/Binary-Heap\"\u003eHeap\u003c/a\u003e. Heap cho phép ta thêm, xoá và tìm max.\u003c/li\u003e   \u003cli\u003eCách 2: \u003ca href\u003d\"http://vnoi.info/wiki/algo/data-structures/deque-min-max\"\u003eDeque\u003c/a\u003e\u003c/li\u003e \u003c/ul\u003e\u003ch1\u003e\u003ca href\u003d\"/group/FLVn1Sc504/contest/212939/problem/E\" title\u003d\"VNOI Marathon 2008 - div 2\"\u003e212939E - Số nguyên\u003c/a\u003e\u003c/h1\u003e\u003cp\u003eĐể làm được bài này, các bạn cần biết \u003ca href\u003d\"http://vnoi.info/wiki/translate/he/Number-Theory#Ước-chung-lớn-nhất_thuật-toán-euclid-mở-rộng-extended-euclid-algorithm\"\u003ethuật toán Euclid mở rộng\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eSử dụng thuật toán Extended Euclid tìm nghiệm nguyên của phương trình \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eax\u003c/i\u003e - \u003ci\u003eby\u003c/i\u003e \u003d 1\u003c/span\u003e với \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003egcd\u003c/i\u003e(\u003ci\u003ea\u003c/i\u003e, \u003ci\u003eb\u003c/i\u003e) \u003d 1\u003c/span\u003e. Từ đó suy ra được một nghiệm \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e bất kì của phương trình \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eax\u003c/i\u003e - \u003ci\u003eby\u003c/i\u003e \u003d \u003ci\u003ec\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eNhận xét là nếu \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e là nghiệm thì \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ex\u003c/i\u003e - \u003ci\u003eb\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e - \u003ci\u003ea\u003c/i\u003e)\u003c/span\u003e cũng là nghiệm, và điều này làm giảm tổng \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e + \u003ci\u003ey\u003c/i\u003e\u003c/span\u003e. Do đó, ta tìm số \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e lớn nhất sao cho \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e ≤ \u003ci\u003ebk\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e ≤ \u003ci\u003eak\u003c/i\u003e\u003c/span\u003e thì đáp án là \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ex\u003c/i\u003e - \u003ci\u003ebk\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e - \u003ci\u003eak\u003c/i\u003e)\u003c/span\u003e. Trường hợp \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e \u003d 0\u003c/span\u003e hoặc \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e \u003d 0\u003c/span\u003e thì phải giải pt bậc nhất thay vì giải như trên.\u003c/p\u003e\u003ch1\u003e\u003ca href\u003d\"/group/FLVn1Sc504/contest/212939/problem/F\" title\u003d\"VNOI Marathon 2008 - div 2\"\u003e212939F - Những con số\u003c/a\u003e\u003c/h1\u003e\u003cp\u003eDuyệt các số từ bé đến lớn, đặt nó vào nhóm đầu tiên mà ko có số nào là ước của nó. Thuật toán trên đúng theo định lý Dilworth. Sau khi đặt một số vào nhóm thì ta cập nhật đáp án cho các bội của nó.\u003c/p\u003e\u003ch1\u003e\u003ca href\u003d\"/group/FLVn1Sc504/contest/212939/problem/G\" title\u003d\"VNOI Marathon 2008 - div 2\"\u003e212939G - Hình chữ nhật\u003c/a\u003e\u003c/h1\u003e\u003ch2\u003eN^4\u003c/h2\u003e\u003cp\u003eDùng kĩ thuật \u003ca href\u003d\"http://vnoi.info/wiki/algo/data-structures/data-structures-overview#2-ctdl-truy-vấn_2-1-mảng-cộng-dồn-partial-sum\"\u003emảng cộng dồn\u003c/a\u003e, ta dễ dàng tính được tổng của 1 hình chữ nhật có 2 đỉnh đối nhau là \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e\u003c/p\u003e\u003cp\u003eKhởi tạo mảng cộng dồn:\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e \u003d tổng các số trong hình chữ nhật có 2 đỉnh đối nhau là \u003cspan class\u003d\"tex-span\"\u003e(1, 1)\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e--\u0026gt; \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e) \u003d \u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e - 1, \u003ci\u003ej\u003c/i\u003e) + \u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e - 1) - \u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e - 1, \u003ci\u003ej\u003c/i\u003e - 1) + \u003ci\u003eA\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e với \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e là số ở ô \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e--\u0026gt; tổng các số trong 1 hình chữ nhật có 2 đỉnh đối diện \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e, nếu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e ≤ \u003ci\u003eu\u003c/i\u003e\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e ≤ \u003ci\u003ev\u003c/i\u003e\u003c/span\u003e là:\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e) - \u003ci\u003eS\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e - 1) - \u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e - 1, \u003ci\u003ev\u003c/i\u003e) + \u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e - 1, \u003ci\u003ej\u003c/i\u003e - 1)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eNhư vậy ta có thể tính tổng 1 hình chữ nhật bất kỳ trong \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(1)\u003c/span\u003e. Từ đó ta có thuật toán \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e4\u003c/sup\u003e\u003c/span\u003e rất đơn giản: Xét tất cả các hình chữ nhật con trong bảng, với mỗi hình kiểm tra tổng các phần tử bên trong nó có đủ \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eK\u003c/i\u003e\u003c/span\u003e hay không.\u003c/p\u003e\u003ch2\u003eN^3\u003c/h2\u003e\u003cp\u003e1 hình chữ nhật được xác định bởi 4 biến: tọa độ của 2 đỉnh đối diện. \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e. Thông thường cách tiếp cận các bài toán có nhiều biến chưa biết là ta duyệt 1 vài biến và tìm các biến còn lại trong thời gian đủ nhanh.\u003c/p\u003e\u003cp\u003eỞ đây ta duyệt 2 biến i và u. Nói cách khác là ta cố định cạnh trên và cạnh dưới của hình chữ nhật. Khi đó, mỗi cột luôn gồm các số từ hàng i đến hàng u. Nếu ta đặt\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e(\u003ci\u003ej\u003c/i\u003e) \u003d \u003ci\u003esum\u003c/i\u003e(\u003ci\u003eA\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e) + \u003ci\u003eA\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e + 1, \u003ci\u003ej\u003c/i\u003e) + ... + \u003ci\u003eA\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e))\u003c/span\u003e\u003c/p\u003e\u003cp\u003ethì bài toán trở thành bài toán 1 chiều: cho 1 dãy số \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e. Tìm l và r sao cho \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e - \u003ci\u003el\u003c/i\u003e + 1\u003c/span\u003e nhỏ nhất và tổng các phần tử từ l đến r lớn hơn hoặc bằng \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eK\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eĐể giải bài toán này, thì ta nhận thấy, khi r di chuyển sang phải, thì l cũng di chuyển sang phải, nên ta có thể thu được thuật toán \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003eN\u003c/i\u003e)\u003c/span\u003e như sau:\u003c/p\u003e \u003cpre\u003e\u003ccode\u003eint l \u003d 1;\nfor (int r \u003d 1; r \u0026lt;\u003d N; r++) {\n    // chạy l theo r chừng nào vẫn có thể chạy được\n    while (l \u0026lt; r \u0026amp;\u0026amp; sum(l+1, r) \u0026lt;\u003d K) ++l; // hàm sum(l, r) trả lại tổng các số l --\u0026gt; r trong O(1)\n                                           // dùng kĩ thuật mảng cộng dồn\n    if (sum(l, r) \u0026gt;\u003d K) {\n        // cập nhật kết quả theo [l, r]\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch1\u003e\u003ca href\u003d\"/group/FLVn1Sc504/contest/212939/problem/H\" title\u003d\"VNOI Marathon 2008 - div 2\"\u003e212939H - Kiến\u003c/a\u003e\u003c/h1\u003e\u003cp\u003eBài này có tên gọi là Bài toán Josephus. Các bạn có thể Google solution rất đơn giản. Ví dụ \u003ca href\u003d\"https://kienthuc24h.com/bai-toan-josephus-ai-se-la-nguoi-cuoi-cung/\"\u003ebài viết này\u003c/a\u003e viết khá chi tiết.\u003c/p\u003e\u003ch1\u003e\u003ca href\u003d\"/group/FLVn1Sc504/contest/212939/problem/I\" title\u003d\"VNOI Marathon 2008 - div 2\"\u003e212939I - Những hình nhân nhảy múa\u003c/a\u003e\u003c/h1\u003e\u003cp\u003eNếu ta lưu lại \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e]\u003c/span\u003e là tổng các số từ \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e + .. + \u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e thì phép biến đổi 3 số \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e], \u003ci\u003ea\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e + 1], \u003ci\u003ea\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e + 2]\u003c/span\u003e thực chất là phép đổi chỗ 2 tổng \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e]\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e + 1]\u003c/span\u003e. Như vậy, đáp án (nếu có) sẽ nhận được khi các tổng dồn được xếp tăng dần.\u003c/p\u003e\u003ch1\u003e\u003ca href\u003d\"/group/FLVn1Sc504/contest/212939/problem/K\" title\u003d\"VNOI Marathon 2008 - div 2\"\u003e212939K - Quyết đấu\u003c/a\u003e\u003c/h1\u003e\u003cp\u003eHướng đi thông thường là quy hoạch động theo kiểu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e, \u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e, là nếu chỉ xét người từ \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e đến \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e, thì thằng \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e có vô địch được không. Tuy nhiên làm kiểu này độ phức tạp rất lớn và bộ nhớ cũng lớn.\u003c/p\u003e\u003cp\u003eTa nhận thấy chiều \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e không quan trọng, nói cách khác, ta sửa lại hàm \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e là có tồn tại cách chơi, để khi chơi hết đoạn \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e đến \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e, thì còn lại cả \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eTừ đó thu được công thức quy hoạch động \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e3\u003c/sup\u003e\u003c/span\u003e rất đơn giản:\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e) \u003d \u003ci\u003etrue\u003c/i\u003e\u003c/span\u003e nếu tồn tại \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e mà \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ek\u003c/i\u003e) \u003d \u003ci\u003ef\u003c/i\u003e(\u003ci\u003ek\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e) \u003d 1\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ek\u003c/i\u003e) \u003d 1||\u003ci\u003eA\u003c/i\u003e(\u003ci\u003ej\u003c/i\u003e, \u003ci\u003ek\u003c/i\u003e) \u003d 1\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eChú ý mối liên hệ giữa công thức mới \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e với công thức cũ \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e, \u003ci\u003ek\u003c/i\u003e)\u003c/span\u003e. Ở đây \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e thể hiện là trong đoạn i — j còn cả 2 đầu i và j còn sống. Còn trong công thức \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e, \u003ci\u003ek\u003c/i\u003e)\u003c/span\u003e thể hiện trong đoạn i — j chỉ còn k còn sống.\u003c/p\u003e\u003cp\u003eSau khi tính được \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e, để xem i có thể còn sống sót đến cuối không, ta chỉ cần xem \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ei\u003c/i\u003e)\u003c/span\u003e. Chú ý đây là cách xử lý trên hình tròn thông thường: cắt vòng tròn ở điểm i.\u003c/p\u003e\u003ch1\u003e\u003ca href\u003d\"/group/FLVn1Sc504/contest/212939/problem/L\" title\u003d\"VNOI Marathon 2008 - div 2\"\u003e212939L - Số 0 tận cùng\u003c/a\u003e\u003c/h1\u003e\u003cp\u003eTa biết số hoán vị là:\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e! / (\u003ci\u003ecount\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/sub\u003e!\u003ci\u003ecount\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eb\u003c/i\u003e\u003c/sub\u003e!\u003ci\u003ecount\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ec\u003c/i\u003e\u003c/sub\u003e!...)\u003c/span\u003e\u003c/p\u003e\u003cp\u003evới \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ecount\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e là số lượng ký tự x.\u003c/p\u003e\u003cp\u003eSố lương chữ số 0 tận cùng chỉ phụ thuộc vào số lượng số 2 và 5 trong phân tích thừa số nguyên tố (chính xác là min của 2 giá trị này).\u003c/p\u003e\u003cp\u003eDo đó, để giải được bài này, đầu tiên ta cần giải bài toán con sau:\u003c/p\u003e\u003cp\u003eCho số \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e và số nguyên tố \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e. Tìm \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e lớn nhất sao cho \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e!\u003c/span\u003e chia hết cho \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/sup\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eNói cách khác là tìm luỹ thừa của \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e trong phân tích thừa số nguyên tố của \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e!\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eCách làm bài toán con này như sau:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eSố lượng bội của \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e mà không quá \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e là \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e / \u003ci\u003ep\u003c/i\u003e\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003eSố lượng bội của \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003c/sup\u003e\u003c/span\u003e mà không quá \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e là \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e / \u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003c/sup\u003e\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003eSố lượng bội của \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e3\u003c/sup\u003e\u003c/span\u003e mà không quá \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e là \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e / \u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e3\u003c/sup\u003e\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003e...\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eDo đó, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e \u003d \u003ci\u003eN\u003c/i\u003e / \u003ci\u003ep\u003c/i\u003e + \u003ci\u003eN\u003c/i\u003e / \u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003c/sup\u003e + ...\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eMột cách cài đặt ngắn gọn:\u003c/p\u003e \u003cpre\u003e\u003ccode\u003eint get(int n, int p) {\n    return (n / p) + get(n/p);\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch1\u003e\u003ca href\u003d\"/group/FLVn1Sc504/contest/212939/problem/M\" title\u003d\"VNOI Marathon 2008 - div 2\"\u003e212939M - Bin Laden\u003c/a\u003e\u003c/h1\u003e\u003cp\u003eĐây là một bài toán tìm đường đi ngắn nhất cơ bản trên đồ thị. Có thể dùng Dijkstra để giải. Bạn có thể đọc thêm trong \u003ca href\u003d\"http://vnoi.info/wiki/algo/basic/Tai-Lieu-Thuat-Toan\"\u003eSách thầy Hoàng hoặc Tài liệu giáo khoa chuyên Tin\u003c/a\u003e.\u003c/p\u003e\u003c/div\u003e","tags":[]}}