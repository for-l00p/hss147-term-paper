{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1420019329,"rating":277,"authorHandle":".o.","modificationTimeSeconds":1448953109,"id":15488,"title":"\u003cp\u003eGood Bye 2014 Editorial\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eFirst of all, sorry for the late editorial. I was too exhausted and immediately went to bed after the round finished, and didn\u0027t write the editorial.\u003c/p\u003e\u003cp\u003eThere are many pictures in this editorial, to cover up my poor English skills! If you have detected any errors or have questions, feel free to ask questions by comments. Unfortunately, the authors only know English, so we can\u0027t answer you if you write comments in Russian.\u003c/p\u003e\u003ch2\u003e\u003ca href\u003d\"/contest/500/problem/A\" title\u003d\"Good Bye 2014\"\u003e500A - New Year Transportation\u003c/a\u003e\u003c/h2\u003e\u003cp\u003eLet\u0027s assume that I am in the cell \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e (\u003cspan class\u003d\"tex-span\"\u003e1 ≤ \u003ci\u003ei\u003c/i\u003e ≤ \u003ci\u003en\u003c/i\u003e\u003c/span\u003e). If \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e ≤ \u003ci\u003en\u003c/i\u003e - 1\u003c/span\u003e, I have two choices: to stay at cell \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e, or to go to cell \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e + \u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e. If \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e \u003d \u003ci\u003et\u003c/i\u003e\u003c/span\u003e, we are at the target cell, so I should print \u0026quot;YES\u0026quot; and terminate. If \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e \u0026gt; \u003ci\u003et\u003c/i\u003e\u003c/span\u003e, I cannot go to cell \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003c/span\u003e because I can\u0027t use the portal backwards, so one should print \u0026quot;NO\u0026quot; and terminate. Otherwise, I must go to cell \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e + \u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eUsing this method, I visit each cell at most once, and there are \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e cells, so the problem can be solved in linear time.\u003c/p\u003e\u003ch4\u003eWhat is test 13?\u003c/h4\u003e\u003cp\u003eThere are 9 pretests in this problem. There are no test where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e \u003d \u003ci\u003et\u003c/i\u003e\u003c/span\u003e holds in pretests. Many people didn\u0027t handle this case, and got hacked or got Wrong Answer on test 13.\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003cstrong\u003eTime\u003c/strong\u003e: \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e)\u003c/span\u003e\u003c/li\u003e   \u003cli\u003e\u003cstrong\u003eMemory\u003c/strong\u003e: \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e)\u003c/span\u003e (maybe \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(1)\u003c/span\u003e)\u003c/li\u003e   \u003cli\u003e\u003cstrong\u003eImplementation\u003c/strong\u003e: \u003ca href\u003d\"/contest/500/submission/9335683\" title\u003d\"Submission 9335683 by .o.\"\u003e9335683\u003c/a\u003e\u003c/li\u003e \u003c/ul\u003e\u003ch2\u003e\u003ca href\u003d\"/contest/500/problem/B\" title\u003d\"Good Bye 2014\"\u003e500B - New Year Permutation\u003c/a\u003e\u003c/h2\u003e\u003cp\u003eIt seems that many contestants were confused by the statement, so let me clarify it first. Given a permutation \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e, ..., \u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e and a \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e × \u003ci\u003en\u003c/i\u003e\u003c/span\u003e-sized binary matrix \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003c/span\u003e, the problem asks us to find the \u003cem\u003elexicographically minimum permutation\u003c/em\u003e which can be achieved by swapping two distinct elements \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e where the condition \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e \u003d 1\u003c/span\u003e holds. (From the statement, permutation \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003c/span\u003e is prettier than permutation \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eB\u003c/i\u003e\u003c/span\u003e if and only if \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003c/span\u003e is lexicographically less than \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eB\u003c/i\u003e\u003c/span\u003e.)\u003c/p\u003e\u003cp\u003eLet\u0027s think matrix \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003c/span\u003e as an \u003ca href\u003d\"http://en.wikipedia.org/wiki/Adjacency_matrix\"\u003eadjacency matrix\u003c/a\u003e of a undirected unweighted graph.\u003c/p\u003e\u003cp\u003eIf two vertices \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e are in the same component (in other words, connected by some edges), the values of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e can be swapped, using a method similar to \u003ca href\u003d\"http://en.wikipedia.org/wiki/Bubble_sort\"\u003ebubble sort\u003c/a\u003e. Look at the picture below for easy understanding.\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/49/ae/49aeecceec938cf42819cd646a146d1c7c9d2993.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eBecause all the two distinct vertices in the same component can be swapped, the vertices in the same component can be sorted. In conclusion, we can solve the problem by the following procedure.\u003c/p\u003e \u003cul\u003e   \u003cli\u003eFind all the connected components.\u003c/li\u003e   \u003cli\u003eFor each component, sort the elements in the component.\u003c/li\u003e   \u003cli\u003ePrint the resulting permutation.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eThe size limit is quite small, so one can use any algorithm (DFS/BFS/..) for as many times as you want. \u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003cstrong\u003eTime\u003c/strong\u003e: \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003c/sup\u003e)\u003c/span\u003e — because of the graph traversal. \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e3\u003c/sup\u003e)\u003c/span\u003e is okay because of small constraints.\u003c/li\u003e   \u003cli\u003e\u003cstrong\u003eMemory\u003c/strong\u003e: \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003c/sup\u003e)\u003c/span\u003e\u003c/li\u003e   \u003cli\u003e\u003cstrong\u003eImplementation\u003c/strong\u003e: \u003ca href\u003d\"/contest/500/submission/9335689\" title\u003d\"Submission 9335689 by .o.\"\u003e9335689\u003c/a\u003e (\u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/tncks0121\" title\u003d\"International master tncks0121\"\u003etncks0121\u003c/a\u003e)\u003c/li\u003e \u003c/ul\u003e\u003ch4\u003eWhat is test 15? There are too many wrong answers in this case.\u003c/h4\u003e\u003cp\u003eActually, I made the pretests \u003cem\u003every\u003c/em\u003e weak in order to make many hacks. As mentioned in the \u003ca href\u003d\"//codeforces.com/blog/entry/15482\"\u003eHack me! post\u003c/a\u003e by \u003ca class\u003d\"rated-user user-violet\" href\u003d\"/profile/illi\" title\u003d\"Candidate Master illi\"\u003eilli\u003c/a\u003e, just swapping the elements greedily could pass the pretests easily. There were 14 pretests, and I made test 15 an counter-example of such algorithm in order to reduce judging time, and it seems that most of the wrong submissions failed in this test case :D\u003c/p\u003e\u003ch2\u003e\u003ca href\u003d\"/contest/500/problem/C\" title\u003d\"Good Bye 2014\"\u003e500C - New Year Book Reading\u003c/a\u003e\u003c/h2\u003e\u003cp\u003eIn order to calculate the minimum possible \u003cem\u003elifted\u003c/em\u003e weight, we should find the initial stack first. Let\u0027s find the positions one by one.\u003c/p\u003e \u003cul\u003e   \u003cli\u003eFirst, let\u0027s decide the position of book \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e. After day 1, book \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e will be on the top of the stack, regardless of the order of the initial stack. Therefore, in order to minimize the \u003cem\u003elifted\u003c/em\u003e weight during day 1, book \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e must be on the top of the initial stack. (so actually, in day 1, Jaehyun won\u0027t \u003cem\u003elift\u003c/em\u003e any book)\u003c/li\u003e   \u003cli\u003eNext, let\u0027s decide the position of book \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e. (assume that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e ≠ \u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e for simplicity) Currently, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e is on the top of the stack, and it cannot be changed because of the procedure. Therefore, in order to minimize the \u003cem\u003elifted\u003c/em\u003e weight during day 2, book \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e must be immediately below book \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eConsidering this, we can find the optimal strategy to create the initial stack: Scan \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e, ..., \u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e step by step. Let\u0027s assume that I am handling \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e now. If \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e has appeared before (formally, if \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/57/72/57724322449f9a9aaa065ee5740b8497b02032b9.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e), erase \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e from the sequence. Otherwise, leave \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e. The resulting sequence will be the optimal stack.\u003c/p\u003e\u003cp\u003eYou should note that it is not necessary for Jaehyun to read all the books during 2015, which means the size of the resulting sequence may be smaller than \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e. The books which doesn\u0027t appear in the resulting sequence must be in the bottom of the initial stack (obviously). However, this problem doesn\u0027t require us to print the initial stack, so it turned out not to be important. \u003c/p\u003e\u003cp\u003eIn conclusion, finding the initial stack takes \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e + \u003ci\u003em\u003c/i\u003e)\u003c/span\u003e time.\u003c/p\u003e\u003cp\u003eAfter finding the initial stack, we can simulate the procedure given in the statement naively. It will take \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003enm\u003c/i\u003e)\u003c/span\u003e time.\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003cstrong\u003eTime\u003c/strong\u003e: \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003enm\u003c/i\u003e)\u003c/span\u003e\u003c/li\u003e   \u003cli\u003e\u003cstrong\u003eMemory:\u003c/strong\u003e \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e + \u003ci\u003em\u003c/i\u003e)\u003c/span\u003e\u003c/li\u003e   \u003cli\u003e\u003cstrong\u003eImplementation\u003c/strong\u003e: \u003ca href\u003d\"/contest/500/submission/9335694\" title\u003d\"Submission 9335694 by .o.\"\u003e9335694\u003c/a\u003e (\u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/tncks0121\" title\u003d\"International master tncks0121\"\u003etncks0121\u003c/a\u003e)\u003c/li\u003e \u003c/ul\u003e\u003ch2\u003e\u003ca href\u003d\"/contest/500/problem/D\" title\u003d\"Good Bye 2014\"\u003e500D - New Year Santa Network\u003c/a\u003e\u003c/h2\u003e\u003cp\u003eThe problem asks us to calculate the value of\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/6e/71/6e71e90cffb07eb65e303edb29b51cad1be3a21c.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eLet\u0027s write it down..\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/3c/30/3c306cf64102b2f5edfdbd9c99e1c049b6692e49.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eSo, we need to calculate the value of \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/c9/1a/c91a5fa22a9f6b69147aface3bee89fae76dcadf.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. I\u0027ll denote the sum as \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003c/span\u003e. How should we calculate this?\u003c/p\u003e\u003cp\u003eFor simplicity, I\u0027ll set node 1 as the root of the tree. Let\u0027s focus on an edge \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ee\u003c/i\u003e\u003c/span\u003e, connecting two vertices \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e. See the picture below.\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/34/72/3472bdb6cca2aa187527826682eab58cc648e6de.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eSet \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003c/span\u003e is a set of vertices in the subtree of vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003c/span\u003e, and set \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eB\u003c/i\u003e\u003c/span\u003e is a set of vertices which is not in the subtree of vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003c/span\u003e. So, \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/50/5e/505ed014997a8944b7c7fa15eb543683b5c2882a.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e is the set of vertices in the tree, and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/a9/73/a9736ea37538636dd5373dd1450f862ea87e50c0.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e is empty.\u003c/p\u003e\u003cp\u003eFor all pairs of two vertices \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e where the condition \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/e4/5a/e45a074c88e41265bf0219586f4f1d6856bace4d.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/77/d5/77d55ab7e7b5ba02c76e59ebe07e9234f9737b27.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e holds, the shortest path between \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ey\u003c/i\u003e\u003c/span\u003e contains edge \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ee\u003c/i\u003e\u003c/span\u003e. There are \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003esize\u003c/i\u003e(\u003ci\u003eA\u003c/i\u003e) × \u003ci\u003esize\u003c/i\u003e(\u003ci\u003eB\u003c/i\u003e)\u003c/span\u003e such pairs. So, edge \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ee\u003c/i\u003e\u003c/span\u003e increases the sum \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003c/span\u003e by \u003cspan class\u003d\"tex-span\"\u003e2 × \u003ci\u003el\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ee\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003esize\u003c/i\u003e(\u003ci\u003eA\u003c/i\u003e) × \u003ci\u003esize\u003c/i\u003e(\u003ci\u003eB\u003c/i\u003e)\u003c/span\u003e. (because \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e(\u003ci\u003ey\u003c/i\u003e, \u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e both contributes to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003c/span\u003e)\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003esize\u003c/i\u003e(\u003ci\u003eA\u003c/i\u003e)\u003c/span\u003e (the size of the subtree whose root is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003c/span\u003e) can be calculated by dynamic programming in trees, which is well known. \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003esize\u003c/i\u003e(\u003ci\u003eB\u003c/i\u003e)\u003c/span\u003e equals to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e - \u003ci\u003esize\u003c/i\u003e(\u003ci\u003eA\u003c/i\u003e)\u003c/span\u003e. \u003c/p\u003e\u003cp\u003eSo, for each edge \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ee\u003c/i\u003e\u003c/span\u003e, we can pre-calculate how many times does this edge contributes to the total sum. Let\u0027s define \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e(\u003ci\u003ee\u003c/i\u003e) \u003d \u003ci\u003esize\u003c/i\u003e(\u003ci\u003eA\u003c/i\u003e) × \u003ci\u003esize\u003c/i\u003e(\u003ci\u003eB\u003c/i\u003e)\u003c/span\u003e, (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eB\u003c/i\u003e\u003c/span\u003e is mentioned above). If the length of a certain road \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ee\u003c/i\u003e\u003c/span\u003e decreases by \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003c/span\u003e will decrease by \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e(\u003ci\u003ee\u003c/i\u003e) × \u003ci\u003ed\u003c/i\u003e\u003c/span\u003e. So we can answer each query.\u003c/p\u003e \u003cul\u003e   \u003cli\u003eTime: \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e)\u003c/span\u003e (pre-calculation) + \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003eq\u003c/i\u003e)\u003c/span\u003e (query)\u003c/li\u003e   \u003cli\u003eMemory: \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e)\u003c/span\u003e (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e + \u003ci\u003eq\u003c/i\u003e)\u003c/span\u003e is okay too)\u003c/li\u003e   \u003cli\u003eImplementation: \u003ca href\u003d\"/contest/500/submission/9335695\" title\u003d\"Submission 9335695 by .o.\"\u003e9335695\u003c/a\u003e (\u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/tncks0121\" title\u003d\"International master tncks0121\"\u003etncks0121\u003c/a\u003e)\u003c/li\u003e \u003c/ul\u003e\u003ch4\u003eSomething about precision error\u003c/h4\u003e\u003cp\u003eBecause of the tight constraints, the total sum of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e(\u003ci\u003ea\u003c/i\u003e, \u003ci\u003eb\u003c/i\u003e) + \u003ci\u003ed\u003c/i\u003e(\u003ci\u003eb\u003c/i\u003e, \u003ci\u003ec\u003c/i\u003e) + \u003ci\u003ed\u003c/i\u003e(\u003ci\u003ec\u003c/i\u003e, \u003ci\u003ea\u003c/i\u003e)\u003c/span\u003e (it is equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e × (\u003ci\u003en\u003c/i\u003e - 2)\u003c/span\u003e) can be so large that it can\u0027t be saved in \u003ccode\u003elong long\u003c/code\u003e(64-bit integer) type. Some contestants didn\u0027t handle this and got WA. \u003c/p\u003e\u003cp\u003eHowever, there are some contestants who saved this value divided by \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e × (\u003ci\u003en\u003c/i\u003e - 1) × (\u003ci\u003en\u003c/i\u003e - 2)\u003c/span\u003e in \u003ccode\u003edouble\u003c/code\u003e type. \u003ccode\u003edouble\u003c/code\u003e has 52 bits to store exact value, so it isn\u0027t enough. But because we allow \u003cspan class\u003d\"tex-span\"\u003e10\u003csup class\u003d\"upper-index\"\u003e - 6\u003c/sup\u003e\u003c/span\u003e precision error, it seems to have been got accepted.\u003c/p\u003e\u003cp\u003eWhat if we allowed the length of the road could become 0? Then the precision error gets much more bigger, and the solution prints something that is far from the expected value (for example, negative value). \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/ainu7\" title\u003d\"Grandmaster ainu7\"\u003eainu7\u003c/a\u003e discovered this effect and suggested to apply this, but we didn\u0027t because it was hard to fix the statement..\u003c/p\u003e\u003ch4\u003eWhy does the road length decreases? It doesn\u0027t matter even if increases.\u003c/h4\u003e\u003cp\u003eIt\u0027s because of the weird legend. It is hard to explain, \u0026quot;People repairs a certain road per year, and its length may be increased or decreased.\u0026quot; fluently for me..\u003c/p\u003e\u003ch2\u003e\u003ca href\u003d\"/contest/500/problem/E\" title\u003d\"Good Bye 2014\"\u003e500E - New Year Domino\u003c/a\u003e\u003c/h2\u003e\u003cp\u003eFrom the statement, it is clear that, when domino \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e falls to the right, it makes domino \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e also fall if and only if \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e \u0026lt; \u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e ≤ \u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e + \u003ci\u003el\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eFor each domino \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e, let\u0027s calculate the rightmost position of the fallen dominoes \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eR\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e]\u003c/span\u003e when we initially pushed domino \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e. From the definition, \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/46/95/469503331efeecca3ecd84b29c4fa26e6eb268ab.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. This can be calculated by using a segment tree or using a stack, in decreasing order of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e (from right to left). After that, we define \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eU\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e]\u003c/span\u003e as the smallest \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eR\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e] \u0026lt; \u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e holds. (In other words, the smallest \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e where domino \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e is not affected by pushing domino \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e)\u003c/p\u003e\u003cp\u003eNow, the problem becomes: Calculate \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eP\u003c/i\u003e[\u003ci\u003eU\u003c/i\u003e[\u003ci\u003ex\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e]] - \u003ci\u003eR\u003c/i\u003e[\u003ci\u003ex\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e] + \u003ci\u003eP\u003c/i\u003e[\u003ci\u003eU\u003c/i\u003e[\u003ci\u003eU\u003c/i\u003e[\u003ci\u003ex\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e]]] - \u003ci\u003eR\u003c/i\u003e[\u003ci\u003eU\u003c/i\u003e[\u003ci\u003ex\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e]] + ...\u003c/span\u003e, until \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eU\u003c/i\u003e[\u003ci\u003ex\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e] ≤ \u003ci\u003ey\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e. Because \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e \u0026lt; \u003ci\u003eU\u003c/i\u003e[\u003ci\u003ei\u003c/i\u003e]\u003c/span\u003e, this task can be solved by precalculating \u0027jumps\u0027 of \u003cspan class\u003d\"tex-span\"\u003e2\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003esomething\u003c/i\u003e\u003c/sup\u003e\u003c/span\u003e times, using the method described in \u003ca href\u003d\"https://www.topcoder.com/tc?module\u003dStatic\u0026amp;d1\u003dtutorials\u0026amp;d2\u003dlowestCommonAncestor\"\u003ehere\u003c/a\u003e. You must read the \u0026quot;Another easy solution in \u0026lt;O(N logN, O(logN)\u0026gt;\u0026quot; part..\u003c/p\u003e\u003cp\u003eFormally, let\u0027s define \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eU\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003en\u003c/i\u003e + 1\u003c/sup\u003e[\u003ci\u003ek\u003c/i\u003e] \u003d \u003ci\u003eU\u003c/i\u003e[\u003ci\u003eU\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/sup\u003e[\u003ci\u003ek\u003c/i\u003e]]\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003en\u003c/i\u003e + 1\u003c/sup\u003e[\u003ci\u003ek\u003c/i\u003e] \u003d \u003ci\u003eS\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/sup\u003e[\u003ci\u003ek\u003c/i\u003e] + (\u003ci\u003eP\u003c/i\u003e[\u003ci\u003eU\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003en\u003c/i\u003e + 1\u003c/sup\u003e[\u003ci\u003ek\u003c/i\u003e]] - \u003ci\u003eR\u003c/i\u003e[\u003ci\u003eU\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/sup\u003e[\u003ci\u003ek\u003c/i\u003e]])\u003c/span\u003e. So, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/sup\u003e[\u003ci\u003ek\u003c/i\u003e]\u003c/span\u003e means the sum of domino length extensions when we initially push domino \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e and we prolonged the length exactly \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/span\u003e times. \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eU\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ei\u003c/i\u003e + 1\u003c/sup\u003e\u003c/sup\u003e[\u003ci\u003ek\u003c/i\u003e] \u003d \u003ci\u003eU\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sup\u003e\u003c/sup\u003e[\u003ci\u003eU\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sup\u003e\u003c/sup\u003e[\u003ci\u003ek\u003c/i\u003e]]\u003c/span\u003e, and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ei\u003c/i\u003e + 1\u003c/sup\u003e\u003c/sup\u003e[\u003ci\u003ek\u003c/i\u003e] \u003d \u003ci\u003eS\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sup\u003e\u003c/sup\u003e[\u003ci\u003ek\u003c/i\u003e] + \u003ci\u003eS\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sup\u003e\u003c/sup\u003e[\u003ci\u003eU\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sup\u003e\u003c/sup\u003e[\u003ci\u003ek\u003c/i\u003e]]\u003c/span\u003e holds. (If you don\u0027t understand this part, I suggest you to read the article linked above)\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003cstrong\u003eTime\u003c/strong\u003e : \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/14/7a/147aeb6f7fe66aa5af5614567e39ba17d7ba345d.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e or \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/97/cc/97cc51250e7be67d02153c4f9bffbb28ebab59ce.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/li\u003e   \u003cli\u003e\u003cstrong\u003eMemory\u003c/strong\u003e : \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/e7/0f/e70fbdc8079c0b9ff4f31073012937bac199bc6b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/li\u003e   \u003cli\u003e\u003cstrong\u003eImplementation\u003c/strong\u003e: \u003ca href\u003d\"/contest/500/submission/9335698\" title\u003d\"Submission 9335698 by .o.\"\u003e9335698\u003c/a\u003e (\u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/tncks0121\" title\u003d\"International master tncks0121\"\u003etncks0121\u003c/a\u003e)\u003c/li\u003e   \u003cli\u003eWe would like to know whether there is a linear offline solution or not.\u003c/li\u003e \u003c/ul\u003e\u003ch2\u003e\u003ca href\u003d\"/contest/500/problem/F\" title\u003d\"Good Bye 2014\"\u003e500F - New Year Shopping\u003c/a\u003e\u003c/h2\u003e \u003cp\u003eThe \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e-th item is available during \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e, \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e + \u003ci\u003ep\u003c/i\u003e - 1]\u003c/span\u003e. In other words, at time \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e, item \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e is available if and only if \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e ≤ \u003ci\u003eT\u003c/i\u003e ≤ \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e + \u003ci\u003ep\u003c/i\u003e - 1\u003c/span\u003e. This can be re-written as (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e ≤ \u003ci\u003eT\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e - \u003ci\u003ep\u003c/i\u003e + 1 ≤ \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e), which is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e - \u003ci\u003ep\u003c/i\u003e + 1 ≤ \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e ≤ \u003ci\u003eT\u003c/i\u003e\u003c/span\u003e. With this observation, we can transform the item\u0027s purchasable range into a dot, and the candidate\u0027s visit time into a range: From now on, item \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e is only available at time \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e. and each candidate pair \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e, \u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e means that I can visit the store during \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e - \u003ci\u003ep\u003c/i\u003e + 1, \u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e]\u003c/span\u003e, and my budget is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e dollars at that visit. This transformation makes the problem easier to solve.\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/4b/c4/4bc4e1e848ff1b470df1ac7177c132d7f9e16fbf.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eEach red circled point denotes an item which is sold at that time, and each black interval denotes a candidate. Let\u0027s only consider the intervals which passes time \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e. All the intervals\u0027 length is exactly \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e, so the left bound of the interval is \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eT\u003c/i\u003e - \u003ci\u003ep\u003c/i\u003e)\u003c/span\u003e and the right bound of the interval is \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eT\u003c/i\u003e + \u003ci\u003ep\u003c/i\u003e)\u003c/span\u003e. \u003c/p\u003e\u003cp\u003eFor each interval, we\u0027d like to solve the 0/1 knapsack algorithm with the items that the interval contains. How can we do that effectively? There is an important fact that I\u0027ve described above: all the interval passes time \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e. Therefore, the interval \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e - \u003ci\u003ep\u003c/i\u003e + 1, \u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e]\u003c/span\u003e can be split into two intervals: \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e - \u003ci\u003ep\u003c/i\u003e + 1, \u003ci\u003eT\u003c/i\u003e - 1]\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003eT\u003c/i\u003e, \u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e]\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eSo, let\u0027s solve the 0/1 knapsack problem for all intervals \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003ex\u003c/i\u003e, \u003ci\u003eT\u003c/i\u003e - 1]\u003c/span\u003e (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e - \u003ci\u003ep\u003c/i\u003e ≤ \u003ci\u003ex\u003c/i\u003e ≤ \u003ci\u003eT\u003c/i\u003e - 1\u003c/span\u003e) and \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003eT\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e]\u003c/span\u003e (\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e ≤ \u003ci\u003ey\u003c/i\u003e ≤ \u003ci\u003eT\u003c/i\u003e + \u003ci\u003ep\u003c/i\u003e\u003c/span\u003e). Because one of the endpoints is fixed, one can run a standard dynamic programming algorithm. Therefore, the time needed in precalculation is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003eS\u003c/i\u003e × \u003ci\u003eW\u003c/i\u003e)\u003c/span\u003e, where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003c/span\u003e is the number of items where the condition \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/8e/0a/8e0a93d74d7a97cf43b9973a4fc2383ad64f5aaf.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e holds.\u003c/p\u003e\u003cp\u003eLet\u0027s define \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e(\u003ci\u003eI\u003c/i\u003e, \u003ci\u003eb\u003c/i\u003e)\u003c/span\u003e, as the maximum happiness I can obtain by buying the items where the condition \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/32/b5/32b523354ce6ca7fbc0ef31c2ee2b907d7697c9d.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e holds, using at most \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003c/span\u003e dollars. For each candidate \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e, \u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e, we have to calculate \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e([\u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e - \u003ci\u003ep\u003c/i\u003e + 1, \u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e], \u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e, which is equal to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emax\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e0 ≤ \u003ci\u003ek\u003c/i\u003e ≤ \u003ci\u003eb\u003c/i\u003e\u003c/sub\u003e{\u003ci\u003eh\u003c/i\u003e([\u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e - \u003ci\u003ep\u003c/i\u003e + 1, \u003ci\u003eT\u003c/i\u003e - 1], \u003ci\u003ek\u003c/i\u003e) + \u003ci\u003eh\u003c/i\u003e([\u003ci\u003eT\u003c/i\u003e, \u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e], \u003ci\u003eb\u003c/i\u003e - \u003ci\u003ek\u003c/i\u003e)}\u003c/span\u003e. So it takes \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e) \u003d \u003ci\u003eO\u003c/i\u003e(\u003ci\u003eW\u003c/i\u003e)\u003c/span\u003e time to solve each query.\u003c/p\u003e\u003cp\u003eThe only question left is: How should we choose the value of \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e? We have two facts. (1) The length of intervals is exactly \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e. (2) The algorithm covers intervals which passes time \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e. Therefore, to cover all the intervals given in the input, we should let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e be \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e, 2\u003ci\u003ep\u003c/i\u003e, 3\u003ci\u003ep\u003c/i\u003e, 4\u003ci\u003ep\u003c/i\u003e, ...\u003c/span\u003e (of course, one by one), and run the algorithm described above.\u003c/p\u003e\u003cp\u003eThen, what is the total time complexity? Think of intervals \u003cspan class\u003d\"tex-span\"\u003e[0, 2\u003ci\u003ep\u003c/i\u003e], [\u003ci\u003ep\u003c/i\u003e, 3\u003ci\u003ep\u003c/i\u003e], [2\u003ci\u003ep\u003c/i\u003e, 4\u003ci\u003ep\u003c/i\u003e], [3\u003ci\u003ep\u003c/i\u003e, 5\u003ci\u003ep\u003c/i\u003e], ...\u003c/span\u003e. For each point, there will be at most two intervals which contains the point. Therefore, each item is reflected in the pre-calculation at most twice, so the time needed to precalculate is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e × \u003ci\u003eW\u003c/i\u003e)\u003c/span\u003e. The time needed to solve each query is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e, and the answer of the query is calculated at most once. Therefore, the time needed to answer all the queries is \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003eq\u003c/i\u003e × \u003ci\u003eW\u003c/i\u003e\u003c/span\u003e).\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003cstrong\u003eTime\u003c/strong\u003e : \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e((\u003ci\u003en\u003c/i\u003e + \u003ci\u003eq\u003c/i\u003e) × \u003ci\u003eW\u003c/i\u003e)\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003e\u003cstrong\u003eMemory\u003c/strong\u003e : \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e × \u003ci\u003eW\u003c/i\u003e)\u003c/span\u003e\u003c/li\u003e   \u003cli\u003e\u003cstrong\u003eImplementations\u003c/strong\u003e: \u003ca href\u003d\"/contest/500/submission/9335699\" title\u003d\"Submission 9335699 by .o.\"\u003e9335699\u003c/a\u003e (\u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/ainta\" title\u003d\"Master ainta\"\u003eainta\u003c/a\u003e), \u003ca href\u003d\"/contest/500/submission/9335703\" title\u003d\"Submission 9335703 by .o.\"\u003e9335703\u003c/a\u003e (\u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/ainu7\" title\u003d\"Grandmaster ainu7\"\u003eainu7\u003c/a\u003e) , \u003ca href\u003d\"/contest/500/submission/9335710\" title\u003d\"Submission 9335710 by .o.\"\u003e9335710\u003c/a\u003e (\u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/tncks0121\" title\u003d\"International master tncks0121\"\u003etncks0121\u003c/a\u003e, using a different approach), \u003ca href\u003d\"/contest/500/submission/9335709\" title\u003d\"Submission 9335709 by .o.\"\u003e9335709\u003c/a\u003e (\u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/tncks0121\" title\u003d\"International master tncks0121\"\u003etncks0121\u003c/a\u003e, using a divide and conquer approach)\u003c/li\u003e \u003c/ul\u003e\u003ch4\u003eDivide and Conquer approach\u003c/h4\u003e\u003cp\u003eLet\u0027s assume that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e ≤ \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e ≤ ... ≤ \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003en\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e. We can easily know that at time \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e, the indexes of all the available items forms a segment \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e, \u003ci\u003er\u003c/i\u003e]\u003c/span\u003e. (in other words, item \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e, item \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e + 1\u003c/span\u003e, ..., item \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e - 1\u003c/span\u003e, item \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e is available) We can use this fact to solve all the queries. Let\u0027s assume that item \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e, item \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e + 1\u003c/span\u003e, ..., item \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e - 1\u003c/span\u003e, item \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e is available at time \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eDefine a function \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003esolve\u003c/i\u003e(\u003ci\u003eL\u003c/i\u003e, \u003ci\u003eR\u003c/i\u003e)\u003c/span\u003e. This function calculates the answer for queries where the condition \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eL\u003c/i\u003e ≤ \u003ci\u003el\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e ≤ \u003ci\u003er\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e ≤ \u003ci\u003eR\u003c/i\u003e\u003c/span\u003e holds. Let\u0027s assume that \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eL\u003c/i\u003e \u0026lt; \u003ci\u003eR\u003c/i\u003e\u003c/span\u003e holds. (In the case \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eL\u003c/i\u003e ≥ \u003ci\u003eR\u003c/i\u003e\u003c/span\u003e, the answer can be calculated easily) Let \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/03/0f/030f73f9782c13a7f13547dfe8cec38793524b7d.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Call \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003esolve\u003c/i\u003e(\u003ci\u003eL\u003c/i\u003e, \u003ci\u003eM\u003c/i\u003e)\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003esolve\u003c/i\u003e(\u003ci\u003eM\u003c/i\u003e + 1, \u003ci\u003eR\u003c/i\u003e)\u003c/span\u003e. After that, the queries needed to be calculated, satisfies the condition \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e ≤ \u003ci\u003eM\u003c/i\u003e \u0026lt; \u003ci\u003er\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e, which means all the intervals(queries) passes item \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eM\u003c/i\u003e\u003c/span\u003e. Now, to calculate the answer for such queries, we can use the method described at the dynamic programming approach.\u003c/p\u003e\u003cp\u003eThe time complexity is \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/a3/9a/a39a7d77e5b4fbbed32ec231fe227dfd47e7c4f1.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, because \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/3e/a3/3ea34ddaf45af758ef52b1dd6aa2bff91e3857bd.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and the answer of the queries can be calculated in \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003eb\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e per query.\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003cstrong\u003eTime\u003c/strong\u003e : \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/b9/90/b990a1133413b11e736518c6086ce6d4ab43d785.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/li\u003e   \u003cli\u003e\u003cstrong\u003eMemory\u003c/strong\u003e : \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003en\u003c/i\u003e × \u003ci\u003eW\u003c/i\u003e)\u003c/span\u003e\u003c/li\u003e   \u003cli\u003e\u003cstrong\u003eImplementation\u003c/strong\u003e: \u003ca href\u003d\"/contest/500/submission/9335709\" title\u003d\"Submission 9335709 by .o.\"\u003e9335709\u003c/a\u003e\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eUnfortunately, this approach is offline, because of the memory. Is there any available online approach using divide and conquer?\u003c/p\u003e\u003ch4\u003eBlocking the divide and conquer solution\u003c/h4\u003e\u003cp\u003eI tried my best to block divide and conquer solutions, but failed. It seems that many participants solved the problem with divide and conquer approach. My approach takes \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/f8/f6/f8f6737eeb47def498b122cc659455d4ea365394.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e time, and it gets accepted in 546ms.\u003c/p\u003e\u003ch2\u003e\u003ca href\u003d\"/contest/500/problem/G\" title\u003d\"Good Bye 2014\"\u003e500G - New Year Running\u003c/a\u003e\u003c/h2\u003e\u003cp\u003eBefore starting the editorial, I\u0027d like to give a big applause to \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/marcin_smu\" title\u003d\"Grandmaster marcin_smu\"\u003emarcin_smu\u003c/a\u003e, who solved the problem for the first time!\u003c/p\u003e\u003cp\u003e\u003cstrong\u003e\u003cem\u003eWarning\u003c/em\u003e\u003c/strong\u003e: The editorial is very long and has many mistakes. There are lots of lots of mistakes.. Keep calm, and please tell me by comments, if you discovered any errors.\u003c/p\u003e\u003cp\u003eThis problem can be solved by an online algorithm. Let\u0027s focus on a single query \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e, \u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e. This means that JH runs between \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ev\u003c/i\u003e\u003c/span\u003e, and JY runs between \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ey\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eJust like when we solve many problems with undirected trees, let vertex 1 be the root of the tree. Also, we will assume that they won\u0027t stop after when they meet, but they will continue running, in order to explain easily.\u003c/p\u003e\u003cp\u003eSome definitions:\u003c/p\u003e \u003cul\u003e   \u003cli\u003ePath \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ea\u003c/i\u003e, \u003ci\u003eb\u003c/i\u003e)\u003c/span\u003e: the shortest \u003cem\u003epath\u003c/em\u003e between vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/span\u003e and vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e(\u003ci\u003ea\u003c/i\u003e, \u003ci\u003eb\u003c/i\u003e)\u003c/span\u003e: the \u003cem\u003elength\u003c/em\u003e of Path \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ea\u003c/i\u003e, \u003ci\u003eb\u003c/i\u003e)\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eLCA\u003c/i\u003e(\u003ci\u003ea\u003c/i\u003e, \u003ci\u003eb\u003c/i\u003e)\u003c/span\u003e: the \u003cem\u003elowest common ancestor\u003c/em\u003e of vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/span\u003e and vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eb\u003c/i\u003e\u003c/span\u003e.\u003c/li\u003e \u003c/ul\u003e\u003ch3\u003eFinding the common path of two paths\u003c/h3\u003e\u003cp\u003eIf there is no common vertex between Path \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e and Path \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e, the answer will be obviously \u003cspan class\u003d\"tex-span\"\u003e - 1\u003c/span\u003e. So, let\u0027s find the common vertices first. Because the path between two vertices is always unique, the common vertices also form a path. So, I\u0027ll denote the path of the common vertices as Path \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e)\u003c/span\u003e. \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e may be equal to: \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ev\u003c/i\u003e\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ey\u003c/i\u003e\u003c/span\u003e, and even each other.\u003c/p\u003e\u003cp\u003eThe possible endpoints are \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eP\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e \u003d \u003ci\u003eLCA\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eP\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e \u003d \u003ci\u003eLCA\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eP\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e3\u003c/sub\u003e \u003d \u003ci\u003eLCA\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eP\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e4\u003c/sub\u003e \u003d \u003ci\u003eLCA\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eP\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e5\u003c/sub\u003e \u003d \u003ci\u003eLCA\u003c/i\u003e(\u003ci\u003ev\u003c/i\u003e, \u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e, and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eP\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e6\u003c/sub\u003e \u003d \u003ci\u003eLCA\u003c/i\u003e(\u003ci\u003ev\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e. Figure out by drawing some examples. (some of you might think it\u0027s obvious :D)\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/71/24/7124b4c6405dec22c7fb8fe05bb1309011b3373f.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/b1/28/b128eb2a49a63b4ad2ed5552b280a18bd44fcf1e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eSee the pictures above, and make your own criteria to check whether the two paths intersects :D\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/d9/52/d952788dbae784f1ccde4aa2c8717b463ee2bbde.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eA small hint. Let\u0027s assume that we already know, that a vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/span\u003e lies on path \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ex\u003c/i\u003e, \u003ci\u003ey\u003c/i\u003e)\u003c/span\u003e. If \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/span\u003e lies on path \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/span\u003e is a common vertex of two paths. What if \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/span\u003e is guaranteed to be an end point of the common path?\u003c/p\u003e\u003ch3\u003eAdditional definitions\u003c/h3\u003e \u003cul\u003e   \u003cli\u003eLet\u0027s denote JH\u0027s running course is: \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/23/2a/232ab52b38fbeadc4f305fe3660b2c4f4a5a58d3.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Then, there are two possible courses for JY: \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/94/b4/94b42185f26d6ea42b94bccfc39a815390c88838.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/89/41/8941614ebe4f47bfb78fa1f4feebd061f6d79fcd.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e).\u003c/li\u003e \u003c/ul\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/24/80/248001bf191486e9cfa8f402708c65c580f2e883.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/09/a7/09a7c65ec8736caa49fd4da81b2678a8a93adcd9.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJH\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e : the time needed to run the course \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/39/2e/392e84c96e76e362f24c53d8c60076004064a40c.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/li\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJY\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e : the time needed to run the course \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/75/27/752716d2103ab5199e417e9783dc9f8c8d2fb0ff.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/li\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e : the first time when JH passes vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e, moving towards \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e : the first time when JH passes vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e, moving towards \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e3\u003c/sub\u003e\u003c/span\u003e : the first time when JY passes vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e, moving towards \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e4\u003c/sub\u003e\u003c/span\u003e : the first time when JY passes vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e, moving towards \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e.\u003c/li\u003e \u003c/ul\u003e\u003ch3\u003eCase 1) When JH and JY meets while moving in the same direction\u003c/h3\u003e\u003cp\u003eObviously, they must meet at vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e or vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e for the first time. Without loss of generality, let\u0027s assume that they meet at vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e. In this case, both of them is moving towards vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e. (You can use the method similarly for \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e) \u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/db/ce/dbceda7dafec567d1d5f1def971bbd5b8ec107be.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eLet\u0027s assume that JH and JY meets at time \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e. Because the movements of both runners are periodic, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e must satisfy the conditions below:\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/3f/7e/3f7e3a2799100791a1efe4c04d1b2bd3d1a07cde.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/li\u003e   \u003cli\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/5c/a9/5ca981fa7f0578d2fd6bce6373947dae3682c51f.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eAmong possible \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e-s, we have to calculate the smallest value. How should we do? From the first condition, we can let \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e \u003d \u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJH\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003ep\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e, where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e is a non-negative integer. With this, we can write the second condition as: \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/f1/fc/f1fcf3653d62400d96af668d9810d6d66bdce04e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. In conclusion, we have to find the smallest \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e which satisfies the condition\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/c9/f6/c9f69471acee0471cd3bc108b4995b07579fffe8.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eUsing the \u003ca href\u003d\"http://en.wikipedia.org/wiki/Extended_Euclidean_algorithm\"\u003eExtended Euclidean algorithm\u003c/a\u003e is enough to calculate the minimum \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e. With \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e, we can easily calculate the minimum \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e, which is the first time they meet. If there is no such \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e, they doesn\u0027t meet forever, so the answer is \u003cspan class\u003d\"tex-span\"\u003e - 1\u003c/span\u003e.\u003c/p\u003e\u003ch3\u003eCase 2) When JH and JY meets while moving in the opposite direction\u003c/h3\u003e\u003cp\u003eIn this case, they will meet at a vertex lying on Path \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e)\u003c/span\u003e. Without loss of generality, let\u0027s assume that JH is going from \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e, and JY is going from \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e to \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/3e/cf/3ecfe83ff84f8bd622e272b95925370a73573f44.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eI\u0027ll assume that JH and JY meets at time \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e. \u003c/p\u003e\u003cp\u003e[1] Let\u0027s see how JH moves: For all non-negative integer \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e, \u003c/p\u003e \u003col\u003e   \u003cli\u003eAt time \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJH\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003ep\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e, he is at vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e, moving towards \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003eAt time \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJH\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003ep\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e + \u003ci\u003ed\u003c/i\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e)\u003c/span\u003e, he is at vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e.\u003c/li\u003e \u003c/ol\u003e\u003cp\u003eTherefore, when \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJH\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003ep\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e ≤ \u003c/span\u003e \u003cem\u003e(current time)\u003c/em\u003e \u003cspan class\u003d\"tex-span\"\u003e ≤ \u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJH\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003ep\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e + \u003ci\u003ed\u003c/i\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e)\u003c/span\u003e, JH is on Path \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e)\u003c/span\u003e. So, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e must satisfy the condition:\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJH\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003ep\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e ≤ \u003ci\u003eT\u003c/i\u003e ≤ \u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJH\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003ep\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e + \u003ci\u003ed\u003c/i\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e)\u003c/span\u003e\u003c/li\u003e \u003c/ul\u003e\u003cp\u003e[2] Let\u0027s see how JY moves: Similar to JH, for all non-negative integer \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eq\u003c/i\u003e\u003c/span\u003e,\u003c/p\u003e \u003col\u003e   \u003cli\u003eAt time \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJY\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003eq\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e4\u003c/sub\u003e\u003c/span\u003e, he is at vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e\u003c/span\u003e, moving towards \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003eAt time \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJY\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003eq\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e4\u003c/sub\u003e + \u003ci\u003ed\u003c/i\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e)\u003c/span\u003e, he is at vertex \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e\u003c/span\u003e.\u003c/li\u003e \u003c/ol\u003e\u003cp\u003eTherefore, when \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJY\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003eq\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e4\u003c/sub\u003e ≤ \u003c/span\u003e \u003cem\u003e(current time)\u003c/em\u003e \u003cspan class\u003d\"tex-span\"\u003e ≤ \u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJY\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003eq\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e4\u003c/sub\u003e + \u003ci\u003ed\u003c/i\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e)\u003c/span\u003e, JY is on Path \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e)\u003c/span\u003e. So, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e must satisfy the condition:\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJY\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003eq\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e4\u003c/sub\u003e ≤ \u003ci\u003eT\u003c/i\u003e ≤ \u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJY\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003eq\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e4\u003c/sub\u003e + \u003ci\u003ed\u003c/i\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e)\u003c/span\u003e\u003c/li\u003e \u003c/ul\u003e\u003cp\u003e[3] These two conditions are not enough, because in this case, they can meet on an \u003cem\u003eedge\u003c/em\u003e, but they cannot meet on a \u003cem\u003evertex\u003c/em\u003e.\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/71/ce/71ce072b24f5052cdfa5170e155e5b2a6db4ee78.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eWe\u0027d like to know when do they meet on a \u003cem\u003evertex\u003c/em\u003e, like the picture below.\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/91/5a/915af3a05b2aa407d10179180dcf2747ec87cd43.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eAs you see from the picture above, in this case, the condition \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ea\u003c/i\u003e) + \u003ci\u003ed\u003c/i\u003e(\u003ci\u003ea\u003c/i\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e) \u003d \u003ci\u003ed\u003c/i\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e)\u003c/span\u003e holds. If this picture was taken at time \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e\u003c/span\u003e, this condition can be written as: \u003c/p\u003e \u003ccenter\u003e \u003cspan class\u003d\"tex-span\"\u003e{\u003ci\u003es\u003c/i\u003e - (\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJH\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003ep\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e)} + {\u003ci\u003es\u003c/i\u003e - (\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJY\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003eq\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e4\u003c/sub\u003e)} \u003d \u003ci\u003ed\u003c/i\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e)\u003c/span\u003e\u003cbr /\u003e \u003cspan class\u003d\"tex-span\"\u003e2\u003ci\u003es\u003c/i\u003e - (\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJH\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003ep\u003c/i\u003e + \u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJY\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003eq\u003c/i\u003e) - (\u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e4\u003c/sub\u003e) \u003d \u003ci\u003ed\u003c/i\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e)\u003c/span\u003e\u003cbr /\u003e \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e \u003d {\u003ci\u003ed\u003c/i\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e) + (\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJH\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003ep\u003c/i\u003e + \u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJY\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003eq\u003c/i\u003e) + (\u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e4\u003c/sub\u003e)} / 2\u003c/span\u003e \u003c/center\u003e\u003cp\u003eBecause JH and JY both travel their path back and forth, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJH\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e and \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJY\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e are all even. Therefore, in order to make \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e\u003c/span\u003e an integer, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ed\u003c/i\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e) + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e4\u003c/sub\u003e\u003c/span\u003e must be even. This can be written as \u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/1e/88/1e882db800ae4f6e555b9f68660c16f31997a0d6.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/li\u003e \u003c/ul\u003e\u003cp\u003e[4] Merging [1], [2] and [3], we can conclude that if these two conditions holds,\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/10/6d/106d5495201f88ab8478f9a08f6d4c1f18cb1f20.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/li\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emax\u003c/i\u003e{\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJH\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003ep\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJY\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003eq\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e4\u003c/sub\u003e} ≤ \u003ci\u003emin\u003c/i\u003e{\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJH\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003ep\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e + \u003ci\u003ed\u003c/i\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e), \u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJY\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003ep\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e4\u003c/sub\u003e + \u003ci\u003ed\u003c/i\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e)}\u003c/span\u003e\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eJH and JY meets on a certain vertex lying on path \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e, \u003ci\u003ec\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e2\u003c/sub\u003e)\u003c/span\u003e. The first condition can be easily checked, so let\u0027s focus on the second condition. The second condition holds if and only if:\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJY\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003eq\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e4\u003c/sub\u003e - \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e - \u003ci\u003ed\u003c/i\u003e ≤ \u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJH\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003ep\u003c/i\u003e ≤ \u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJY\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003eq\u003c/i\u003e + \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e4\u003c/sub\u003e - \u003ci\u003et\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e + \u003ci\u003ed\u003c/i\u003e\u003c/span\u003e\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eYou can check this by changing \u0026quot;\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003eJH\u003c/i\u003e\u003c/sub\u003e × \u003ci\u003ep\u003c/i\u003e\u003c/span\u003e\u0026quot; to the lower bound and the upper bound of the inequality. Therefore, the problem is to find the smallest \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e which satisfies the condition above.\u003c/p\u003e\u003cp\u003eLet\u0027s define a function \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(\u003ci\u003eM\u003c/i\u003e, \u003ci\u003eD\u003c/i\u003e, \u003ci\u003eL\u003c/i\u003e, \u003ci\u003eR\u003c/i\u003e)\u003c/span\u003e, where \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eM\u003c/i\u003e, \u003ci\u003eD\u003c/i\u003e, \u003ci\u003eL\u003c/i\u003e, \u003ci\u003eR\u003c/i\u003e\u003c/span\u003e are all non-negative integers. The function returns the smallest non-negative integer \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e which satisfies \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/c1/fa/c1fa0bf88411dc81deb1b722e08fe09363052a07.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. This function can be implemented as follows.\u003c/p\u003e \u003col\u003e   \u003cli\u003eIf \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eL\u003c/i\u003e \u003d 0\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(\u003ci\u003eM\u003c/i\u003e, \u003ci\u003eD\u003c/i\u003e, \u003ci\u003eL\u003c/i\u003e, \u003ci\u003eR\u003c/i\u003e) \u003d 0\u003c/span\u003e. (because \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eL\u003c/i\u003e \u003d 0 ≤ \u003ci\u003eD\u003c/i\u003e·0\u003c/span\u003e)\u003c/li\u003e   \u003cli\u003eIf \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/f6/4a/f64af6bd0952974517a84b0df7172a9ac926f5d1.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, it is \u0026quot;obvious\u0026quot; that there is no solution.\u003c/li\u003e   \u003cli\u003eIf \u003cspan class\u003d\"tex-span\"\u003e2\u003ci\u003eD\u003c/i\u003e \u0026gt; \u003ci\u003eM\u003c/i\u003e\u003c/span\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(\u003ci\u003eM\u003c/i\u003e, \u003ci\u003eD\u003c/i\u003e, \u003ci\u003eL\u003c/i\u003e, \u003ci\u003eR\u003c/i\u003e) \u003d \u003ci\u003eg\u003c/i\u003e(\u003ci\u003eM\u003c/i\u003e, \u003ci\u003eM\u003c/i\u003e - \u003ci\u003eD\u003c/i\u003e, \u003ci\u003eM\u003c/i\u003e - \u003ci\u003eR\u003c/i\u003e, \u003ci\u003eM\u003c/i\u003e - \u003ci\u003eL\u003c/i\u003e)\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003eIf there exists an non-negative integer \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e which satisfies \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eL\u003c/i\u003e ≤ \u003ci\u003eD\u003c/i\u003e·\u003ci\u003em\u003c/i\u003e ≤ \u003ci\u003eR\u003c/i\u003e\u003c/span\u003e (without modular condition), \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(\u003ci\u003eM\u003c/i\u003e, \u003ci\u003eD\u003c/i\u003e, \u003ci\u003eL\u003c/i\u003e, \u003ci\u003eR\u003c/i\u003e) \u003d \u003ci\u003em\u003c/i\u003e\u003c/span\u003e. Obviously, we should take the smallest \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e.\u003c/li\u003e   \u003cli\u003eOtherwise, there exists an integer \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003em\u003c/i\u003e\u003c/span\u003e which satisfies \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eD\u003c/i\u003e·\u003ci\u003em\u003c/i\u003e \u0026lt; \u003ci\u003eL\u003c/i\u003e ≤ \u003ci\u003eR\u003c/i\u003e \u0026lt; \u003ci\u003eD\u003c/i\u003e·(\u003ci\u003em\u003c/i\u003e + 1)\u003c/span\u003e. We should use this fact..\u003cbr /\u003e\u003cbr /\u003e If \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/c1/fa/c1fa0bf88411dc81deb1b722e08fe09363052a07.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e holds, there exists an non-negative integer \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e which satisfies \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eL\u003c/i\u003e + \u003ci\u003eMk\u003c/i\u003e ≤ \u003ci\u003eD\u003c/i\u003e·\u003ci\u003em\u003c/i\u003e ≤ \u003ci\u003eR\u003c/i\u003e + \u003ci\u003eMk\u003c/i\u003e\u003c/span\u003e. Let\u0027s write down.. \u003ccenter\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eD\u003c/i\u003e·\u003ci\u003em\u003c/i\u003e - \u003ci\u003eR\u003c/i\u003e ≤ \u003ci\u003eM\u003c/i\u003e·\u003ci\u003ek\u003c/i\u003e ≤ \u003ci\u003eD\u003c/i\u003e·\u003ci\u003em\u003c/i\u003e - \u003ci\u003eL\u003c/i\u003e\u003c/span\u003e\u003cbr /\u003e \u003cspan class\u003d\"tex-span\"\u003e - \u003ci\u003eR\u003c/i\u003e ≤ \u003ci\u003eM\u003c/i\u003e·\u003ci\u003ek\u003c/i\u003e - \u003ci\u003eD\u003c/i\u003e·\u003ci\u003em\u003c/i\u003e ≤  - \u003ci\u003eL\u003c/i\u003e\u003c/span\u003e\u003cbr /\u003e \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eL\u003c/i\u003e ≤ \u003ci\u003eD\u003c/i\u003e·\u003ci\u003em\u003c/i\u003e - \u003ci\u003eM\u003c/i\u003e·\u003ci\u003ek\u003c/i\u003e  ≤ \u003ci\u003eR\u003c/i\u003e\u003c/span\u003e\u003c/center\u003eBecause \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/ac/89/ac89d9d642c08a293f8779fe318b12b40f049681.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, we can write the inequality as \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/34/38/3438f31cf2a946ecbc28be1dfdabf543e64adb7c.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e Therefore the minimum \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e among all possible solutions is equal to \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/20/26/2026b50b00f6efb658151b28562679c48d6ebb39.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. We can easily calculate the smallest \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e using \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e.\u003c/li\u003e \u003c/ol\u003e\u003cp\u003eThen, what is the time complexity of calculating \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e(\u003ci\u003eM\u003c/i\u003e, \u003ci\u003eD\u003c/i\u003e, \u003ci\u003eL\u003c/i\u003e, \u003ci\u003eR\u003c/i\u003e)\u003c/span\u003e? Because \u003cspan class\u003d\"tex-span\"\u003e2\u003ci\u003eD\u003c/i\u003e ≤ \u003ci\u003eM\u003c/i\u003e\u003c/span\u003e (the \u003cspan class\u003d\"tex-span\"\u003e2\u003ci\u003eD\u003c/i\u003e \u0026gt; \u003ci\u003eM\u003c/i\u003e\u003c/span\u003e case is handled during step 3), the problem size becomes half, so it can be executed in \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/d9/04/d9047d4b14a8115a748c490be6bba3421060530e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/p\u003e\u003ch3\u003eConclusion\u003c/h3\u003e\u003cp\u003eFor each query, we have to consider both Case 1) and Case 2), with all possible directions. Both cases can be handled in \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/53/93/5393b8717a308efb09d2556bdddd54550be4b85a.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, so the time complexity per query is \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/53/93/5393b8717a308efb09d2556bdddd54550be4b85a.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, and it has really huge constant.\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003cstrong\u003eTime\u003c/strong\u003e: \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/b0/87/b0875f876fbe9c820e74e0e04353f4c6086d4ded.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/li\u003e   \u003cli\u003e\u003cstrong\u003eMemory\u003c/strong\u003e: \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/e7/0f/e70fbdc8079c0b9ff4f31073012937bac199bc6b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/li\u003e   \u003cli\u003e\u003cstrong\u003eImplementation\u003c/strong\u003e: \u003ca href\u003d\"/contest/500/submission/9330235\" title\u003d\"Submission 9330235 by ainta\"\u003e9330235\u003c/a\u003e\u003c/li\u003e \u003c/ul\u003e\u003c/div\u003e","tags":["good bye 2014","editorial"]}}