{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1523137165,"rating":63,"authorHandle":"apoorv_kulsh","modificationTimeSeconds":1523147433,"id":58802,"title":"\u003cp\u003eDivide by Zero 2018 and Codeforces Round #474 (Div. 1 + Div. 2, combined) Editorial\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"960A\"\u003eTutorial is loading...\u003c/div\u003e\u003cp\u003eSet by : \u003ca class\u003d\"rated-user user-violet\" href\u003d\"/profile/vntshh\" title\u003d\"Candidate Master vntshh\"\u003evntshh\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSetter\u0027s solution\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include\u0026lt;bits/stdc++.h\u0026gt;\n#define rep(i,start,lim) for(lld i\u003dstart;i\u0026lt;lim;i++)\n#define repd(i,start,lim) for(lld i\u003dstart;i\u0026gt;\u003dlim;i--)\n#define scan(x) scanf(\u0026quot;%lld\u0026quot;,\u0026amp;x)\n#define print(x) printf(\u0026quot;%lld \u0026quot;,x)\n#define f first\n#define s second\n#define pb push_back\n#define mp make_pair\n#define br printf(\u0026quot;\\n\u0026quot;)\n#define sz(a) lld((a).size())\n#define YES printf(\u0026quot;YES\\n\u0026quot;)\n#define NO printf(\u0026quot;NO\\n\u0026quot;)\n#define all(c) (c).begin(),(c).end()\n#define INF         1011111111\n#define LLINF       1000111000111000111LL\n#define EPS         (double)1e-10\n#define MOD         1000000007\n#define PI          3.14159265358979323\nusing namespace std;\ntypedef long double ldb;\ntypedef long long lld;\nlld powm(lld base,lld exp,lld mod\u003dMOD) {lld ans\u003d1;while(exp){if(exp\u0026amp;1) ans\u003d(ans*base)%mod;exp\u0026gt;\u0026gt;\u003d1,base\u003d(base*base)%mod;}return ans;}\nlld ctl(char x,char an\u003d\u0027a\u0027) {return (lld)(x-an);}\nchar ltc(lld x,char an\u003d\u0027a\u0027) {return (char)(x+an);}\n#define bit(x,j) ((x\u0026gt;\u0026gt;j)\u0026amp;1)\ntypedef vector\u0026lt;lld\u0026gt; vlld;\ntypedef pair\u0026lt;lld,lld\u0026gt; plld;\ntypedef map\u0026lt;lld,lld\u0026gt; mlld;\ntypedef set\u0026lt;lld\u0026gt; slld;\n#define sync ios_base::sync_with_stdio(0); cin.tie(0); cout.tie(0)\n#define mxm(a,b) a \u003d max(a,b)\n#define mnm(a,b) a \u003d min(a,b)\n#define endl \u0027\\n\u0027\n#define fre freopen(\u0026quot;1.in\u0026quot;,\u0026quot;r\u0026quot;,stdin); freopen(\u0026quot;1.out\u0026quot;,\u0026quot;w\u0026quot;,stdout);\n#define N 1000005\nint main()\n{\n    //sync;\n    string s;\n    map\u0026lt;char,lld\u0026gt; m;\n    cin\u0026gt;\u0026gt;s;\n    lld k \u003d sz(s);\n    string tmp \u003d \u0026quot;\u0026quot;;\n    tmp +\u003d s[0];\n    rep(i,1,k) if(s[i]!\u003ds[i-1]) tmp+\u003ds[i];\n    rep(i,0,k) m[s[i]]++;\n    if(tmp !\u003d \u0026quot;abc\u0026quot;) return 0*NO;\n    if(m[\u0027c\u0027]!\u003dm[\u0027a\u0027] and m[\u0027c\u0027]!\u003dm[\u0027b\u0027]) return 0*NO;\n    if(m[\u0027a\u0027]\u0026gt;\u003d1 and m[\u0027b\u0027]\u0026gt;\u003d1) return 0*YES;\n    else return 0*NO;\n    return 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"960B\"\u003eTutorial is loading...\u003c/div\u003e\u003cp\u003eSet by : \u003ca class\u003d\"rated-user user-violet\" href\u003d\"/profile/AakashHanda\" title\u003d\"Candidate Master AakashHanda\"\u003eAakashHanda\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSetter\u0027s solution\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include\u0026lt;bits/stdc++.h\u0026gt;\nusing namespace std;\n\ntypedef long long ll;\n\npriority_queue\u0026lt;ll\u0026gt; pq;\n\nint main(){\n    int n, k1, k2, k;\n    cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;k1\u0026gt;\u0026gt;k2;\n    k \u003d k1+k2;\n    vector\u0026lt;ll\u0026gt; a(n), b(n), arr(n);\n    for(int i\u003d0 ; i\u0026lt;n ; ++i)\n        cin\u0026gt;\u0026gt;a[i];\n    for(int i\u003d0 ; i\u0026lt;n ; ++i){\n        cin\u0026gt;\u0026gt;b[i];\n        arr[i] \u003d abs(a[i]-b[i]);\n        pq.push(arr[i]);\n    }\n    while(k\u0026gt;0){\n        ll curr \u003d pq.top();\n        pq.pop();\n        pq.push(abs(curr-1));\n        k--;\n    }\n    ll ans \u003d 0;\n    while(!pq.empty()){\n        ll curr \u003d pq.top();\n        ans +\u003d (curr*curr);\n        pq.pop();\n    }\n    cout\u0026lt;\u0026lt;ans;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"960C\"\u003eTutorial is loading...\u003c/div\u003e\u003cp\u003eSet by : \u003ca class\u003d\"rated-user user-blue\" href\u003d\"/profile/decrypt\" title\u003d\"Expert decrypt\"\u003edecrypt\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSetter\u0027s solution\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include\u0026lt;bits/stdc++.h\u0026gt;\n#define rep(i,start,lim) for(lld i\u003dstart;i\u0026lt;lim;i++)\n#define repd(i,start,lim) for(lld i\u003dstart;i\u0026gt;\u003dlim;i--)\n#define scan(x) scanf(\u0026quot;%lld\u0026quot;,\u0026amp;x)\n#define print(x) printf(\u0026quot;%lld \u0026quot;,x)\n#define f first\n#define s second\n#define pb push_back\n#define mp make_pair\n#define br printf(\u0026quot;\\n\u0026quot;)\n#define sz(a) lld((a).size())\n#define YES printf(\u0026quot;YES\\n\u0026quot;)\n#define NO printf(\u0026quot;NO\\n\u0026quot;)\n#define all(c) (c).begin(),(c).end()\n#define INF         1011111111\n#define LLINF       1000111000111000111LL\n#define EPS         (double)1e-10\n#define MOD         1000000007\n#define PI          3.14159265358979323\nusing namespace std;\ntypedef long double ldb;\ntypedef long long lld;\nlld powm(lld base,lld exp,lld mod\u003dMOD) {lld ans\u003d1;while(exp){if(exp\u0026amp;1) ans\u003d(ans*base)%mod;exp\u0026gt;\u0026gt;\u003d1,base\u003d(base*base)%mod;}return ans;}\nlld ctl(char x,char an\u003d\u0027a\u0027) {return (lld)(x-an);}\nchar ltc(lld x,char an\u003d\u0027a\u0027) {return (char)(x+an);}\n#define bit(x,j) ((x\u0026gt;\u0026gt;j)\u0026amp;1)\ntypedef vector\u0026lt;lld\u0026gt; vlld;\ntypedef pair\u0026lt;lld,lld\u0026gt; plld;\ntypedef map\u0026lt;lld,lld\u0026gt; mlld;\ntypedef set\u0026lt;lld\u0026gt; slld;\n#define sync ios_base::sync_with_stdio(0); cin.tie(0); cout.tie(0)\n#define mxm(a,b) a \u003d max(a,b)\n#define mnm(a,b) a \u003d min(a,b)\n#define endl \u0027\\n\u0027\n#define fre freopen(\u0026quot;1.in\u0026quot;,\u0026quot;r\u0026quot;,stdin); freopen(\u0026quot;1.out\u0026quot;,\u0026quot;w\u0026quot;,stdout);\n#define N 1000005\nint main()\n{\n    //sync;\n    lld x,d;\n    vector\u0026lt;lld\u0026gt; ans;\n    cin\u0026gt;\u0026gt;x\u0026gt;\u0026gt;d;\n    lld num \u003d 1, cnt \u003d 0;\n    repd(i,60,1) if(bit(x,i)) {\n        rep(j,0,i) ans.pb(num);\n        cnt++;\n        num+\u003d(d+1);\n    }\n    while(cnt--) ans.pb(num),num+\u003d(d+1);\n    if(x%2) ans.pb(num);\n    cout\u0026lt;\u0026lt;sz(ans)\u0026lt;\u0026lt;endl;\n    for(auto i:ans) cout\u0026lt;\u0026lt;i\u0026lt;\u0026lt;\u0026quot; \u0026quot;;\n    return 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"960D\"\u003eTutorial is loading...\u003c/div\u003e\u003cp\u003eSet by : \u003ca class\u003d\"rated-user user-violet\" href\u003d\"/profile/vicennial\" title\u003d\"Candidate Master vicennial\"\u003evicennial\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSetter\u0027s solution\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e//Gvs Akhil (Vicennial)\n#include\u0026lt;bits/stdc++.h\u0026gt;\n#define int long long\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define ld(a) while(a--)\n#define tci(v,i) for(auto i\u003dv.begin();i!\u003dv.end();i++)\n#define tcf(v,i) for(auto i : v)\n#define all(v) v.begin(),v.end()\n#define rep(i,start,lim) for(long long (i)\u003d(start);i\u0026lt;(lim);i++)\n#define sync ios_base::sync_with_stdio(0); cin.tie(0); cout.tie(0)\n#define osit ostream_iterator\n#define INF \t\t0x3f3f3f3f\n#define LLINF       1000111000111000111LL\n#define PI \t\t\t3.14159265358979323\n#define endl \u0027\\n\u0027\n#define trace1(x)                cerr\u0026lt;\u0026lt;#x\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;x\u0026lt;\u0026lt;endl\n#define trace2(x, y)             cerr\u0026lt;\u0026lt;#x\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;x\u0026lt;\u0026lt;\u0026quot; | \u0026quot;\u0026lt;\u0026lt;#y\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;y\u0026lt;\u0026lt;endl\n#define trace3(x, y, z)          cerr\u0026lt;\u0026lt;#x\u0026lt;\u0026lt;\u0026quot;:\u0026quot; \u0026lt;\u0026lt;x\u0026lt;\u0026lt;\u0026quot; | \u0026quot;\u0026lt;\u0026lt;#y\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;y\u0026lt;\u0026lt;\u0026quot; | \u0026quot;\u0026lt;\u0026lt;#z\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;z\u0026lt;\u0026lt;endl\n#define trace4(a, b, c, d)       cerr\u0026lt;\u0026lt;#a\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;a\u0026lt;\u0026lt;\u0026quot; | \u0026quot;\u0026lt;\u0026lt;#b\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;b\u0026lt;\u0026lt;\u0026quot; | \u0026quot;\u0026lt;\u0026lt;#c\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;c\u0026lt;\u0026lt;\u0026quot; | \u0026quot;\u0026lt;\u0026lt;#d\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;d\u0026lt;\u0026lt;endl\n#define trace5(a, b, c, d, e)    cerr\u0026lt;\u0026lt;#a\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;a\u0026lt;\u0026lt;\u0026quot; | \u0026quot;\u0026lt;\u0026lt;#b\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;b\u0026lt;\u0026lt;\u0026quot; | \u0026quot;\u0026lt;\u0026lt;#c\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;c\u0026lt;\u0026lt;\u0026quot; | \u0026quot;\u0026lt;\u0026lt;#d\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;d\u0026lt;\u0026lt;\u0026quot; | \u0026quot;\u0026lt;\u0026lt;#e\u0026lt;\u0026lt; \u0026quot;: \u0026quot;\u0026lt;\u0026lt;e\u0026lt;\u0026lt;endl\n#define trace6(a, b, c, d, e, f) cerr\u0026lt;\u0026lt;#a\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;a\u0026lt;\u0026lt;\u0026quot; | \u0026quot;\u0026lt;\u0026lt;#b\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;b\u0026lt;\u0026lt;\u0026quot; | \u0026quot;\u0026lt;\u0026lt;#c\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;c\u0026lt;\u0026lt;\u0026quot; | \u0026quot;\u0026lt;\u0026lt;#d\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;d\u0026lt;\u0026lt;\u0026quot; | \u0026quot;\u0026lt;\u0026lt;#e\u0026lt;\u0026lt; \u0026quot;: \u0026quot;\u0026lt;\u0026lt;e\u0026lt;\u0026lt;\u0026quot; | \u0026quot;\u0026lt;\u0026lt;#f\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;f\u0026lt;\u0026lt;endl\nconst int N\u003d1000006;\nusing namespace std;\ntypedef vector\u0026lt;int\u0026gt; vi;\ntypedef vector\u0026lt;vi\u0026gt; vvi;\ntypedef long long ll;\ntypedef vector\u0026lt;long long\u0026gt; vll;\ntypedef vector\u0026lt;vll\u0026gt; vvll;\ntypedef long double ld;\ntypedef pair\u0026lt;int,int\u0026gt; ii;\ntypedef vector\u0026lt;ii\u0026gt; vii;\ntypedef vector\u0026lt;vii\u0026gt; vvii;\ntypedef tuple\u0026lt;int,int,int\u0026gt; iii;\ntypedef set\u0026lt;int\u0026gt; si;\ntypedef complex\u0026lt;double\u0026gt; pnt;\ntypedef vector\u0026lt;pnt\u0026gt; vpnt;\ntypedef priority_queue\u0026lt;ii,vii,greater\u0026lt;ii\u0026gt; \u0026gt; spq;\nconst ll MOD\u003d1000000007LL;\ntemplate\u0026lt;typename T\u0026gt; T gcd(T a,T b){if(a\u003d\u003d0) return b; return gcd(b%a,a);}\ntemplate\u0026lt;typename T\u0026gt; T power(T x,T y,ll m\u003dMOD){T ans\u003d1;while(y\u0026gt;0){if(y\u0026amp;1LL) ans\u003d(ans*x)%m;y\u0026gt;\u0026gt;\u003d1LL;x\u003d(x*x)%m;}return ans%m;}\nint shift[66];\ninline int getlev(int x){\n\tint z\u003d__builtin_clzll(x);\n\treturn 64-z;\n}\ninline int getmod(int x){\n\treturn (1LL\u0026lt;\u0026lt;(x-1));\n}\nvoid addshift(int x,int k){\n\tint m\u003dgetmod(x);\n\tif(k\u0026gt;\u003dm) k%\u003dm;\n\tshift[x]+\u003dk;\n\tif(shift[x]\u0026gt;\u003dm) shift[x]-\u003dm;\n\tif(shift[x]\u0026lt;0) shift[x]+\u003dm;\t\n}\nint getorig(int V,int l){\n\tint fval\u003d(1LL\u0026lt;\u0026lt;(l-1)); // 2^(L-1)\n\tint mod\u003dgetmod(l);\n\tint P\u003d V-fval; \n\tint Z\u003d fval+((P-shift[l])%mod + mod)%mod;\n\treturn Z;\n}\nint32_t main(){\n\tsync;\n\tint q; cin\u0026gt;\u0026gt;q;\n\twhile(q--){\n\t\tint t,x,k;\n\t\tcin\u0026gt;\u0026gt;t\u0026gt;\u0026gt;x;\n\t\tint l\u003dgetlev(x);\n\t\tif(t\u003d\u003d1){ \n\t\t\tcin\u0026gt;\u0026gt;k; k%\u003dgetmod(l);\n\t\t\taddshift(l,k);\n\t\t}\n\t\telse if(t\u003d\u003d2){// propogating\n\t\t\tcin\u0026gt;\u0026gt;k; \n\t\t\tk%\u003dgetmod(l);\n\t\t\tif(k\u0026lt;0) k+\u003dgetmod(l);\n\t\t\t int curr\u003d1;\n\t\t\tfor(int i\u003dl;i\u0026lt;\u003d60;i++){\n\t\t\t\taddshift(i,k*curr);\n\t\t\t\tcurr\u0026lt;\u0026lt;\u003d1;\n\t\t\t}\n\t\t}\n\t\telse{ // printing\n\t\t\tint P\u003d x - (1LL\u0026lt;\u0026lt;(l-1)); // Finding index in array\n\t\t\tint V\u003d (1LL\u0026lt;\u0026lt;(l-1)) + ((P+shift[l])%(1LL\u0026lt;\u0026lt;(l-1)) + (1LL\u0026lt;\u0026lt;(l-1)) )%(1ll\u0026lt;\u0026lt;(l-1)); //Finding original value at the new index of X after performing the shift.\n\t\t\tfor(int i\u003dl;i\u0026gt;\u003d1;i--){\n\t\t\t\tint Z \u003d getorig(V,i); // Finding the current value\n\t\t\t\tcout\u0026lt;\u0026lt;Z\u0026lt;\u0026lt;\u0026quot; \u0026quot;; // printing the current value\n\t\t\t\tV\u0026gt;\u0026gt;\u003d1; // dividing the original value by 2 to get its parent value\n\t\t\t}\n\t\t\tcout\u0026lt;\u0026lt;endl;\n\t\t}\n\t}\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"960E\"\u003eTutorial is loading...\u003c/div\u003e\u003cp\u003eSet by : \u003ca class\u003d\"rated-user user-blue\" href\u003d\"/profile/rohitranjan017\" title\u003d\"Expert rohitranjan017\"\u003erohitranjan017\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSetter\u0027s solution\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include\u0026lt;bits/stdc++.h\u0026gt;\nusing namespace std;\ntypedef long long ll;\nconst int M\u003d1000005,mod\u003d1e9+7;\nvector\u0026lt;int\u0026gt; adj[M];\nint par[M],lev[M];\nll v[M];\nll e[M],o[M];\nll ans,res,n;\nll powmod(ll base, ll exponent)\n{ \n\t//cout\u0026lt;\u0026lt;base\u0026lt;\u0026lt;\u0026quot; \u0026quot;\u0026lt;\u0026lt;exponent\u0026lt;\u0026lt;endl;\n\n\tll ans\u003d1;\n\t\n\t\twhile(exponent)\n\t\t{ \n\t\t\twhile(exponent%2\u003d\u003d0)\n\t\t\t{\n\t\t\t\tbase\u003d(base*base)%mod;\n\t\t\t\texponent/\u003d2;\n\t\t\t}\n\t\t\t\n\t\t\texponent--;\n\t\t\tans\u003d(ans*base)%mod;\n\t\t}\n\t\t\n\treturn ans;\n}\nvoid dfs(int x,int depth)\n{\n\t//o[x]++;\n\n\tlev[x]\u003ddepth;\n\t\n\tint cno\u003d0;\n\n\tfor(int i\u003d0;i\u0026lt;adj[x].size();i++)\n\t{\n\t\tint c\u003dadj[x][i];\n\t\n\t\tif(c!\u003dpar[x])\n\t\t{\n\t\t\tpar[c]\u003dx;\n\t\n\t\t\tdfs(c,depth+1);\n\t\t\n\t\t\tif(cno\u0026gt;0)\n\t\t\t{\n\t\t\t\tans\u003d( (ans+ 2*( o[x]*e[c]%mod - e[x]*o[c]%mod + mod)%mod*v[x]%mod)+mod )%mod;\n\t\t\t}\n\t\t\t\n\t\t\tcno++;\n\t\t\n\t\t\to[x]+\u003de[c];\n\t\t\te[x]+\u003do[c];\n\t\t\n\t\t}\n\t\n\t}\n\t\n\to[x]++;\n\n\t\n}\nint main()\n{\n\t//freopen(\u0026quot;o.out\u0026quot;,\u0026quot;r\u0026quot;,stdin);\n\n\tcin\u0026gt;\u0026gt;n;\n\t\n\tfor(int i\u003d1;i\u0026lt;\u003dn;i++)\n\t{\n\t\tcin\u0026gt;\u0026gt;v[i];\n\t}\n\t\n\tfor(int i\u003d1;i\u0026lt;n;i++)\n\t{\n\t\tint u,v;\n\t\t\n\t\tcin\u0026gt;\u0026gt;u\u0026gt;\u0026gt;v;\n\t\t\n\t\tadj[u].push_back(v);\n\t\tadj[v].push_back(u);\n\t}\n\t\n\tdfs(1,0); \n\t\n\t//cout\u0026lt;\u0026lt;ans\u0026lt;\u0026lt;endl;\n\t\n\tfor(int i\u003d1;i\u0026lt;\u003dn;i++)\n\t{\t\n\t\t//cout\u0026lt;\u0026lt;\u0026quot;###\u0026quot;\u0026lt;\u0026lt;i\u0026lt;\u0026lt;endl;\n\t\tif(lev[i]%2)\n\t\t{\n\t\t\tans\u003d((ans+2*(o[i]*(e[1]-o[i]+1)%mod - e[i]*(o[1]-e[i])%mod +mod)%mod*v[i]%mod)%mod+mod )%mod;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tans\u003d((ans+2*(o[i]*(o[1]-o[i]+1)%mod - e[i]*(e[1]-e[i])%mod +mod)%mod*v[i]%mod)%mod+mod )%mod;\n\t\t}\n\t\t\n\t\t//cout\u0026lt;\u0026lt;ans\u0026lt;\u0026lt;endl;\n\t\t\n\t\tans\u003d((ans-v[i])%mod+mod)%mod;\n\t\t\n//\t\tcout\u0026lt;\u0026lt;i\u0026lt;\u0026lt;\u0026quot; \u0026quot;\u0026lt;\u0026lt;ans\u0026lt;\u0026lt;endl;\n\t\t//cout\u0026lt;\u0026lt;ans\u0026lt;\u0026lt;endl;\n\t}\n\t\n\tcout\u0026lt;\u0026lt;ans\u0026lt;\u0026lt;endl;\n\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"960F\"\u003eTutorial is loading...\u003c/div\u003e\u003cp\u003eSet by : \u003ca class\u003d\"rated-user user-violet\" href\u003d\"/profile/kr_abhinav\" title\u003d\"Candidate Master kr_abhinav\"\u003ekr_abhinav\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSetter\u0027s solution\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\nusing namespace std;\nvector\u0026lt;map\u0026lt;int,int\u0026gt; \u0026gt; s;\nint getedgelen(int a, int w)\n{\n    auto it \u003d s[a].lower_bound(w);\n    if(it \u003d\u003d s[a].begin()) return 1;\n    it--;\n    return (it-\u0026gt;second)+1;\n}\nint32_t main() {\n    ios::sync_with_stdio(false);cin.tie(0);\n    int n,m,a,b,w;\n    cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;m;\n    s.resize(n+1);\n    int ans \u003d 0;\n    while(m--)\n    {\n        cin\u0026gt;\u0026gt;a\u0026gt;\u0026gt;b\u0026gt;\u0026gt;w;\n        int val \u003d getedgelen(a,w);\n        if(getedgelen(b,w+1) \u0026gt; val)\n            continue;\n        s[b][w] \u003d max(s[b][w],val);\n        auto it \u003d s[b].upper_bound(w);\n        while(!(it\u003d\u003ds[b].end() || it-\u0026gt;second \u0026gt; val))\n        {\n            it \u003d s[b].erase(it);\n        }\n        ans \u003d max(ans,val);\n    }\n    cout\u0026lt;\u0026lt;ans;\n    return 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"960G\"\u003eTutorial is loading...\u003c/div\u003e\u003cp\u003eSet by : \u003ca class\u003d\"rated-user user-violet\" href\u003d\"/profile/apoorv_kulsh\" title\u003d\"Candidate Master apoorv_kulsh\"\u003eapoorv_kulsh\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSetter\u0027s solution\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\nusing namespace std;\ntypedef long long ll;\n#define pb push_back\nconst int mod \u003d 998244353;\nconst int root \u003d 15311432;\nconst int root_1 \u003d 469870224;\nconst int root_pw \u003d 1 \u0026lt;\u0026lt; 23;\nconst int N \u003d 400004;\n\nvector\u0026lt;int\u0026gt; v[N];\n\nll modInv(ll a, ll mod \u003d mod){\n\tll x0 \u003d 0, x1 \u003d 1, r0 \u003d mod, r1 \u003d a;\n\twhile(r1){\n\t\tll q \u003d r0 / r1;\n\t\tx0 -\u003d q * x1; swap(x0, x1);\n\t\tr0 -\u003d q * r1; swap(r0, r1);\n\t}\n\treturn x0 \u0026lt; 0 ? x0 + mod : x0;\n}\n\nvoid fft (vector\u0026lt;int\u0026gt; \u0026amp;a, bool inv) {\n\tint n \u003d (int) a.size();\n\n\tfor (int i\u003d1, j\u003d0; i\u0026lt;n; ++i) {\n\t\tint bit \u003d n \u0026gt;\u0026gt; 1;\n\t\tfor (; j\u0026gt;\u003dbit; bit\u0026gt;\u0026gt;\u003d1)\n\t\t\tj -\u003d bit;\n\t\tj +\u003d bit;\n\t\tif (i \u0026lt; j)\n\t\t\tswap (a[i], a[j]);\n\t}\n\n\tfor (int len\u003d2; len\u0026lt;\u003dn; len\u0026lt;\u0026lt;\u003d1) {\n\t\tint wlen \u003d inv ? root_1 : root;\n\t\tfor (int i\u003dlen; i\u0026lt;root_pw; i\u0026lt;\u0026lt;\u003d1)\n\t\t\twlen \u003d int (wlen * 1ll * wlen % mod);\n\t\tfor (int i\u003d0; i\u0026lt;n; i+\u003dlen) {\n\t\t\tint w \u003d 1;\n\t\t\tfor (int j\u003d0; j\u0026lt;len/2; ++j) {\n\t\t\t\tint u \u003d a[i+j],  v \u003d int (a[i+j+len/2] * 1ll * w % mod);\n\t\t\t\ta[i+j] \u003d u+v \u0026lt; mod ? u+v : u+v-mod;\n\t\t\t\ta[i+j+len/2] \u003d u-v \u0026gt;\u003d 0 ? u-v : u-v+mod;\n\t\t\t\tw \u003d int (w * 1ll * wlen % mod);\n\t\t\t}\n\t\t}\n\t}\n\n\tif(inv) {\n\t\tint nrev \u003d modInv(n, mod);\n\t\tfor (int i\u003d0; i\u0026lt;n; ++i)\n\t\t\ta[i] \u003d int (a[i] * 1ll * nrev % mod);\n\t}\n}\n\nvoid pro(const vector\u0026lt;int\u0026gt; \u0026amp;a, const vector\u0026lt;int\u0026gt; \u0026amp;b, vector\u0026lt;int\u0026gt; \u0026amp;res) {\n\tvector\u0026lt;int\u0026gt; fa(a.begin(), a.end()),  fb(b.begin(), b.end());\n\tint n \u003d 1;\n\twhile (n \u0026lt; (int) max(a.size(), b.size()))  n \u0026lt;\u0026lt;\u003d 1;\n\tn \u0026lt;\u0026lt;\u003d 1;\n\tfa.resize (n),  fb.resize (n);\n\n\tfft(fa, false), fft (fb, false);\n\tfor (int i \u003d 0; i \u0026lt; n; ++i)\n\t\tfa[i] \u003d 1LL * fa[i] * fb[i] % mod;\n\tfft (fa, true);\n\tres \u003d fa;\n}\n\nint S(int n, int r) {\n\n\tint nn \u003d 1;\n\twhile(nn \u0026lt; n) nn \u0026lt;\u0026lt;\u003d 1;\n\n\tfor(int i \u003d 0; i \u0026lt; n; ++i) {\n\t\tv[i].push_back(i);\n\t\tv[i].push_back(1);\n\t}\n\tfor(int i \u003d n; i \u0026lt; nn; ++i) {\n\t\tv[i].push_back(1);\n\t}\n\n\tfor(int j \u003d nn; j \u0026gt; 1; j \u0026gt;\u0026gt;\u003d 1){\n\t\tint hn \u003d j \u0026gt;\u0026gt; 1;\n\t\tfor(int i \u003d 0; i \u0026lt; hn; ++i){\n\t\t\tpro(v[i], v[i + hn], v[i]);\n\t\t}\n\t}\n\n\treturn v[0][r];\n}\n\nint fac[N], ifac[N], inv[N];\n\nvoid prencr(){\n\tfac[0] \u003d ifac[0] \u003d inv[1] \u003d 1;\n    for(int i \u003d 2; i \u0026lt; N; ++i)\n    \tinv[i] \u003d mod - 1LL * (mod / i) * inv[mod % i] % mod;\n    for(int i \u003d 1; i \u0026lt; N; ++i){\n    \tfac[i] \u003d 1LL * i * fac[i - 1] % mod;\n    \tifac[i] \u003d 1LL * inv[i] * ifac[i - 1] % mod;\n    }\n}\n\nint C(int n, int r){\n\treturn (r \u0026gt;\u003d 0 \u0026amp;\u0026amp; n \u0026gt;\u003d r) ? (1LL * fac[n] * ifac[n - r] % mod * ifac[r] % mod) : 0;\n}\n\nint main(){\n\tprencr();\n\tint n, p, q;\n\tcin \u0026gt;\u0026gt; n \u0026gt;\u0026gt; p \u0026gt;\u0026gt; q;\n\tll ans \u003d C(p + q - 2, p - 1);\n\tans *\u003d S(n - 1, p + q - 2);\n\tans %\u003d mod;\n\tcout \u0026lt;\u0026lt; ans;\n}\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"960H\"\u003eTutorial is loading...\u003c/div\u003e\u003cp\u003eSet by : \u003ca class\u003d\"rated-user user-blue\" href\u003d\"/profile/arnabsamanta\" title\u003d\"Expert arnabsamanta\"\u003earnabsamanta\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSetter\u0027s solution\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\nusing namespace std;\ntypedef long long ll;\n#define pb push_back\nconst int N \u003d 400004;\n\nint n;\nvector\u0026lt;int\u0026gt; e[N];\nint sz[N], par[N], sp[30][N];\nint V[N], L[N], CS[N];\nbool mark[N];\n\nstruct tri {\n\tlong long A, B;\n\tint C;\n};\n\nmap\u0026lt;int, tri\u0026gt; nmp[N];\n\nlong long D[N]; // Sum of Distances\nlong long S[N]; // Sum of Depth\nint T[N]; // Count\n\n//\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003dPRE-PROCESS\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\nvoid getLevel(int u, int p \u003d -1){\n\tsp[0][u] \u003d p;\n\tfor(auto x : e[u]) if(x !\u003d p) {\n\t\tL[x] \u003d 1 + L[u];\n\t\tgetLevel(x, u);\n\t}\n}\n\nvoid prepAncestor(){\n\tfor(int i \u003d 1; (1 \u0026lt;\u0026lt; i) \u0026lt;\u003d n; ++i) {\n\t\tfor(int j \u003d 1; j \u0026lt;\u003d n; ++j) {\n\t\t\tsp[i][j] \u003d sp[i - 1][sp[i - 1][j]];\n\t\t}\n\t}\n}\n\nint dist(int u, int v){\n\tif(L[u] \u0026lt; L[v]) swap(u, v);\n\tint lgn \u003d 0;\n\twhile((1 \u0026lt;\u0026lt; lgn) \u0026lt; n) lgn++;\n\tint ans \u003d 0;\n\tfor(int i \u003d lgn; i \u0026gt;\u003d 0; --i){\n\t\tif(L[u] - (1 \u0026lt;\u0026lt; i) \u0026gt;\u003d L[v]){\n\t\t\tu \u003d sp[i][u];\n\t\t\tans +\u003d (1 \u0026lt;\u0026lt; i);\n\t\t}\n\t}\n\tif(u \u003d\u003d v) return ans;\n\tfor(int i \u003d lgn; i \u0026gt;\u003d 0; --i){\n\t\tif(sp[i][u] !\u003d sp[i][v]){\n\t\t\tans +\u003d 1 \u0026lt;\u0026lt; (i + 1);\n\t\t\tu \u003d sp[i][u];\n\t\t\tv \u003d sp[i][v];\n\t\t}\n\t}\n\treturn ans + 2;\n}\n\n//\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003dCENTROID DECOMPOSITION\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\nvoid getSize(int u, int p \u003d -1) {\n      sz[u] \u003d 1;\n      for(auto v : e[u]) if(v !\u003d p \u0026amp;\u0026amp; !mark[v]) {\n            getSize(v, u);\n            sz[u] +\u003d sz[v];\n      }\n}\n \nint getCentroid(int u, int p, int lim) {\n      for(auto v : e[u]) if(v !\u003d p \u0026amp;\u0026amp; !mark[v] \u0026amp;\u0026amp; sz[v] \u0026gt; lim) {\n            return getCentroid(v, u, lim);\n      }\n      return u;\n}\n\nvoid decompose(int u, int p \u003d -1) {\n      getSize(u);\n      int cen \u003d getCentroid(u, -1, sz[u] / 2);\n      par[cen] \u003d p \u003d\u003d -1 ? cen : p;\n      mark[cen] \u003d true;\n       \n      for(auto v : e[cen]) if(v !\u003d p \u0026amp;\u0026amp; !mark[v]) {\n            decompose(v, cen);\n      }\n}\n\n//\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003dQUERY-HANDLER\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\nvoid updAns(int u, int add) {\n\n\tint Z \u003d V[u];\n\t\n\ttri tY \u003d nmp[u][Z];\n\tll ret \u003d tY.A;\n\tint y \u003d u, x \u003d par[u];\n\twhile(y !\u003d x) {\n\t\ttri tX \u003d nmp[x][Z];\n\t\tret +\u003d 1LL * (tX.C - tY.C) * dist(x, u) + (tX.A - tY.B);\n\t\ty \u003d x;\n\t\ttY \u003d tX;\n\t\tx \u003d par[x];\n\t}\n\tret \u0026lt;\u0026lt;\u003d 1;\n\n\tint mul \u003d add ? 1 : -1;\n\tD[Z] +\u003d mul * ret;\n\tS[Z] +\u003d mul * L[u];\n\tT[Z] +\u003d mul;\n}\n\nvoid updTree(int u, bool add) {\n\tint Z \u003d V[u];\n\tint mul \u003d add ? 1 : -1;\n\tfor(int x \u003d u; ; x \u003d par[x]) {\n\t\ttri \u0026amp;tX \u003d nmp[x][Z];\n\t\ttX.C +\u003d mul;\n\t\tif(!tX.C) {\n\t\t\tnmp[x].erase(Z);\n\t\t} else {\n\t\t\ttX.A +\u003d mul * dist(u, x);\n\t\t\ttX.B +\u003d mul * dist(u, par[x]);\n\t\t}\n\t\tif(x \u003d\u003d par[x]) break;\n\t}\n}\n\nvoid upd(int u, bool add) {\n\tif(add) {\n\t\tupdTree(u, add);\n\t\tupdAns(u, add);\n\t} else {\n\t\tupdAns(u, add);\n\t\tupdTree(u, add);\n\t} \n}\n\n//\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003dMAIN\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\nint main(){\n\t\n\tint m, q, ac;\n\tscanf(\u0026quot;%d %d %d %d\u0026quot;, \u0026amp;n, \u0026amp;m, \u0026amp;q, \u0026amp;ac);\n\n\tfor(int i \u003d 1; i \u0026lt;\u003d n; ++i) {\n\t\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;V[i]);\n\t}\n\t\n\tfor(int i \u003d 2; i \u0026lt;\u003d n; ++i) {\n\t\tint v;\n\t\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;v);\n\t\te[v].pb(i);\n\t\te[i].pb(v);\n\t}\n\n\tfor(int i \u003d 1; i \u0026lt;\u003d m; ++i) {\n\t\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;CS[i]);\n\t}\n\n\tL[1] \u003d 1;\n\tgetLevel(1);\n\tprepAncestor();\n\tdecompose(1);\n\t\n\tfor(int i \u003d 1; i \u0026lt;\u003d n; ++i) {\n\t\tupd(i, true);\n\t}\n\n\twhile(q--) {\n\t\tint t;\n\t\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;t);\n\t\tif(t \u003d\u003d 1) {\n\t\t\tint u, v;\n\t\t\tscanf(\u0026quot;%d %d\u0026quot;, \u0026amp;u, \u0026amp;v);\n\t\t\tupd(u, false);\n\t\t\tV[u] \u003d v; \n\t\t\tupd(u, true);\n\t\t}\n\t\telse if(t \u003d\u003d 2) {\n\t\t\tint v;\n\t\t\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;v);\n\t\t\tlong double ans \u003d S[v] * T[v] - D[v] / 2;\n\n\t\t\tans *\u003d 1LL * CS[v] * CS[v];\n\n\n\t\t\tans +\u003d 1LL * n * ac * ac;\n\n\t\t\t\n\t\t\tlong long anst \u003d 2LL * CS[v] * ac * S[v];\n\t\t\t\n\t\t\tans -\u003d anst;\n\n\t\t\tcout \u0026lt;\u0026lt; fixed \u0026lt;\u0026lt; setprecision(12) \u0026lt;\u0026lt; ans / n \u0026lt;\u0026lt; \u0026quot;\\n\u0026quot;; \n\t\t}\n\t}\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003eDo give your feedback here : \u003ca href\u003d\"https://goo.gl/forms/xbsdMxnkA3XsG4092\"\u003ehttps://goo.gl/forms/xbsdMxnkA3XsG4092\u003c/a\u003e. Would love to hear your feedback, since that would help us get better!\u003c/p\u003e\u003c/div\u003e","tags":[]}}