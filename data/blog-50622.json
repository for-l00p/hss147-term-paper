{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1487886484,"rating":61,"authorHandle":"dark_n8","modificationTimeSeconds":1487889083,"id":50622,"title":"\u003cp\u003eICM Technex 2017 and Codeforces Round #400 (Div. 1 + Div. 2, combined) Editorial\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"776A\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eCode\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;algorithm\u0026gt;\n#include \u0026lt;bitset\u0026gt;\n#include \u0026lt;cassert\u0026gt;\n#include \u0026lt;climits\u0026gt;\n#include \u0026lt;cmath\u0026gt;\n#include \u0026lt;cstdio\u0026gt;\n#include \u0026lt;cstdlib\u0026gt;\n#include \u0026lt;cstring\u0026gt;\n#include \u0026lt;deque\u0026gt;\n#include \u0026lt;iomanip\u0026gt;\n#include \u0026lt;iostream\u0026gt;\n#include \u0026lt;map\u0026gt;\n#include \u0026lt;numeric\u0026gt;\n#include \u0026lt;queue\u0026gt;\n#include \u0026lt;set\u0026gt;\n#include \u0026lt;stack\u0026gt;\n#include \u0026lt;string\u0026gt;\n\n#ifdef PRINTERS\n#include \u0026quot;printers.hpp\u0026quot;\nusing namespace printers;\n#define tr(a)\t\tcerr\u0026lt;\u0026lt;#a\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;a\u0026lt;\u0026lt;endl;\n#else\n#define tr(a)    \n#endif\n\n#define ll          long long\n#define pb          push_back\n#define mp          make_pair\n#define pii         pair\u0026lt;int,int\u0026gt;\n#define vi          vector\u0026lt;int\u0026gt;\n#define all(a)      (a).begin(),(a).end()\n#define F           first\n#define S           second\n#define sz(x)       (int)x.size()\n#define hell        1000000007\n#define endl        \u0027\\n\u0027\n#define rep(i,a,b)\tfor(int i\u003da;i\u0026lt;b;i++)\nusing namespace std;\n\nvoid solve(){\n\tstring a,b;\n\tcin\u0026gt;\u0026gt;a\u0026gt;\u0026gt;b;\n\tvector\u0026lt;string\u0026gt;taken;\n\tint n;\n\tcin\u0026gt;\u0026gt;n;\n\trep(i,0,n){\n\t\tcout\u0026lt;\u0026lt;a\u0026lt;\u0026lt;\u0026quot; \u0026quot;\u0026lt;\u0026lt;b\u0026lt;\u0026lt;endl;\n\t\tstring c,d;\n\t\tcin\u0026gt;\u0026gt;c\u0026gt;\u0026gt;d;\n\t\tif(c\u003d\u003da)a\u003dd;\n\t\telse b\u003dd;\n\t}\n\tcout\u0026lt;\u0026lt;a\u0026lt;\u0026lt;\u0026quot; \u0026quot;\u0026lt;\u0026lt;b\u0026lt;\u0026lt;endl;\n}\n\nint main(){\n\tios_base::sync_with_stdio(false);\n\tcin.tie(0);\n\tcout.tie(0);\n\tint t\u003d1;\n\twhile(t--){\n\t\tsolve();\n\t}\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"776B\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eCode\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\nusing namespace std;\n\nint sieve[100005];\n\nint main()\n{\n\tint i, n, j;\n\tcin\u0026gt;\u0026gt;n;\n\tfor(i\u003d2; i\u0026lt;\u003dn+1; i++)\n\t{\n\t\tif(!sieve[i])\n\t\t\tfor(j\u003d2*i; j\u0026lt;\u003dn+1; j+\u003di)\n\t\t\t\tsieve[j]\u003d1;\n\t}\n\t\n\tif(n\u0026gt;2)\n\t\tcout\u0026lt;\u0026lt;\u0026quot;2\\n\u0026quot;;\n\telse\n\t\tcout\u0026lt;\u0026lt;\u0026quot;1\\n\u0026quot;;\n\n\tfor(i\u003d2; i\u0026lt;\u003dn+1; i++)\n\t{\n\t\tif(!sieve[i])\n\t\t\tcout\u0026lt;\u0026lt;\u0026quot;1 \u0026quot;;\n\t\telse\n\t\t\tcout\u0026lt;\u0026lt;\u0026quot;2 \u0026quot;;\n\t}\n\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"776C\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eCode\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;algorithm\u0026gt;\n#include \u0026lt;bitset\u0026gt;\n#include \u0026lt;cassert\u0026gt;\n#include \u0026lt;climits\u0026gt;\n#include \u0026lt;cmath\u0026gt;\n#include \u0026lt;cstdio\u0026gt;\n#include \u0026lt;cstdlib\u0026gt;\n#include \u0026lt;cstring\u0026gt;\n#include \u0026lt;deque\u0026gt;\n#include \u0026lt;iomanip\u0026gt;\n#include \u0026lt;iostream\u0026gt;\n#include \u0026lt;map\u0026gt;\n#include \u0026lt;numeric\u0026gt;\n#include \u0026lt;queue\u0026gt;\n#include \u0026lt;set\u0026gt;\n#include \u0026lt;stack\u0026gt;\n#include \u0026lt;string\u0026gt;\n\n#ifdef PRINTERS\n#include \u0026quot;printers.hpp\u0026quot;\nusing namespace printers;\n#define tr(a)        cerr\u0026lt;\u0026lt;#a\u0026lt;\u0026lt;\u0026quot;: \u0026quot;\u0026lt;\u0026lt;a\u0026lt;\u0026lt;endl;\n#else\n#define tr(a)    \n#endif\n#define ll          long long\n#define pb          push_back\n#define mp          make_pair\n#define pii         pair\u0026lt;int,int\u0026gt;\n#define vi          vector\u0026lt;int\u0026gt;\n#define all(a)      (a).begin(),(a).end()\n#define F           first\n#define S           second\n#define sz(x)       (int)x.size()\n#define hell        1000000007\n#define endl        \u0027\\n\u0027\n#define rep(i,a,b)    for(int i\u003da;i\u0026lt;b;i++)\nusing namespace std;\n\nvoid solve(){\n    int N,k;\n    scanf(\u0026quot;%d%d\u0026quot;,\u0026amp;N,\u0026amp;k);\n    ll x[N+1];\n    x[0]\u003d0;\n    rep(i,0,N)scanf(\u0026quot;%lld\u0026quot;,\u0026amp;x[i+1]);\n    partial_sum(x,x+N+1,x);\n    if(k\u003d\u003d1){\n        ll ans\u003d0;\n        map\u0026lt;ll,int\u0026gt;m;\n        for(int i\u003dN;i\u0026gt;\u003d0;i--){\n            if(m.find(x[i]+1)!\u003dm.end())\n                ans+\u003dm[x[i]+1];\n            m[x[i]]++;\n        }\n        printf(\u0026quot;%lld\\n\u0026quot;,ans);\n    }\n    else if(k\u003d\u003d-1){\n        ll ans\u003d0;\n        map\u0026lt;ll,int\u0026gt;m;\n        for(int i\u003dN;i\u0026gt;\u003d0;i--){\n            if(m.find(x[i]+1)!\u003dm.end())\n                ans+\u003dm[x[i]+1];\n            if(m.find(x[i]-1)!\u003dm.end())\n                ans+\u003dm[x[i]-1];\n            \n            m[x[i]]++;\n        }\n        printf(\u0026quot;%lld\\n\u0026quot;,ans);\n    }\n    else{\n        ll ans\u003d0;\n        map\u0026lt;ll,int\u0026gt;m;\n        for(int i\u003dN;i\u0026gt;\u003d0;i--){\n            ll cur\u003d1;\n            while(true){\n                if(abs(cur)\u0026gt;\u003d1e15)break;\n                if(m.find(x[i]+cur)!\u003dm.end())\n                ans+\u003dm[x[i]+cur];\n                cur*\u003dk;\n            }\n            m[x[i]]++;\n        }\n        printf(\u0026quot;%lld\\n\u0026quot;,ans);\n    }\n}\n\nsigned main(){\n    int t\u003d1;\n    while(t--){\n        solve();\n    }\n    return 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"776D\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eCode\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\nusing namespace std;\n#define mem(x,y) memset(x,y,sizeof(x))\n#define bitcount    __builtin_popcountll\n#define mod 1000000007\n#define N 1000009\n#define fast ios::sync_with_stdio(0); cin.tie(0); cout.tie(0);\n#define ss(s) cin\u0026gt;\u0026gt;s;\n#define si(x)  scanf(\u0026quot;%d\u0026quot;,\u0026amp;x);\n#define sl(x)  cin\u0026gt;\u0026gt;x;\n#define pb push_back\n#define mp make_pair\n#define all(v) v.begin(),v.end()\n#define S second\n#define F first\n#define ll long long\nint n,m;\nvector\u0026lt;int\u0026gt; arr[N];\nint arr1[N];\nvector\u0026lt;pair\u0026lt;int,int \u0026gt; \u0026gt; adj[100008];                    //max-size\nvoid graph(int n){for(int i\u003d1;i\u0026lt;\u003dn;i++){\n\t\t\t\t\tint x \u003d arr[i][0];\n\t\t\t\t\tint y \u003d arr[i][1];\n\t\t\t\t\tadj[x].push_back(mp(y,arr1[i] ));                           //arr1[i] stores th color of the edge\n\t\t\t\t\tadj[y].push_back(mp(x,arr1[i]) );}\n\n}\nint col[N];\nbool vis[N];\nint main(){\n//fast                          //uncomment on submission\ncin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;m;\nassert(n\u0026gt;\u003d2 \u0026amp;\u0026amp; n\u0026lt;\u003d100000);\nassert(m\u0026gt;\u003d2 \u0026amp;\u0026amp; m\u0026lt;\u003d100000);\nfor(int i \u003d1;i\u0026lt;\u003dn;i++)cin \u0026gt;\u0026gt; arr1[i];\nfor(int i \u003d 1;i\u0026lt;\u003dm;i++){\n    int sz;\n    cin \u0026gt;\u0026gt; sz;\n    for(int j \u003d0;j\u0026lt;sz;j++){\n        int y ;\n        cin \u0026gt;\u0026gt; y;\n        arr[y].push_back(i);\n    }\n}\ngraph(n);\nmem(col,-1);\nmem(vis,false);\nbool p \u003d true;\nfor(int i \u003d 1;i\u0026lt;\u003dm;i++){\n\tif(!vis[i] \u0026amp;\u0026amp; adj[i].size()){\n\t\tcol[i] \u003d 0;\n\t\tvis[i] \u003d true;\n\t\tqueue \u0026lt;int \u0026gt; q;\n\t\tq.push(i);\n\n\t\twhile(q.size()){\n\t\t\tint node \u003d q.front();\n\t\t\tq.pop();\n\t\n\t\t\tfor(auto pi:adj[node]){\n\t\t\t\tint co \u003d col[node];\n\t\t\t\tif(pi.S \u003d\u003d 0){                       //if the edge is 0 then give the opposite color.\n\t\t\t\t\tco \u003d 1 - co;\n\n\t\t}\n\t\tif(vis[pi.F] \u0026amp;\u0026amp; col[pi.F] !\u003d co){\n\t\t\tp \u003d false;\n\t\t}\n\t\tif(!vis[pi.F]){\n\t\t\tcol[pi.F] \u003d co;\n\t\t\tvis[pi.F] \u003d true;\n\t\t\tq.push(pi.F);\n\n\t\t}\n\t}\n}\n}\n}\n\nif(!p)cout\u0026lt;\u0026lt;\u0026quot;NO\u0026quot;;\nelse cout\u0026lt;\u0026lt;\u0026quot;YES\u0026quot;;\n\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"776E\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eCode\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\nusing namespace std;\n#define ll          long long\n#define MOD         1000000007\n#define ll          long long\n#define pb          push_back\n#define pii         pair\u0026lt;int,int\u0026gt;\n#define vi          vector\u0026lt;int\u0026gt;\n#define all(a)      (a).begin(),(a).end()\n#define F           first\n#define S           second\n#define endl        \u0027\\n\u0027\n#define PI          3.14159265359d\n#define sz(x)       (int)x.size()\nll phi(ll n)\n{\n    ll i,res\u003dn;\n    for(i\u003d2;i*i\u0026lt;\u003dn;i++)\n        if(n%i\u003d\u003d0)\n    {\n        while(n%i\u003d\u003d0)\n            n/\u003di;\n        res-\u003dres/i;\n    }\n    if(n\u0026gt;1)\n        res-\u003dres/n;\n    return res;\n}\nint main()\n{\n    ll n,k,res;\n    cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;k;\n    res\u003dn;\n    k\u003d(k+1)/2;\n    while(k--)\n    {\n        res\u003dphi(res);\n        if(res\u003d\u003d1)\n            break;\n    }\n    cout\u0026lt;\u0026lt;res%MOD;\n    return 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"776F\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eCode\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include\u0026lt;bits/stdc++.h\u0026gt;\nusing namespace std;\n#define sd(x) scanf(\u0026quot;%d\u0026quot;,\u0026amp;x)\n#define slld(x) scanf(\u0026quot;%lld\u0026quot;,\u0026amp;x)\n#define ss(x) scanf(\u0026quot;%s\u0026quot;,x)\n#define ll long long\n#define mod 1000000007\n#define bitcount    __builtin_popcountll\n#define pb push_back\n#define fi first\n#define se second\n#define mp make_pair\n#define pi pair\u0026lt;int,int\u0026gt;\npi arr[100005];\nint n,m;\nbool cmp(pi x, pi y)\n{\n\tint a\u003dmin(x.se-x.fi-1,n-2-(x.se-x.fi-1));\n\tint b\u003dmin(y.se-y.fi-1,n-2-(y.se-y.fi-1));\n\treturn a\u0026lt;b;\n}\nvector\u0026lt;int\u0026gt;nodes[100005];\nvector\u0026lt;int\u0026gt;v[100005],v2[100005];\nint de[100005],siz[100005];\nvoid dfs1(int node, int par)\n{\n\tsiz[node]\u003d1;\n\tfor(int i\u003d0;i\u0026lt;v[node].size();i++)\n\t{\n\t\tif(de[v[node][i]]\u003d\u003d0\u0026amp;\u0026amp;v[node][i]!\u003dpar)\n\t\t{\n\t\t\tdfs1(v[node][i],node);\n\t\t\tsiz[node]+\u003dsiz[v[node][i]];\n\t\t}\n\t}\n}\nint dfs2(int node, int par,int s)\n{\n\tint maxi\u003d0,maxinode;\n\tfor(int i\u003d0;i\u0026lt;v[node].size();i++)\n\t{\n\t\tif(de[v[node][i]]\u003d\u003d0\u0026amp;\u0026amp;v[node][i]!\u003dpar\u0026amp;\u0026amp;siz[v[node][i]]\u0026gt;s/2)\n\t\t{\n\t\t\treturn dfs2(v[node][i],node,s);\n\t\t}\n\t}\n\t//printf(\u0026quot;%d\\n\u0026quot;,node );\n\treturn node;\n}\nint decompose(int node)\n{\n\tdfs1(node,-1);\n\tint cen\u003ddfs2(node,-1,siz[node]);\n\t// printf(\u0026quot;%d\\n\u0026quot;,cen );\n\tde[cen]\u003d1;\n\tfor(int i\u003d0;i\u0026lt;v[cen].size();i++)\n\t{\n\t\tif(de[v[cen][i]]\u003d\u003d0)\n\t\t{\n\t\t\tint x\u003ddecompose(v[cen][i]);\n\t\t\t//printf(\u0026quot;%d\\n\u0026quot;, x);\n\t\t\tv2[cen].pb(x);\n\t\t\tv2[x].pb(cen);\n\t\t}\n\t}\n\n\treturn cen;\n}\nint level[100005];\nint main()\n{\n    //freopen(\u0026quot;in.txt\u0026quot;,\u0026quot;r\u0026quot;,stdin);\n    //freopen(\u0026quot;out.txt\u0026quot;,\u0026quot;w\u0026quot;,stdout);\n    int i,j,k;\n    sd(n);\n    sd(m);\n    for(i\u003d1;i\u0026lt;\u003dm;i++)\n    {\n    \tsd(arr[i].fi);\n    \tsd(arr[i].se);\n    \tif(arr[i].fi\u0026gt;arr[i].se)\n    \t{\n    \t\tswap(arr[i].fi,arr[i].se);\n    \t}\n    }\n    sort(arr+1,arr+m+1,cmp);\n    set\u0026lt;int\u0026gt;s;\n    for(i\u003d1;i\u0026lt;\u003dn;i++)\n    \ts.insert(i);\n    k\u003d0;\n    for(i\u003d1;i\u0026lt;\u003dm;i++)\n    {\n    \tif(arr[i].se-arr[i].fi-1\u0026lt;\u003dn-2-(arr[i].se-arr[i].fi-1))\n    \t{\n    \t\tnodes[k].pb(arr[i].fi);\n    \t\tset\u0026lt;int\u0026gt;::iterator it\u003ds.upper_bound(arr[i].fi);\n    \t\twhile((*it)!\u003darr[i].se)\n    \t\t{\n    \t\t\tnodes[k].pb(*it);\n    \t\t\tit++;\n    \t\t}\n    \t\tnodes[k].pb(arr[i].se);\n    \t\tfor(j\u003d1;j\u0026lt;nodes[k].size()-1;j++)\n    \t\t\ts.erase(nodes[k][j]);\n    \t}\n    \telse\n    \t{\n    \t\twhile(*s.begin()!\u003darr[i].fi)\n    \t\t{\n    \t\t\tnodes[k].pb(*s.begin());\n    \t\t\ts.erase(s.begin());\n    \t\t}\n    \t\tnodes[k].pb(arr[i].fi);\n    \t\tnodes[k].pb(arr[i].se);\n    \t\tint l\u003dnodes[k].size();\n    \t\tset\u0026lt;int\u0026gt;::iterator it\u003ds.upper_bound(arr[i].se);\n    \t\twhile(it!\u003ds.end())\n    \t\t{\n    \t\t\tnodes[k].pb(*it);\n    \t\t\tit++;\n    \t\t}\n    \t\tfor(;l\u0026lt;nodes[k].size();l++)\n    \t\t\ts.erase(nodes[k][l]);\n    \t}\n    \treverse(nodes[k].begin(), nodes[k].end());\n    \tk++;\n    }\n    while(s.size()!\u003d0)\n    {\n    \tnodes[k].pb(*s.begin());\n    \ts.erase(s.begin());\n    }\n   \treverse(nodes[k].begin(), nodes[k].end());\n\tk++;\n    sort(nodes,nodes+k);\n    map\u0026lt;pi,int\u0026gt;m1;\n    for(i\u003d0;i\u0026lt;k;i++)\n    {\n    \tfor(j\u003d0;j\u0026lt;nodes[i].size()-1;j++)\n    \t{\n    \t\tif(nodes[i][j]\u003d\u003dnodes[i][j+1]+1)\n    \t\t\tcontinue;\n    \t\telse if(m1.find(mp(nodes[i][j],nodes[i][j+1]))!\u003dm1.end())\n    \t\t{\n    \t\t\tv[m1[mp(nodes[i][j],nodes[i][j+1])]].pb(i+1);\n    \t\t\tv[i+1].pb(m1[mp(nodes[i][j],nodes[i][j+1])]);\n    \t\t\tm1.erase(mp(nodes[i][j],nodes[i][j+1]));\n    \t\t}\n    \t\telse\n    \t\t{\n    \t\t\tm1[mp(nodes[i][j],nodes[i][j+1])]\u003di+1;\n    \t\t}\n    \t}\n    \tj\u003dnodes[i].size()-1;\n    \tif(nodes[i][0]!\u003dn||nodes[i][j]!\u003d1)\n    \t{\n    \t\tif(m1.find(mp(nodes[i][0],nodes[i][j]))!\u003dm1.end())\n    \t\t{\n    \t\t\tv[m1[mp(nodes[i][0],nodes[i][j])]].pb(i+1);\n    \t\t\tv[i+1].pb(m1[mp(nodes[i][0],nodes[i][j])]);\n    \t\t\tm1.erase(mp(nodes[i][0],nodes[i][j]));\n    \t\t}\n    \t\telse\n    \t\t{\n    \t\t\tm1[mp(nodes[i][0],nodes[i][j])]\u003di+1;\n    \t\t}\n    \t}\n    }\n    for(i\u003d1;i\u0026lt;\u003dn;i++)\n    \tlevel[i]\u003d1e6;\n    int cen\u003ddecompose(1);\n\t//printf(\u0026quot;%d\\n\u0026quot;,cen );\n\tqueue\u0026lt;int\u0026gt;q;\n\ti\u003d0;\n\tq.push(cen);\n\twhile(!q.empty())\n\t{\n\t\tj\u003dq.size();\n\t\twhile(j--)\n\t\t{\n\t\t\tint z\u003dq.front();\n\t\t\tq.pop();\n\t\t\tlevel[z]\u003di;\n\t\t\tfor(int l\u003d0;l\u0026lt;v2[z].size();l++)\n\t\t\t{\n\t\t\t\tif(level[v2[z][l]]\u003d\u003d1e6)\n\t\t\t\t{\n\t\t\t\t\tq.push(v2[z][l]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\ti++;\n\t}\n\tfor(i\u003d1;i\u0026lt;\u003dk;i++){\n\t\t//printf(\u0026quot;%d %d\\n\u0026quot;,v2[i].size(),level[i] );\n\t\tprintf(\u0026quot;%d\u0026quot;,level[i]+1 );\n\t\tif(i!\u003dk)\n\t\tprintf(\u0026quot; \u0026quot;);\n\t}\n\tprintf(\u0026quot;\\n\u0026quot;);\n    return 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"776G\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eCode\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include\u0026lt;bits/stdc++.h\u0026gt;\nusing namespace std;\n#define sd(x) scanf(\u0026quot;%lld\u0026quot;,\u0026amp;x)\n#define slld(x) scanf(\u0026quot;%lld\u0026quot;,\u0026amp;x)\n#define ss(x) scanf(\u0026quot;%s\u0026quot;,x)\n#define ll long long\n#define mod 65536\n#define bitcount    __builtin_popcountll\n#define pb push_back\n#define fi first\n#define se second\n#define mp make_pair\n#define pi pair\u0026lt;int,int\u0026gt;\nll dp[17][65538][17];\nchar a[20];\nll b[20];\nll mo[1100005];\nll f(ll m,ll p,ll pos)\n{\n\tif(dp[m][p][pos]!\u003d-1)\n\t\treturn dp[m][p][pos];\n\tif(pos\u003d\u003d0)\n\t{\n\t\tif(((1\u0026lt;\u0026lt;m)\u0026amp;p))\n\t\t\tdp[m][p][pos]\u003d1;\n\t\telse\n\t\t\tdp[m][p][pos]\u003d0;\n\t\treturn dp[m][p][pos];\n\t}\n\tll j\u003d0;\n\tfor(ll i\u003d0;i\u0026lt;\u003d15;i++)\n\t{\n\t\tj+\u003df(max(m,i),mo[p*16+i],pos-1);\n\t}\n\treturn dp[m][p][pos]\u003dj;\n}\nint main()\n{\n    //freopen(\u0026quot;in.txt\u0026quot;,\u0026quot;r\u0026quot;,stdin);\n    //freopen(\u0026quot;out.txt\u0026quot;,\u0026quot;w\u0026quot;,stdout);\n\tll t,n,i,j,k,l,r,m,p,ans1;\n\tmo[0]\u003d0;\n\tfor(i\u003d1;i\u0026lt;\u003d1100000;i++)\n\t{\n\t\tmo[i]\u003dmo[i-1]+1;\n\t\tif(mo[i]\u003d\u003dmod)\n\t\t\tmo[i]\u003d0;\n\t}\n\tmemset(dp,-1,sizeof dp);\n\tf(0,0,16);\n\tsd(t);\n\twhile(t--)\n\t{\n\t\tss(a);\n\t\tn\u003dstrlen(a);\n\t\tl\u003d0;\n\t\tfor(i\u003d0;i\u0026lt;n;i++)\n\t\t{\n\t\t\tl\u003dl*16;\n\t\t\tif(a[i]\u0026gt;\u003d\u00270\u0027\u0026amp;\u0026amp;a[i]\u0026lt;\u003d\u00279\u0027)\n\t\t\t\tl+\u003da[i]-\u00270\u0027;\n\t\t\telse\n\t\t\t\tl+\u003da[i]-\u0027a\u0027+10;\n\t\t}\n\t\tans1\u003d0;\n\t\tif(l\u0026gt;0)\n\t\t{\n\t\t\tl--;\n\t\t\tj\u003dl;\n\t\t\tfor(i\u003d0;i\u0026lt;n;i++)\n\t\t\t{\n\t\t\t\tb[i]\u003dj%16;\n\t\t\t\tj/\u003d16;\n\t\t\t}\n\t\t\tm\u003dp\u003d0;\n\t\t\tfor(j\u003dn-1;j\u0026gt;\u003d0;j--)\n\t\t\t{\n\t\t\t\tfor(k\u003d0;k\u0026lt;b[j];k++)\n\t\t\t\t\tans1-\u003ddp[max(m,k)][mo[p*16+k]][j];\n\t\t\t\tm\u003dmax(m,b[j]);\n\t\t\t\tp\u003dmo[p*16+b[j]];\n\t\t\t}\n\t\t\tans1-\u003ddp[m][p][0];\n\t\t}\n\t\tss(a);\n\t\tn\u003dstrlen(a);\n\t\tr\u003d0;\n\t\tfor(i\u003d0;i\u0026lt;n;i++)\n\t\t{\n\t\t\tr\u003dr*16;\n\t\t\tif(a[i]\u0026gt;\u003d\u00270\u0027\u0026amp;\u0026amp;a[i]\u0026lt;\u003d\u00279\u0027)\n\t\t\t\tr+\u003da[i]-\u00270\u0027;\n\t\t\telse\n\t\t\t\tr+\u003da[i]-\u0027a\u0027+10;\n\t\t}\n\t\tj\u003dr;\n\t\tfor(i\u003d0;i\u0026lt;n;i++)\n\t\t{\n\t\t\tb[i]\u003dj%16;\n\t\t\tj/\u003d16;\n\t\t}\n\t\tm\u003dp\u003d0;\n\t\tfor(j\u003dn-1;j\u0026gt;\u003d0;j--)\n\t\t{\n\t\t\tfor(k\u003d0;k\u0026lt;b[j];k++)\n\t\t\t\tans1+\u003ddp[max(m,k)][mo[p*16+k]][j];\n\t\t\tm\u003dmax(m,b[j]);\n\t\t\tp\u003dmo[p*16+b[j]];\n\t\t}\n\t\tans1+\u003ddp[m][p][0];\n\t\tprintf(\u0026quot;%lld\\n\u0026quot;,ans1);\n\t}\n    return 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e","tags":["#editorial"]}}