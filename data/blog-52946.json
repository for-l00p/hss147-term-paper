{"status":"OK","result":{"originalLocale":"en","allowViewHistory":true,"creationTimeSeconds":1498601757,"rating":200,"authorHandle":"adedalic","modificationTimeSeconds":1498660528,"id":52946,"title":"\u003cp\u003eCodeforces Round #421 Editorial\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eFirst, I apologize for problems with round and serious problem with Div1A/Div2C. It was very important round for me and, as always, something goes wrong. \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/KAN\" title\u003d\"Grandmaster KAN\"\u003eKAN\u003c/a\u003e have already \u003ca href\u003d\"//codeforces.com/blog/entry/52944\"\u003ewrote about this\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eAnyway, there are problems, so editorial must exists. Due some circumstances, Editorial will be upload in parts. Also, most of tutorials will contain main ideas how to solve task, not ready algorithm.\u003c/p\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"820A\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003ecode\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#define fore(i, l, r) for(int i \u003d int(l); i \u0026lt; int(r); i++)\n#define forn(i, n) fore(i, 0, n)\n\nint c, l, v0, v1, a;\n\ninline bool read() {\n\tif(!(cin \u0026gt;\u0026gt; c \u0026gt;\u0026gt; v0 \u0026gt;\u0026gt; v1 \u0026gt;\u0026gt; a \u0026gt;\u0026gt; l))\n\t\treturn false;\n\t\n\treturn true;\n}\n\ninline void solve() {\n\tint pos \u003d v0;\n\tint t \u003d 1;\n\t\n\tint add \u003d v0;\n\t\n\twhile(pos \u0026lt; c) {\n\t\tadd \u003d min(v1, add + a);\n\t\t\n\t\tpos +\u003d add - l;\n\t\tt++;\n\t}\n\t\n\tcout \u0026lt;\u0026lt; t \u0026lt;\u0026lt; endl;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"820B\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003ecode\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003eint n, a;\n\ninline bool read() {\n\tif(!(cin \u0026gt;\u0026gt; n \u0026gt;\u0026gt; a))\n\t\treturn false;\n\t\n\treturn true;\n}\n\ninline void solve() {\n\tint base \u003d n * a / 180;\n\tbase \u003d max(1, min(n - 2, base));\n\t\n\tint bk \u003d base;\n\tfor(int ck \u003d max(1, base - 2); ck \u0026lt;\u003d min(n - 2, base + 2); ck++) {\n\t\tif(abs(180 * ck - n * a) \u0026lt; abs(180 * bk - n * a))\n\t\t\tbk \u003d ck;\n\t}\n\t\n\tcout \u0026lt;\u0026lt; 2 \u0026lt;\u0026lt; \u0026quot; \u0026quot; \u0026lt;\u0026lt; 1 \u0026lt;\u0026lt; \u0026quot; \u0026quot; \u0026lt;\u0026lt; bk + 2 \u0026lt;\u0026lt; endl;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"819A\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003ecode\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"819B\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003ecode\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#define fore(i, l, r) for(int i \u003d int(l); i \u0026lt; int(r); i++)\n#define forn(i, n) fore(i, 0, n)\n\ntypedef long long li;\n\nconst int N \u003d 1000 * 1000 + 555;\n\nint n, p[N];\n\ninline bool read() {\n\tif(!(cin \u0026gt;\u0026gt; n))\n\t\treturn false;\n\tforn(i, n)\n\t\tassert(scanf(\u0026quot;%d\u0026quot;, \u0026amp;p[i]) \u003d\u003d 1);\n\treturn true;\n}\n\nli sum[N], df[N], res[N];\n\ninline void add(int lf, int rg, int k, int b) {\n\tif(lf \u0026gt; rg)\n\t\treturn;\n\t\t\t\t\n\tsum[lf] +\u003d b;\n\tdf[lf] +\u003d k;\n\t\n\tsum[rg + 1] -\u003d b + k * 1ll * (rg - lf);\n\tdf[rg] -\u003d k;\n}\n\ninline void calc() {\n\tli curdf \u003d 0;\n\tforn(i, n) {\n\t\tsum[i] +\u003d curdf;\n\t\tcurdf +\u003d df[i];\n\t}\n\t\n\tli cursm \u003d 0;\n\tforn(i, n) {\t\n\t\tcursm +\u003d sum[i];\n\t\tres[i] +\u003d cursm;\n\t}\n}\n\ninline void solve() {\n\tmemset(sum, 0, sizeof sum);\n\tmemset(df, 0, sizeof df);\n\tmemset(res, 0, sizeof res);\n\t\n\tforn(i, n) {\n\t\tint c1 \u003d i + 1, p1 \u003d 0;\n\t\tint c2 \u003d n,     p2 \u003d p1 + c2 - c1;\n\t\tint c3 \u003d i,     p3 \u003d p2 + c3;\n\t\t\n\t\tif(p[i] \u0026lt;\u003d c3) {\n\t\t\tadd(p1, p2, 1, c1 - p[i]);\n\t\t\tadd(p2 + 1, p2 + p[i], -1, p[i] - 1);\n\t\t\tadd(p2 + p[i] + 1, p3, 1, 1);\n\t\t} else {\n\t\t\tadd(p1, p1 + p[i] - c1, -1, p[i] - c1);\n\t\t\tadd(p1 + p[i] - c1 + 1, p2, 1, 1);\n\t\t\tadd(p2 + 1, p3, -1, p[i] - 1);\n\t\t}\n\t}\n\t\n\tcalc();\n\t\n\tint ans \u003d 0;\n\tforn(i, n)\n\t\tif(res[ans] \u0026gt; res[i])\n\t\t\tans \u003d i;\n\t\t\t\n\tcout \u0026lt;\u0026lt; res[ans] \u0026lt;\u0026lt; \u0026quot; \u0026quot; \u0026lt;\u0026lt; ans \u0026lt;\u0026lt; endl;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"819C\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003ecode\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#define fore(i, l, r) for(int i \u003d int(l); i \u0026lt; int(r); i++)\n#define forn(i, n) fore(i, 0, n)\n\n#define all(a) (a).begin(), (a).end()\n#define sqr(a) ((a) * (a))\n#define sz(a) int(a.size())\n#define mp make_pair\n#define pb push_back\n\ntypedef long long li;\ntypedef pair\u0026lt;int, int\u0026gt; pt;\ntypedef pair\u0026lt;li, li\u0026gt; ptl;\n\nconst int INF \u003d int(1e9);\nconst li INF64 \u003d li(INF) * INF;\n\nint n[3], m[3], s[3];\n\ninline bool read() {\n\tif(scanf(\u0026quot;%d %d %d\u0026quot;, \u0026amp;n[0], \u0026amp;n[1], \u0026amp;n[2]) !\u003d 3)\n\t\treturn false;\n\tforn(i, 3)\n\t\tassert(scanf(\u0026quot;%d\u0026quot;, \u0026amp;m[i]) \u003d\u003d 1);\n\tforn(i, 3)\n\t\tassert(scanf(\u0026quot;%d\u0026quot;, \u0026amp;s[i]) \u003d\u003d 1);\n\treturn true;\n}\n\nconst int N \u003d 2 * 1000 * 1000 + 55;\nint ls[N];\n\ninline void precalc() {\n\tmemset(ls, -1, sizeof ls);\n\t\n\tls[0] \u003d ls[1] \u003d 1;\n\tfore(i, 2, N) {\n\t\tif(ls[i] !\u003d -1)\n\t\t\tcontinue;\n\t\t\t\n\t\tls[i] \u003d i;\n\t\tfor(li j \u003d i * 1ll * i; j \u0026lt; N; j +\u003d i)\n\t\t\tif(ls[j] \u003d\u003d -1)\n\t\t\t\tls[j] \u003d i;\n\t}\n}\n\ninline vector\u0026lt;pt\u0026gt; fact(int n[3]) {\n\tvector\u0026lt;int\u0026gt; divs;\n\t\n\tforn(i, 3) {\n\t\tint cur \u003d n[i];\n\t\twhile(ls[cur] !\u003d cur) {\n\t\t\tdivs.pb(ls[cur]);\n\t\t\tcur /\u003d ls[cur];\n\t\t}\n\t\tif(cur \u0026gt; 1)\n\t\t\tdivs.pb(cur);\n\t}\n\t\n\tsort(all(divs));\n\tvector\u0026lt;pt\u0026gt; ans;\n\t\n\tint u \u003d 0;\n\twhile(u \u0026lt; sz(divs)) {\n\t\tint v \u003d u;\n\t\twhile(v \u0026lt; sz(divs) \u0026amp;\u0026amp; divs[v] \u003d\u003d divs[u])\n\t\t\tv++;\n\t\t\n\t\tans.pb(mp(divs[u], v - u));\n\t\tu \u003d v;\n\t}\n\t\n\treturn ans;\n}\n\nli ans;\n\nli nn, mm, ss;\nvector\u0026lt;pt\u0026gt; fs;\nvector\u0026lt;li\u0026gt; bad;\n\nvoid calcDivs(int pos, li val) {\n\tif(pos \u0026gt;\u003d sz(fs)) {\n\t\tans +\u003d (val \u0026lt;\u003d nn);\n\t\treturn;\n\t}\n\t\n\tli cv \u003d 1;\n\tforn(i, fs[pos].y + 1) {\n\t\tcalcDivs(pos + 1, val * cv);\n\t\t\n\t\tcv *\u003d fs[pos].x;\n\t}\n}\n\nvoid calcInEx(int pos, li val, int cnt) {\n\tif(pos \u0026gt;\u003d sz(bad)) {\n\t\tli k \u003d cnt ? -1 : 1;\n\t\t\n\t\tans +\u003d k * (mm / val);\n\t\treturn;\n\t}\n\t\n\tcalcInEx(pos + 1, val, cnt);\n\tcalcInEx(pos + 1, val * bad[pos], cnt ^ 1);\n}\n\ninline void solve() {\n\tans \u003d 0;\n\ts[0] *\u003d 2;\n\t\n\tnn \u003d n[0] * 1ll * n[1] * 1ll * n[2];\n\tmm \u003d m[0] * 1ll * m[1] * 1ll * m[2];\n\tss \u003d s[0] * 1ll * s[1] * 1ll * s[2];\n\t\n\tfs \u003d fact(s);\n\tcalcDivs(0, 1);\n\t\n\tbad.clear();\n\tvector\u0026lt;pt\u0026gt; fn \u003d fact(n);\n\t\n\tforn(i, sz(fn)) {\n\t\tli cv \u003d fn[i].x;\n\t\tforn(k, fn[i].y) {\n\t\t\tif(ss % cv !\u003d 0) {\n\t\t\t\tbad.pb(cv);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcv *\u003d fn[i].x;\n\t\t}\n\t}\n\t\n\tcalcInEx(0, 1, 0);\n\t\n\tprintf(\u0026quot;%I64d\\n\u0026quot;, ans);\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"819D\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003ecode\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#define fore(i, l, r) for(int i \u003d int(l); i \u0026lt; int(r); i++)\n#define forn(i, n) fore(i, 0, n)\n\n#define all(a) (a).begin(), (a).end()\n#define sqr(a) ((a) * (a))\n#define sz(a) int(a.size())\n#define mp make_pair\n#define pb push_back\n\n#define x first\n#define y second\n\ntypedef long long li;\ntypedef long double ld;\ntypedef pair\u0026lt;int, int\u0026gt; pt;\n\nconst int INF \u003d int(1e9);\nconst li INF64 \u003d li(INF) * INF;\n\nint gcd(int a, int b) {\n\tif(a \u003d\u003d 0)\n\t\treturn b;\n\treturn gcd(b % a, a);\n}\n\nint exgcd(int a, li \u0026amp;x, int b, li \u0026amp;y) {\n\tif(a \u003d\u003d 0) {\n\t\tx \u003d 0, y \u003d 1;\n\t\treturn b;\n\t}\n\t\n\tli xx, yy;\n\tint g \u003d exgcd(b % a, xx, a, yy);\n\t\n\tx \u003d yy - b / a * xx;\n\ty \u003d xx;\n\t\n\treturn g;\n}\n\nconst int N \u003d 200 * 1000 + 555;\nint t, n, a[N];\n\ninline bool read() {\n\tif(!(cin \u0026gt;\u0026gt; t \u0026gt;\u0026gt; n))\n\t    return false;\n\tforn(i, n)\n\t\tassert(scanf(\u0026quot;%d\u0026quot;, \u0026amp;a[i]) \u003d\u003d 1);\n\treturn true;\n}\n\nint pf[N], s;\n\ninline li up(li a, li b) {\n\treturn (a + b - 1) / b;\n}\n\ninline int findPos(int a, int b, int c) {\n\tli x, y;\n\tint g \u003d exgcd(a, x, b, y);\n\tassert(c % g \u003d\u003d 0);\n\t\n\tx *\u003d +c / g;\n\ty *\u003d -c / g;\n\tassert(a * 1ll * x - b * 1ll * y \u003d\u003d c);\n\t\n\tint ag \u003d a / g;\n\tint bg \u003d b / g;\n\t\n\tli k \u003d 0;\n\tif(x \u0026lt; 0)\n\t\tk \u003d up(-x, bg);\n\tif(x \u0026gt;\u003d bg)\n\t\tk \u003d -up(x - bg, bg);\t\n\tx +\u003d bg * k;\n\ty +\u003d ag * k;\n\t\t\n\tassert(0 \u0026lt;\u003d x \u0026amp;\u0026amp; x \u0026lt; bg);\n\t\n\tk \u003d 0;\n\tif(y \u0026lt; 0)\n\t\tk \u003d up(-y, ag);\n\tx +\u003d bg * k;\n\ty +\u003d ag * k;\n\n\treturn x;\n}\n\nmap\u0026lt; int, set\u0026lt;pt\u0026gt; \u0026gt; cycle;\n\nint ans[N];\n\ninline void solve() {\n\tcycle.clear();\n\tpf[0] \u003d 0;\n\tfore(i, 1, n)\n\t\tpf[i] \u003d (pf[i - 1] + a[i]) % t;\n\t\n\ts \u003d (a[0] + pf[n - 1]) % t;\n\tint g \u003d gcd(s, t);\n\t\n\tforn(i, n) {\n\t\tint st \u003d pf[i] % g;\n\t\tauto\u0026amp; cc \u003d cycle[st];\n\t\t\n\t\tint pos \u003d findPos(s, t, pf[i] - st);\n\t\t\n\t\tif(cc.empty()) {\n\t\t\tans[i] +\u003d t / g;\n\t\t\tcc.insert(pt(pos, -i));\n\t\t} else {\n\t\t\tauto rg \u003d cc.lower_bound(pt(pos, -i));\n\t\t\tif(rg \u003d\u003d cc.end()) {\n\t\t\t\tans[i] +\u003d t / g - pos;\n\t\t\t\trg \u003d cc.begin();\n\t\t\t\tans[i] +\u003d rg-\u0026gt;x;\n\t\t\t} else\n\t\t\t\tans[i] +\u003d rg-\u0026gt;x - pos;\n\t\t\t\t\n\t\t\tauto lf \u003d cc.lower_bound(pt(pos, -i));\n\t\t\tif(lf \u003d\u003d cc.begin())\n\t\t\t\tlf \u003d --cc.end();\n\t\t\telse\n\t\t\t\tlf--;\n\t\t\tans[ -(lf-\u0026gt;y) ] -\u003d ans[i];\n\t\t\t\n\t\t\tcc.insert(pt(pos, -i));\n\t\t} \n\t}\n\t\n\tforn(i, n)\n\t\tprintf(\u0026quot;%d \u0026quot;, ans[i]);\n\tputs(\u0026quot;\u0026quot;);\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"819E\"\u003eTutorial is loading...\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003ecode\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\nusing ll \u003d long long;\nusing ld \u003d long double;\nusing D \u003d double;\nusing uint \u003d unsigned int;\ntemplate\u0026lt;typename T\u0026gt;\nusing pair2 \u003d pair\u0026lt;T, T\u0026gt;;\n\n#ifdef WIN32\n    #define LLD \u0026quot;%I64d\u0026quot;\n#else\n    #define LLD \u0026quot;%lld\u0026quot;\n#endif\n\n#define pb push_back\n#define mp make_pair\n#define all(x) (x).begin(),(x).end()\n#define fi first\n#define se second\n\nconst int maxn \u003d 305;\n\nint pair3[maxn];\nint n;\nvector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt; answer;\n\nvoid add3(int a, int b, int c)\n{\n    answer.pb({a, b, c});\n}\n\nvoid add4(int a, int b, int c, int d)\n{\n    answer.pb({a, b, c, d});\n}\n\nint main()\n{\n    cin \u0026gt;\u0026gt; n;\n    if (n % 2 \u003d\u003d 0)\n    {\n        pair3[0] \u003d 3; // 0 1 3\n        pair3[2] \u003d 1; // 2 3 1\n        add3(0, 1, 2);\n        add3(2, 3, 0);\n        for (int i \u003d 4; i \u0026lt; n; i +\u003d 2)\n        {\n            add4(0, pair3[0], 1, i);\n            add3(i, i + 1, 0);\n            pair3[i] \u003d 1;\n            pair3[0] \u003d i + 1;\n            for (int j \u003d 2; j \u0026lt; i; j +\u003d 2)\n            {\n                add4(j, pair3[j], j + 1, i);\n                add4(j, i, j + 1, i + 1);\n                pair3[j] \u003d i + 1;\n            }\n        }\n        for (int i \u003d 0; i \u0026lt; n; i +\u003d 2)\n        {\n            add3(i, i + 1, pair3[i]);\n        }\n    } else\n    {\n        pair3[1] \u003d 0; // 1 2 0\n        add3(0, 1, 2);\n        for (int i \u003d 3; i \u0026lt; n; i +\u003d 2)\n        {\n            add3(i, i + 1, 0);\n            pair3[i] \u003d 0;\n            for (int j \u003d 1; j \u0026lt; i; j +\u003d 2)\n            {\n                add4(j, pair3[j], j + 1, i);\n                add4(j, i, j + 1, i + 1);\n                pair3[j] \u003d i + 1;\n            }\n        }\n        for (int i \u003d 1; i \u0026lt; n; i +\u003d 2)\n        {\n            add3(i, i + 1, pair3[i]);\n        }\n    }\n    printf(\u0026quot;%d\\n\u0026quot;, (int)answer.size());\n    for (auto \u0026amp;t : answer)\n    {\n        printf(\u0026quot;%d\u0026quot;, (int)t.size());\n        for (auto t2 : t) printf(\u0026quot; %d\u0026quot;, t2 + 1);\n        printf(\u0026quot;\\n\u0026quot;);\n    }\n    return 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e","tags":[]}}