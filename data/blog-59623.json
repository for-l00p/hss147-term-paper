{"status":"OK","result":{"originalLocale":"ru","allowViewHistory":true,"creationTimeSeconds":1526997230,"rating":80,"authorHandle":"PikMike","modificationTimeSeconds":1526997486,"id":59623,"title":"\u003cp\u003eEducational Codeforces Round 44 Editorial\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003e\u003ca href\u003d\"/contest/985/problem/A\" title\u003d\"Educational Codeforces Round 44 (Rated for Div. 2)\"\u003e985A - Chess Placing\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"985A\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (Vovuh)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\nint main() {\n\tint n;\n\tcin \u0026gt;\u0026gt; n;\n\tvector\u0026lt;int\u0026gt; pos(n / 2);\n\tfor (int i \u003d 0; i \u0026lt; n / 2; ++i)\n\t\tcin \u0026gt;\u0026gt; pos[i];\n\tsort(pos.begin(), pos.end());\n\t\n\tint ans1 \u003d 0, ans2 \u003d 0;\n\tfor (int i \u003d 0; i \u0026lt; n / 2; ++i) {\n\t\tans1 +\u003d abs(pos[i] - (i * 2 + 1));\n\t\tans2 +\u003d abs(pos[i] - (i * 2 + 2));\n\t}\n\t\n\tcout \u0026lt;\u0026lt; min(ans1, ans2) \u0026lt;\u0026lt; endl;\n\t\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/985/problem/B\" title\u003d\"Educational Codeforces Round 44 (Rated for Div. 2)\"\u003e985B - Switches and Lamps\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"985B\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (Vovuh)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\nint main() {\n\tint n, m;\n\tcin \u0026gt;\u0026gt; n \u0026gt;\u0026gt; m;\n\tvector\u0026lt;string\u0026gt; s(n);\n\tvector\u0026lt;int\u0026gt; cnt(m);\n\tfor (int i \u003d 0; i \u0026lt; n; ++i) {\n\t\tcin \u0026gt;\u0026gt; s[i];\n\t\tfor (int j \u003d 0; j \u0026lt; m; ++j)\n\t\t\tif (s[i][j] \u003d\u003d \u00271\u0027) ++cnt[j];\n\t}\n\t\n\tfor (int i \u003d 0; i \u0026lt; n; ++i) {\n\t\tbool ok \u003d true;\n\t\tfor (int j \u003d 0; j \u0026lt; m; ++j) {\n\t\t\tif (s[i][j] \u003d\u003d \u00271\u0027 \u0026amp;\u0026amp; cnt[j] \u003d\u003d 1)\n\t\t\t\tok \u003d false;\n\t\t}\n\t\tif (ok) {\n\t\t\tputs(\u0026quot;YES\u0026quot;);\n\t\t\treturn 0;\n\t\t}\n\t}\n\t\n\tputs(\u0026quot;NO\u0026quot;);\n\t\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/985/problem/C\" title\u003d\"Educational Codeforces Round 44 (Rated for Div. 2)\"\u003e985C - Liebig\u0027s Barrels\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"985C\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (adedalic)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include\u0026lt;bits/stdc++.h\u0026gt;\n\nusing namespace std;\n\n#define fore(i, l, r) for(int i \u003d int(l); i \u0026lt; int(r); i++)\n\ntypedef long long li;\n\nint n, k, l, m;\nvector\u0026lt;li\u0026gt; a;\n\ninline bool read() {\n\tif(!(cin \u0026gt;\u0026gt; n \u0026gt;\u0026gt; k \u0026gt;\u0026gt; l))\n\t\treturn false;\n\tm \u003d n * k;\n\ta.assign(m, 0);\n\tfore(i, 0, m)\n\t\tassert(scanf(\u0026quot;%lld\u0026quot;, \u0026amp;a[i]) \u003d\u003d 1);\n\treturn true;\n}\n\ninline void solve() {\n\tsort(a.begin(), a.end());\n\tint rg \u003d int(upper_bound(a.begin(), a.end(), a[0] + l) - a.begin());\n\t\n\tif(rg \u0026lt; n) {\n\t\tputs(\u0026quot;0\u0026quot;);\n\t\treturn;\n\t}\n\tli ans \u003d 0;\n\t\n\tint u \u003d 0;\n\tfore(i, 0, n) {\n\t\tans +\u003d a[u++];\n\t\t\n\t\tfore(j, 0, k - 1) {\n\t\t\tif(rg - u \u0026gt; n - i - 1)\n\t\t\t\tu++;\n\t\t\telse\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tcout \u0026lt;\u0026lt; ans \u0026lt;\u0026lt; endl;\n}\n\nint main() {\n#ifdef _DEBUG\n\tfreopen(\u0026quot;input.txt\u0026quot;, \u0026quot;r\u0026quot;, stdin);\n\tint tt \u003d clock();\n#endif\n\tcerr \u0026lt;\u0026lt; fixed \u0026lt;\u0026lt; setprecision(15);\n\t\n\tif(read()) {\n\t\tsolve();\n\t\n#ifdef _DEBUG\n\t\tcerr \u0026lt;\u0026lt; \u0026quot;TIME \u003d \u0026quot; \u0026lt;\u0026lt; clock() - tt \u0026lt;\u0026lt; endl;\n\t\ttt \u003d clock();\n#endif\n\t}\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/985/problem/D\" title\u003d\"Educational Codeforces Round 44 (Rated for Div. 2)\"\u003e985D - Sand Fortress\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"985D\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (PikMike)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\n#define forn(i, n) for (int i \u003d 0; i \u0026lt; int(n); i++)\n\ntypedef long long li;\n\nusing namespace std;\n\nconst int INF \u003d 2e9;\nli n, h;\n\nbool check(li maxh){\n\tli k \u003d min(h, maxh);\n\tli cnt \u003d maxh * maxh - k * (k - 1) / 2;\n\treturn (cnt \u0026lt;\u003d n);\n}\n\nli get(li maxh){\n\tli k \u003d min(h, maxh);\n\tli cnt \u003d maxh * maxh - k * (k - 1) / 2;\n\tli len \u003d (2 * maxh - 1) - (k - 1);\n\tn -\u003d cnt;\n\treturn len + (n + maxh - 1) / maxh;\n}\n\nint main() {\n\tscanf(\u0026quot;%lld%lld\u0026quot;, \u0026amp;n, \u0026amp;h);\n\tli l \u003d 1, r \u003d INF;\n\t\n\twhile (l \u0026lt; r - 1){\n\t\tli m \u003d (l + r) / 2;\n\t\t\n\t\tif (check(m))\n\t\t\tl \u003d m;\n\t\telse\n\t\t\tr \u003d m;\n\t}\n\t\n\tprintf(\u0026quot;%lld\\n\u0026quot;, check(r) ? get(r) : get(l));\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/985/problem/E\" title\u003d\"Educational Codeforces Round 44 (Rated for Div. 2)\"\u003e985E - Pencils and Boxes\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"985E\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (PikMike)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n \nusing namespace std;\n \n#define forn(i, n) for(int i \u003d 0; i \u0026lt; int(n); i++) \n\nconst int N \u003d 500 * 1000 + 13;\n\nint f[N];\n\nvoid upd(int x){\n    for (int i \u003d x; i \u0026lt; N; i |\u003d i + 1)\n        ++f[i];\n}\n\nint sum(int x){\n    int res \u003d 0;\n    for (int i \u003d x; i \u0026gt;\u003d 0; i \u003d (i \u0026amp; (i + 1)) - 1)\n        res +\u003d f[i];\n    return res;\n}\n\nint get(int l, int r){\n\tif (l \u0026gt; r) return 0;\n\treturn sum(r) - sum(l - 1);\n}\n\nint main(){\n\tint n, k, dif;\n\tscanf(\u0026quot;%d%d%d\u0026quot;, \u0026amp;n, \u0026amp;k, \u0026amp;dif);\n\tvector\u0026lt;int\u0026gt; a(n);\n\tforn(i, n)\n\t\tscanf(\u0026quot;%d\u0026quot;, \u0026amp;a[i]);\n\tsort(a.begin(), a.end());\n\t\n\tvector\u0026lt;int\u0026gt; dp(n + 1, 0);\n\t\n\tdp[0] \u003d 1;\n\tupd(0);\n\t\n\tint l \u003d 0;\n\tforn(i, n){\n\t\twhile (l \u0026lt; i \u0026amp;\u0026amp; a[i] - a[l] \u0026gt; dif)\n\t\t\t++l;\n\t\tdp[i + 1] \u003d (get(l, i - k + 1) \u0026gt;\u003d 1);\n\t\tif (dp[i + 1]) upd(i + 1);\n\t}\n\t\n\tputs(dp[n] ? \u0026quot;YES\u0026quot; : \u0026quot;NO\u0026quot;);\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/985/problem/F\" title\u003d\"Educational Codeforces Round 44 (Rated for Div. 2)\"\u003e985F - Isomorphic Strings\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"985F\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (adedalic)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\n#define fore(i, l, r) for(int i \u003d int(l); i \u0026lt; int(r); i++)\n#define sz(a) int(a.size())\n\n#define x first\n#define y second\n\nusing namespace std;\n\nconst int B \u003d 2;\n\ntypedef array\u0026lt;int, B\u0026gt; ht;\n\nht MOD, BASE;\n\ninline int norm(int a, const int \u0026amp;MOD) {\n\twhile(a \u0026gt;\u003d MOD)\n\t\ta -\u003d MOD;\n\twhile(a \u0026lt; 0)\n\t\ta +\u003d MOD;\n\treturn a;\n}\n\ninline int mul(int a, int b, const int \u0026amp;MOD) {\n\treturn int(a * 1ll * b % MOD);\n}\n\ninline ht operator +(const ht \u0026amp;a, const ht \u0026amp;b) {\n\tht ans;\n\tfore(i, 0, sz(ans))\n\t\tans[i] \u003d norm(a[i] + b[i], MOD[i]);\n\treturn ans;\n}\n\ninline ht operator -(const ht \u0026amp;a, const ht \u0026amp;b) {\n\tht ans;\n\tfore(i, 0, sz(ans))\n\t\tans[i] \u003d norm(a[i] - b[i], MOD[i]);\n\treturn ans;\n}\n\ninline ht operator *(const ht \u0026amp;a, const ht \u0026amp;b) {\n\tht ans;\n\tfore(i, 0, sz(ans))\n\t\tans[i] \u003d mul(a[i], b[i], MOD[i]);\n\treturn ans;\n}\n\nint CMODS[] \u003d {int(1e9) + 7, int(1e9) + 9, int(1e9) + 21, int(1e9) + 33, int(1e9) + 87, int(1e9) + 93, int(1e9) + 97, int(1e9) + 103};\nint CBASE[] \u003d {1009, 1013, 1019, 1021};\n\nconst int N \u003d 200 * 1000 + 555;\n\nint n, m;\nchar s[N];\nint x[N], y[N], len[N];\n\ninline bool read() {\n\tif(!(cin \u0026gt;\u0026gt; n \u0026gt;\u0026gt; m))\n\t\treturn false;\n\tassert(scanf(\u0026quot;%s\u0026quot;, s) \u003d\u003d 1);\n\t\n\tfore(i, 0, m) {\n\t\tassert(scanf(\u0026quot;%d%d%d\u0026quot;, \u0026amp;x[i], \u0026amp;y[i], \u0026amp;len[i]) \u003d\u003d 3);\n\t\tx[i]--, y[i]--;\n\t}\n\treturn true;\n}\nvoid setMods() {\n\tmt19937 rnd;\n\tunsigned int seed \u003d n;\n\tfore(i, 0, n)\n\t\tseed \u003d (seed * 3) + s[i];\n\tfore(i, 0, m) {\n\t\tseed \u003d (seed * 3) + x[i];\n\t\tseed \u003d (seed * 3) + y[i];\n\t\tseed \u003d (seed * 3) + len[i];\n\t}\n\trnd.seed(seed);\n\t\n\tset\u0026lt;int\u0026gt; mids;\n\twhile(sz(mids) \u0026lt; sz(MOD))\n\t\tmids.insert(rnd() % 8);\n\tvector\u0026lt;int\u0026gt; vmids(mids.begin(), mids.end());\n\tfore(i, 0, sz(MOD)) {\n\t\tMOD[i] \u003d CMODS[vmids[i]];\n\t\tBASE[i] \u003d CBASE[i];\n\t}\n}\n\nht pBase[N];\nht ph[27][N];\nvector\u0026lt;int\u0026gt; ord[N];\n\nht getHash(int id, int l, int r) {\n\treturn ph[id][r] - ph[id][l] * pBase[r - l];\n}\n\ninline void solve() {\n\tsetMods();\n\t\n\tpBase[0] \u003d {1, 1};\n\tfore(i, 1, N)\n\t\tpBase[i] \u003d pBase[i - 1] * BASE;\n\t\t\n\tfore(c, 0, 26) {\n\t\tph[c][0] \u003d {0, 0};\n\t\tfore(i, 0, n) {\n\t\t\tint val \u003d (s[i] \u003d\u003d c + \u0027a\u0027);\n\t\t\tph[c][i + 1] \u003d ph[c][i] * BASE + ht{val, val};\n\t\t}\n\t}\n\t\n\tvector\u0026lt;int\u0026gt; curOrd(26, 0);\n\tiota(curOrd.begin(), curOrd.end(), 0);\n\tfor(int i \u003d n - 1; i \u0026gt;\u003d 0; i--) {\n\t\tord[i] \u003d curOrd;\n\t\tauto it \u003d find(ord[i].begin(), ord[i].end(), int(s[i] - \u0027a\u0027));\n\t\tord[i].erase(it);\n\t\tord[i].insert(ord[i].begin(), int(s[i] - \u0027a\u0027));\n\t\tcurOrd \u003d ord[i];\n\t}\n\t\n\tfore(q, 0, m) {\n\t\tint s1 \u003d x[q], s2 \u003d y[q];\n\t\tbool ok \u003d true;\n\t\t\n\t\tfore(i, 0, 26) {\n\t\t\tif(getHash(ord[s1][i], s1, s1 + len[q]) !\u003d \n\t\t\t\tgetHash(ord[s2][i], s2, s2 + len[q])) {\n\t\t\t\tok \u003d false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tputs(ok ? \u0026quot;YES\u0026quot; : \u0026quot;NO\u0026quot;);\n\t}\n}\n\nint main(){\n#ifdef _DEBUG\n\tfreopen(\u0026quot;input.txt\u0026quot;, \u0026quot;r\u0026quot;, stdin);\n\t//freopen(\u0026quot;output.txt\u0026quot;, \u0026quot;w\u0026quot;, stdout);\n#endif\n\tif(read()) {\n\t\tsolve();\n\t}\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003ca href\u003d\"/contest/985/problem/G\" title\u003d\"Educational Codeforces Round 44 (Rated for Div. 2)\"\u003e985G - Team Players\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"985G\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution (adedalic)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\n#define fore(i, l, r) for(int i \u003d int(l); i \u0026lt; int(r); i++)\n#define sz(a) int(a.size())\n\nusing namespace std;\n\ntypedef unsigned long long uli;\n\nconst int N \u003d 200 * 1000 + 555;\n\nint n, m;\nuli a, b, c;\nvector\u0026lt;int\u0026gt; g[N];\n\ninline bool read() {\n\tif(!(cin \u0026gt;\u0026gt; n \u0026gt;\u0026gt; m))\n\t\treturn false;\n\tassert(cin \u0026gt;\u0026gt; a \u0026gt;\u0026gt; b \u0026gt;\u0026gt; c);\n\tfore(i, 0, m) {\n\t\tint u, v;\n\t\tassert(scanf(\u0026quot;%d%d\u0026quot;, \u0026amp;u, \u0026amp;v) \u003d\u003d 2);\n\t\t\n\t\tg[u].push_back(v);\n\t\tg[v].push_back(u);\n\t}\n\treturn true;\n}\n\nvector\u0026lt;uli\u0026gt; ps[N];\n\ninline uli getSum(int v, int l, int r) {\n\treturn ps[v][r] - ps[v][l];\n}\n\nconst int MX \u003d 700;\nint id[N];\n\nconst int B \u003d 1111;\nbitset\u0026lt;N\u0026gt; has[B];\nint szh \u003d 0;\n\ninline void solve() {\n\tmemset(id, -1, sizeof id);\n\tszh \u003d 0;\n\tfore(v, 0, n) {\n\t\tsort(g[v].begin(), g[v].end());\n\t\t\n\t\tps[v].assign(sz(g[v]) + 1, 0);\n\t\tfore(i, 0, sz(g[v]))\n\t\t\tps[v][i + 1] \u003d ps[v][i] + g[v][i];\n\t\t\n\t\tif(sz(g[v]) \u0026gt;\u003d MX) {\n\t\t\tassert(szh \u0026lt; B);\n\t\t\tid[v] \u003d szh++;\n\t\t\t\n\t\t\tfor(int to : g[v])\n\t\t\t\thas[id[v]][to] \u003d 1;\n\t\t}\n\t}\n\t\n\tuli all \u003d 0;\n\tfore(v, 0, n) {\n\t\tuli lw \u003d v, gr \u003d n - v - 1;\n\t\tall +\u003d a * v * (gr * (gr - 1) / 2);\n\t\tall +\u003d b * v * (lw * gr);\n\t\tall +\u003d c * v * (lw * (lw - 1) / 2);\n\t}\n\t\n\tuli sub1 \u003d 0;\n\tfore(v, 0, n) {\n\t\tfor(int to : g[v]) {\n\t\t\tif(to \u0026gt; v)\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tuli cnt \u003d to;\n\t\t\tuli sum \u003d cnt * (cnt - 1) / 2;\n\t\t\tsub1 +\u003d a * sum + cnt * (b * to + c * v);\n\t\t\t\n\t\t\tcnt \u003d v - to - 1;\n\t\t\tsum \u003d (2 * to + cnt + 1) * cnt / 2;\n\t\t\tsub1 +\u003d b * sum + cnt * (a * to + c * v);\n\t\t}\n\t\t\n\t\tuli sum \u003d 0;\n\t\tfore(i, 0, sz(g[v])) {\n\t\t\tif(g[v][i] \u0026gt; v)\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tuli cnt \u003d i;\n\t\t\tsub1 -\u003d a * sum + cnt * (b * g[v][i] + c * v);\n\t\t\tsum +\u003d g[v][i];\n\t\t}\n\t}\n\tall -\u003d sub1;\n\t\n\tuli sub2 \u003d 0;\n\tuli cntE \u003d 0, sumE \u003d 0;\n\tfore(v, 0, n) {\n\t\tsub2 +\u003d sumE + cntE * c * v;\n\t\tfor(int to : g[v]) {\n\t\t\tif(to \u0026gt; v)\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcntE++;\n\t\t\tsumE +\u003d a * to + b * v;\n\t\t}\n\t}\n\t\n\tfore(v, 0, n) {\n\t\tfor(int to : g[v]) {\n\t\t\tif(to \u0026gt; v)\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tint pos \u003d int(lower_bound(g[to].begin(), g[to].end(), to) - g[to].begin());\n\t\t\tsub2 -\u003d a * getSum(to, 0, pos) + pos * (b * to + c * v);\n\t\t\t\n\t\t\tint pos2 \u003d int(lower_bound(g[to].begin(), g[to].end(), v) - g[to].begin());\n\t\t\tsub2 -\u003d b * getSum(to, pos, pos2) + (pos2 - pos) * (a * to + c * v);\n\t\t}\n\t}\n\t\n\tvector\u0026lt;char\u0026gt; curh(n + 5, 0);\n\tfore(v, 0, n) {\n\t\tif(id[v] \u003d\u003d -1) {\n\t\t\tfore(i2, 0, sz(g[v])) {\n\t\t\t\tint u2 \u003d g[v][i2];\n\t\t\t\tif(u2 \u0026gt; v)\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tif(id[u2] !\u003d -1) {\n\t\t\t\t\tfore(i1, 0, i2) {\n\t\t\t\t\t\tint u1 \u003d g[v][i1];\n\t\t\t\t\t\tif(has[id[u2]][u1])\n\t\t\t\t\t\t\tsub2 +\u003d a * u1 + b * u2 + c * v;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor(int to : g[u2]) {\n\t\t\t\t\t\tif(to \u0026gt; u2)\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcurh[to] \u003d 1;\n\t\t\t\t\t}\n\t\t\t\t\tfore(i1, 0, i2) {\n\t\t\t\t\t\tint u1 \u003d g[v][i1];\n\t\t\t\t\t\tif(curh[u1])\n\t\t\t\t\t\t\tsub2 +\u003d a * u1 + b * u2 + c * v;\n\t\t\t\t\t}\n\t\t\t\t\tfor(int to : g[u2]) {\n\t\t\t\t\t\tif(to \u0026gt; u2)\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcurh[to] \u003d 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfore(u2, 0, v) {\n\t\t\t\tif(!has[id[v]][u2])\n\t\t\t\t\tcontinue;\n\t\t\t\tfor(int u1 : g[u2]) {\n\t\t\t\t\tif(u1 \u0026gt; u2)\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tif(has[id[v]][u1])\n\t\t\t\t\t\tsub2 +\u003d a * u1 + b * u2 + c * v;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tall -\u003d sub2;\n\tcout \u0026lt;\u0026lt; all \u0026lt;\u0026lt; endl;\n}\n\nint main(){\n#ifdef _DEBUG\n\tfreopen(\u0026quot;input.txt\u0026quot;, \u0026quot;r\u0026quot;, stdin);\n\tint tt \u003d clock();\n#endif\n\tcout \u0026lt;\u0026lt; fixed \u0026lt;\u0026lt; setprecision(10);\n\n\tif(read()) {\n\t\tsolve();\n#ifdef _DEBUG\n\t\tcerr \u0026lt;\u0026lt; \u0026quot;TIME \u003d \u0026quot; \u0026lt;\u0026lt; clock() - tt \u0026lt;\u0026lt; endl;\n#endif\n\t}\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e","tags":[]}}