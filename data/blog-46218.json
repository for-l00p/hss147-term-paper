{"status":"OK","result":{"originalLocale":"en","allowViewHistory":false,"creationTimeSeconds":1469245783,"rating":0,"authorHandle":"I_love_Hoang_Yen","modificationTimeSeconds":1469286767,"id":46218,"title":"\u003cp\u003eSP Training 3 — Solutions\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003e\u003ca href\u003d\"https://github.com/ngthanhtrung23/SP2016/tree/master/T3\"\u003eCode\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"https://www.youtube.com/watch?v\u003dVy1RAkkcp5k\"\u003eVideo\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"https://docs.google.com/presentation/d/1fCuD76w6MP7V2F2QzCssbD1mB1ehz2_4f9_nrhOjC3I/edit#slide\u003did.g15ed0ae9f0_0_180\"\u003eSlide\u003c/a\u003e\u003c/p\u003e\u003ch1\u003e[problem:208018A]\u003c/h1\u003e\u003cp\u003eĐề yêu cầu tìm phép đổi chỗ sao cho có ít nghịch thế nhất --\u0026gt; duyệt mọi phép đổi chỗ.\u003c/p\u003e \u003cul\u003e   \u003cli\u003eCó \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003eN\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e2\u003c/sup\u003e)\u003c/span\u003e phép đổi chỗ\u003c/li\u003e   \u003cli\u003eDo đó với mỗi phép đổi chỗ cần xử lý trong \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(1)\u003c/span\u003e.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eVới mỗi phép đổi chỗ 2 phần tử \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e, ta phân tích xem những cặp nghịch thế nào bị ảnh hưởng. Sau khi vẽ ra và xét các trường hợp, ta rút ra được các trường hợp:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eTrước khi đổi chỗ:   \u003cul\u003e     \u003cli\u003eCác cặp \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e mà \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e \u003d \u003ci\u003ei\u003c/i\u003e\u003c/span\u003e, \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/87/51/87519a57087d3cff1f9baa296e39c5bd90f491ec.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/li\u003e     \u003cli\u003eCác cặp \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e mà \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/d5/1d/d51dade84251cd3d406874290818032ae6741f19.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ev\u003c/i\u003e \u003d \u003ci\u003ej\u003c/i\u003e\u003c/span\u003e.\u003c/li\u003e   \u003c/ul\u003e\u003c/li\u003e   \u003cli\u003eSau khi đổi chỗ   \u003cul\u003e     \u003cli\u003eCác cặp \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e mà \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eu\u003c/i\u003e \u003d \u003ci\u003ej\u003c/i\u003e\u003c/span\u003e, \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/87/51/87519a57087d3cff1f9baa296e39c5bd90f491ec.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/li\u003e     \u003cli\u003eCác cặp \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e mà \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/d5/1d/d51dade84251cd3d406874290818032ae6741f19.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ev\u003c/i\u003e \u003d \u003ci\u003ei\u003c/i\u003e\u003c/span\u003e.\u003c/li\u003e   \u003c/ul\u003e\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eĐể tính các giá trị trên, ta cần trả lời các câu hỏi dạng: Có bao nhiêu số trong đoạn \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e, \u003ci\u003er\u003c/i\u003e]\u003c/span\u003e có giá trị lớn hơn \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eVẽ các điểm \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003eA\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e))\u003c/span\u003e lên mặt phẳng:\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/53/e5/53e5855bc93c27af907bda968d42e3ef883050bc.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eTa thấy các cái cần tính là số điểm trong 1 hình chữ nhật. Từ đó dùng kĩ thuật kiểu mảng cộng dồn 2D là có thể giải quyết bài toán. Ví dụ \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ef\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e là số số từ 1 đến \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/span\u003e, và có giá trị lớn hơn \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"http://ideone.com/nLlJMJ\"\u003eCode\u003c/a\u003e\u003c/p\u003e\u003ch1\u003e[problem:208018B]\u003c/h1\u003e\u003ch2\u003eN^4\u003c/h2\u003e\u003cp\u003eDùng kĩ thuật mảng cộng dồn, ta dễ dàng tính được tổng của 1 hình chữ nhật có 2 đỉnh đối nhau là \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e\u003c/p\u003e\u003cp\u003eKhởi tạo mảng cộng dồn:\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e \u003d tổng các số trong hình chữ nhật có 2 đỉnh đối nhau là \u003cspan class\u003d\"tex-span\"\u003e(1, 1)\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e--\u0026gt; \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e) \u003d \u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e - 1, \u003ci\u003ej\u003c/i\u003e) + \u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e - 1) - \u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e - 1, \u003ci\u003ej\u003c/i\u003e - 1) + \u003ci\u003eA\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e với \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eA\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e là số ở ô \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e--\u0026gt; tổng các số trong 1 hình chữ nhật có 2 đỉnh đối diện \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e, nếu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ei\u003c/i\u003e ≤ \u003ci\u003eu\u003c/i\u003e\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ej\u003c/i\u003e ≤ \u003ci\u003ev\u003c/i\u003e\u003c/span\u003e là:\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e) - \u003ci\u003eS\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e - 1) - \u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e - 1, \u003ci\u003ev\u003c/i\u003e) + \u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e - 1, \u003ci\u003ej\u003c/i\u003e - 1)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eNhư vậy ta có thể tính tổng 1 hình chữ nhật bất kỳ trong \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(1)\u003c/span\u003e. Từ đó ta có thuật toán \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e4\u003c/sup\u003e\u003c/span\u003e rất đơn giản: Xét tất cả các hình chữ nhật con trong bảng, với mỗi hình kiểm tra tổng các phần tử bên trong nó có đủ \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eK\u003c/i\u003e\u003c/span\u003e hay không.\u003c/p\u003e\u003ch2\u003eN^3\u003c/h2\u003e\u003cp\u003e1 hình chữ nhật được xác định bởi 4 biến: tọa độ của 2 đỉnh đối diện. \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e)\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ev\u003c/i\u003e)\u003c/span\u003e. Thông thường cách tiếp cận các bài toán có nhiều biến chưa biết là ta duyệt 1 vài biến và tìm các biến còn lại trong thời gian đủ nhanh.\u003c/p\u003e\u003cp\u003eỞ đây ta duyệt 2 biến i và u. Nói cách khác là ta cố định cạnh trên và cạnh dưới của hình chữ nhật. Khi đó, mỗi cột luôn gồm các số từ hàng i đến hàng u. Nếu ta đặt\u003c/p\u003e\u003cp\u003e\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e(\u003ci\u003ej\u003c/i\u003e) \u003d \u003ci\u003esum\u003c/i\u003e(\u003ci\u003eA\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e) + \u003ci\u003eA\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e + 1, \u003ci\u003ej\u003c/i\u003e) + ... + \u003ci\u003eA\u003c/i\u003e(\u003ci\u003eu\u003c/i\u003e, \u003ci\u003ej\u003c/i\u003e))\u003c/span\u003e\u003c/p\u003e\u003cp\u003ethì bài toán trở thành bài toán 1 chiều: cho 1 dãy số \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e. Tìm l và r sao cho \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e - \u003ci\u003el\u003c/i\u003e + 1\u003c/span\u003e nhỏ nhất và tổng các phần tử từ l đến r lớn hơn hoặc bằng \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eK\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eĐể giải bài toán này, thì ta nhận thấy, khi r di chuyển sang phải, thì l cũng di chuyển sang phải, nên ta có thể thu được thuật toán \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003eN\u003c/i\u003e)\u003c/span\u003e như sau:\u003c/p\u003e \u003cpre\u003e\u003ccode\u003eint l \u003d 1;\nfor (int r \u003d 1; r \u0026lt;\u003d N; r++) {\n    // chạy l theo r chừng nào vẫn có thể chạy được\n    while (l \u0026lt; r \u0026amp;\u0026amp; sum(l+1, r) \u0026lt;\u003d K) ++l; // hàm sum(l, r) trả lại tổng các số l --\u0026gt; r trong O(1)\n                                           // dùng kĩ thuật mảng cộng dồn\n    if (sum(l, r) \u0026gt;\u003d K) {\n        // cập nhật kết quả theo [l, r]\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003ca href\u003d\"http://ideone.com/n2wdOC\"\u003eCode\u003c/a\u003e\u003c/p\u003e\u003ch1\u003e[problem:208018C]\u003c/h1\u003e\u003ch2\u003eTư tưởng\u003c/h2\u003e\u003cp\u003eNhận xét: các bài toán vòng tròn (ví dụ như bài này là xoay xâu theo vòng tròn) thường rất khó giải quyết. Kĩ năng thông thường là ta tìm các đưa các bài đó về đường thẳng rồi giải quyết. Có 2 cách thông thường:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eCắt vòng tròn tại 1 điểm\u003c/li\u003e   \u003cli\u003eNhân đôi\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eỞ bài này ta sẽ nhân đôi xâu lên.\u003c/p\u003e\u003cp\u003eXét xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027 \u003d \u003ci\u003eAHYANGYIAHYANGYI\u003c/i\u003e\u003c/span\u003e. Ta thấy mỗi cách xoay vòng tròn xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003c/span\u003e tương ứng với 1 substring của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027\u003c/span\u003e độ dài \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eLS\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eNhư vậy, bài toán trở thành: với mỗi đoạn con dài \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027\u003c/span\u003e, đếm số cách để biến nó thành xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eVới mỗi đoạn con dài \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027\u003c/span\u003e, có 3 trường hợp:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eNó và xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e không khác nhau --\u0026gt; Có \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e cách thay đổi\u003c/li\u003e   \u003cli\u003eNó và xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e khác nhau ở đúng 1 vị trí --\u0026gt; Có 1 cách thay đổi\u003c/li\u003e   \u003cli\u003eNó và xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e khác nhau ở ít nhất 2 vị trí --\u0026gt; Không có cách thay đổi nào cả.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eNhư vậy, việc quan trọng nhất là đếm số vị trí khác nhau của 2 xâu.\u003c/p\u003e\u003cp\u003eCụ thể, với mỗi đoạn \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e, \u003ci\u003er\u003c/i\u003e]\u003c/span\u003e trên xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027\u003c/span\u003e, ta sẽ cần biết:\u003c/p\u003e \u003cul\u003e   \u003cli\u003eĐoạn kết thúc ở \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003er\u003c/i\u003e\u003c/span\u003e của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027\u003c/span\u003e khớp với bao nhiêu kí tự cuối của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e\u003c/li\u003e   \u003cli\u003eĐoạn bắt đầu ở \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003el\u003c/i\u003e\u003c/span\u003e của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027\u003c/span\u003e khớp với bao nhiêu kí tự đầu của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e.\u003c/li\u003e \u003c/ul\u003e\u003cp\u003eTừ 2 thông tin đó ta có thể xác định được đoạn \u003cspan class\u003d\"tex-span\"\u003e[\u003ci\u003el\u003c/i\u003e, \u003ci\u003er\u003c/i\u003e]\u003c/span\u003e thuộc trường hợp nào trong 3 trường hợp nói trên.\u003c/p\u003e\u003ch2\u003eHash\u003c/h2\u003e\u003cp\u003e\u003ca href\u003d\"http://vnoi.info/library/121/4964/\"\u003eHash tutorial\u003c/a\u003e\u003c/p\u003e\u003cp\u003eSử dụng hash, ta dễ dàng so sánh 2 xâu con có bằng nhau hay không trong \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(1)\u003c/span\u003e. Như vậy, bằng chặt nhị phân, ta có thể tính được các thông tin trên trong \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eO\u003c/i\u003e(\u003ci\u003elogN\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003ch2\u003eKMP\u003c/h2\u003e\u003cp\u003eKhi áp dụng thuật toán KMP với xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e, ở mỗi vị trí trên xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u0027\u003c/span\u003e ta biết được nó khớp với nhiều nhất bao nhiêu kí tự đầu của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e. Ví dụ:\u003c/p\u003e \u003cpre\u003e\u003ccode\u003eS \u003d ABCABC\nT \u003d ABC\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThì ta biết ở vị trí 5 trên xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003c/span\u003e khớp được với 2 vị trí đầu của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e, vị trí 6 của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003c/span\u003e khớp với 3 vị trí đầu của xâu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eT\u003c/i\u003e\u003c/span\u003e. Cái này bị ngược với cái mà ta cần tính --\u0026gt; \u003ccode\u003e:@)\u003c/code\u003e. Cách giải quyết xem trong code kỳ diệu phía dưới.\u003c/p\u003e\u003ch2\u003eZ-function\u003c/h2\u003e\u003cp\u003eĐịnh nghĩa hàm Z giống hệt như cái mình cần tính ở bài này --\u0026gt; nếu biết Z chỉ cần chép vào là AC.\u003c/p\u003e\u003cp\u003eCode:\u003c/p\u003e \u003cul\u003e   \u003cli\u003e\u003ca href\u003d\"http://ideone.com/aHOzb7\"\u003eKMP\u003c/a\u003e\u003c/li\u003e   \u003cli\u003e\u003ca href\u003d\"http://ideone.com/9Hz5Zy\"\u003eHash\u003c/a\u003e\u003c/li\u003e   \u003cli\u003e\u003ca href\u003d\"http://ideone.com/FjPB7k\"\u003eZ-Function\u003c/a\u003e\u003c/li\u003e \u003c/ul\u003e\u003ch1\u003e[problem:208018D]\u003c/h1\u003e\u003ch2\u003eVòng tròn\u003c/h2\u003e\u003cp\u003eXét vòng tròn. Mỗi cạnh trên vòng tròn có 1 trọng số. Tìm vị trí xuất phát để đi vòng quanh vòng tròn, mà không lúc nào tổng nhỏ hơn 0.\u003c/p\u003e\u003cp\u003eChọn 1 điểm bất kỳ trên vòng tròn làm điểm 1. Đặt \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e(\u003ci\u003ei\u003c/i\u003e)\u003c/span\u003e là tổng i số đầu tiên. Vẽ đồ thị \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003c/span\u003e ra.\u003c/p\u003e\u003cp\u003eNhận thấy nếu ta chuyển điểm xuất phát từ điểm 1 đến điểm \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ex\u003c/i\u003e\u003c/span\u003e, thì đồ thị bị dịch lên hoặc dịch xuống 1 khoảng bằng hiệu \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e(1)\u003c/span\u003e và \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e(\u003ci\u003ex\u003c/i\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eTừ đó có thể thấy, nếu chọn điểm có \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eS\u003c/i\u003e\u003c/span\u003e nhỏ nhất để xuất phát, thì tổng không lúc nào nhỏ hơn 0.\u003c/p\u003e\u003ch2\u003eThuật toán:\u003c/h2\u003e\u003cp\u003eTìm chu trình euler. Sau khi có chu trình euler, bài toán đưa về vòng tròn.\u003c/p\u003e\u003cp\u003e\u003ca href\u003d\"https://www.youtube.com/watch?v\u003d8FwdtDucfSU\"\u003eVideo chứng minh\u003c/a\u003e\u003c/p\u003e\u003c/div\u003e","tags":[]}}