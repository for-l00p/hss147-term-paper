{"status":"OK","result":{"originalLocale":"ru","allowViewHistory":true,"creationTimeSeconds":1471954969,"rating":128,"authorHandle":"adamant","modificationTimeSeconds":1527806865,"id":46744,"title":"\u003cp\u003eQuaternion algebra and geometry\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eHi everyone! As you may already know (if you don\u0027t then I advice you to \u003ca href\u003d\"//codeforces.com/blog/entry/22175\"\u003elearn\u003c/a\u003e it), in 2D geometry it is convenient to use complex numbers to handling points operations and rotations. Now I would like to tell you about similar construction, which allows you to work efficiently with 3D geometry, in particular to use vectors and linear operations on them, calculate many popular operations (like dot or cross products) and maintain rotations in 3D space. \u003cbr /\u003e\u003c/p\u003e\u003cp\u003eLet \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/85/73/8573291401dc6a8900b0709338346cff0e1b24aa.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e — are vectors in 3D space. Following notation from analytical geometry will be used:\u003c/p\u003e \u003col\u003e   \u003cli\u003e\u003cp\u003eDot product: \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/82/be/82be03bfe4fca4968770bb48467ff2eef6bda495.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, where \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/79/3b/793b50c8ec378d5eb459c6f2501dbb3e2187fc84.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e — is the angle between \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/bc/25/bc2545e5bd5152a3873ea526aa7772c02ba5387b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/b3/36/b3362d600742080457c9415f1ff9a9cc818ddbb4.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e in their common plane, \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/d7/3a/d73a5198c200519af3500498df16bdf04b8359a9.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e — length of vector \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/bc/25/bc2545e5bd5152a3873ea526aa7772c02ba5387b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/p\u003e\u003c/li\u003e   \u003cli\u003e\u003cp\u003eCross product: \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/50/82/508201cbc99ebf60f8960b0f5fe83b30093e0dc4.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, where \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/42/d5/42d5a26983c5c6612f9223bf88d152982579c64a.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e — unit vectors, directed along \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/b0/16/b016b4917d370ce88435f361b8b1f4d1af16bd37.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/d1/de/d1debd01a610f50cd8ff1a6e94c8f33f62edfc4a.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/a8/b4/a8b4ea8e8473f9e869e3d5f4165a53d7397d74e9.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e axes. In 3D space cross product is a vector having length \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/67/8a/678aba4b2f070d7e8d536b7325a04d79e60b6d7a.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and directed orthogonally to their common plane in such way that if you\u0027ll watch on vectors from the endpoint of cross product, shortest rotation from \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/bc/25/bc2545e5bd5152a3873ea526aa7772c02ba5387b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e to \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/b3/36/b3362d600742080457c9415f1ff9a9cc818ddbb4.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e will be counter-clockwise. \u003c/p\u003e\u003c/li\u003e \u003c/ol\u003e\u003cp\u003eSo, quaternion — is \u003ca href\u003d\"https://en.wikipedia.org/wiki/Hypercomplex_number\"\u003ehypercomplex number\u003c/a\u003e, which can be represented as \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/59/51/59514dddd53b41374e41c7a5eb3a4292f847a33a.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, where \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/3b/23/3b23674de10da29066fce9d9de1c80bc45008696.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e — are real numbers and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/d0/ea/d0ea5b4be33d3b8fd590bb9891c2f473d22215ad.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e — are imaginary units. We can define multiplication operation on quaternions with following equality \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/4f/96/4f96e852ba3ad1f079ab7832461f9d5e0a514d79.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. The whole quaternionic multiplication table can be derived from this identity:\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/d4/4a/d44a09406695f0841b17b4a36a733b9e5aaa3aa6.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eAssuming that quaternion multiplication is distributive over addition (\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/95/27/9527a28c3c18e005f9e22e9f7ecbe20d26d3acbd.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e), we can multiply the quaternions, \u0026quot;opening parenthesis\u0026quot;. Note that quaternionic multiplication will be associative (\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/0a/43/0a4363333f595208503a345e755d4a59a4af3e0f.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e), but in common case not commutative (there are \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/db/c6/dbc669b353ee097bdcb97150766e09d9436a50fd.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e such that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/fe/10/fe10d69f5e00e657566f0e0838e6b893e3f1c252.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e).\u003c/p\u003e\u003cp\u003eQuaternions can be also represented as \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/97/0e/970e426fb2ae5b554e4fd80e2159714d60285ac9.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, where \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/a0/8a/a08a8aba6dc63d4554dc4f2f430cd51274e18aa1.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e — is vector of 3D space with unit vectors \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/d0/ea/d0ea5b4be33d3b8fd590bb9891c2f473d22215ad.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Components \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/54/a9/54a9e5821805ec964524a597f365f441e1ae780e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/43/31/4331770686d95baeff641f6b100dff0138cba415.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e are called scalar and vector parts of quaternions. Assume we have quaternions \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/b4/9f/b49f0da7d9f163b22c3a0f54c7d67618364bc895.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/ed/68/ed68b23634f8a219287e38a1473e05ab6450e33b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Then their multiplication can be represented as \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/06/b0/06b053a4014767f766a5683ed0f2c353d58520f0.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Consider multiplication of two quaternions with zero scalar parts.\u003c/p\u003e\u003cp\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/49/16/491605448cd6da10029df9f67e517b9075e507d3.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/d8/31/d83148259fbd4d12d73f13e9e16b63214e6e395d.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. \u003c/p\u003e\u003cp\u003eNote that it can be shortly written as \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/1a/f9/1af9566b28626dba63fa471624d69ef511d8ab8f.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Thus we have following formula for quaternionic multiplication:\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/df/4f/df4fa0b255fb2fab46e40e91c3080e37bff74bc9.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eFinally note that since \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/09/5a/095ad1038dde76cd5db92d48c66a1b1527f4a663.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, quaternion \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/cc/73/cc7394268bb49343924d82e74a1fa4d9765e13d1.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e can be represented in form \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/fd/d6/fdd6c01955df503a57230e2752ab806dd7cf0e99.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, where \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/e1/95/e195170dfc86d0765d4f7772e0308d07844ba874.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e — are complex numbers. Also note that since \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/f7/21/f72130879db88ff5c1c10d17666336ac1302c34a.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, we have identity \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/f0/65/f0655b821eafbb0a66bbc1fe1fcd2536990ed3d4.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e or, introducing notation \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/41/9e/419e9de50723c9423cb8827fb7d3e48954bf0459.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e: \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/7a/ad/7aad1b0824d5530172a6061b8cb21e8851d10df8.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Thus multiplication of quaternions \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/a7/b7/a7b7a8ac4793ab6386319892ac56d5234a9787f7.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/63/27/6327edddaf3ecb2d05aef00d2256c0480ba7d6a8.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e can be represented as \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/ab/af/abafd3dbf6a9b06f276ef4bc91adead5dc81a6d7.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Number \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/41/9e/419e9de50723c9423cb8827fb7d3e48954bf0459.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, introduced earlier, is called conjugated to complex number \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/10/b9/10b90f926e2e4b3b726faabf8d6f4c8c4201b646.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. So we have another one formula for quaternion multiplication:\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/42/a3/42a359eb744a4e917f989ca7e1369d4fa83bd1e8.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eLet\u0027s show that any non-zero quaternion is invertible, i.e. for each quaternion \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/8c/7c/8c7c60b199c4673279860450dad0a82f37446a55.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e there is inverse \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/20/82/208220173f4b1669c211bf20e94eba1057d8170e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e such that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/55/64/5564bf182cdcc0f9989fc828d491f8834be74bd9.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. In this case we can divide quaternions by multiplicating with inverse element. Like in complex numers we can introduce for quaternion \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/34/75/34757714b02597ccd9895782f531fc8854060bd6.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e conjugated quaternion \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/5e/d7/5ed7f08d401bab4520d8f80c71470964be896f55.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. From that formula we can see that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/38/b3/38b32003c0f3657beac3384c672512d9a8b2bc8d.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Thus we can introduce quaternionic norm (which is generalisation of length): \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/6a/85/6a856238463cadd78a3b73bc64c7ae790c16ec03.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and inverse element \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/34/ad/34adffe5fe9cd638f23a195c936a66774fb407dd.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Note that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/cb/7b/cb7be0e778881ff3ffa1cb2771698c0cbdc602c6.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Indeed from multiplication formula we get \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/23/3e/233e450793a209bff729814163e0086e9f827880.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. From here we can see \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/7b/20/7b2030c8a9b5726c62a5113f040c754671ef3b20.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/e9/3a/e93aa7f074fefe129c0e85637de15c21a6a9580a.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/p\u003e\u003cp\u003eNow we are ready to learn about the most useful property of quaternions which is handling rotations in 3D space. From now on we will consider vectors to be quaternions with zero scalar part. Let\u0027s introduce conjugation operation of vector \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ea\u003c/i\u003e\u003c/span\u003e by quaternion \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eg\u003c/i\u003e\u003c/span\u003e the result of which will be vector \u003csup\u003e\u003ca href\u003d\"#ref11\" name\u003d\"ref10\"\u003e[1]\u003c/a\u003e\u003c/sup\u003e \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/0c/ef/0cef11346f18d153c7ddcfb37c060c8d498ffa33.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. This identity is equivalent to the following: \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/1d/42/1d428fcad137acd07b4eb23432c236f56daac538.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Let \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/8e/2d/8e2d6acfc27f44e9a1a6c0e6b8ce661d2eccb307.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, then we can get \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/1d/13/1d13cc407ca72b713edaeeb7ca022fb8f960c6ea.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Considering scalar and vector parts separately we will get:\u003c/p\u003e \u003ccenter\u003e\u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/a9/ea/a9ea29332e5e82f14fec9cc3b590ff8a1d64b7a1.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/center\u003e\u003cp\u003eNote that because \u003cspan class\u003d\"tex-span\"\u003e||\u003ci\u003eab\u003c/i\u003e|| \u003d ||\u003ci\u003ea\u003c/i\u003e||·||\u003ci\u003eb\u003c/i\u003e||\u003c/span\u003e we can get that norms of vectors \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/47/e6/47e68792635c0d34b9e22b734f1b4c62a4349d9f.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/f7/b8/f7b88b8f0e86cc51bcd72eff3c1ed1d941225d3e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e are equal. First equation of the system means that orthogonal projections on axis \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/43/31/4331770686d95baeff641f6b100dff0138cba415.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e are equal for \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/47/e6/47e68792635c0d34b9e22b734f1b4c62a4349d9f.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/f7/b8/f7b88b8f0e86cc51bcd72eff3c1ed1d941225d3e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Set of vectors with same norm and projection on some direction form a circumference around that direction. Thus we see that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/f7/b8/f7b88b8f0e86cc51bcd72eff3c1ed1d941225d3e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e can be obtained from \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/47/e6/47e68792635c0d34b9e22b734f1b4c62a4349d9f.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e by its rotation around \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/43/31/4331770686d95baeff641f6b100dff0138cba415.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e on some angle. Let\u0027s find it. From now on we will say that rotation is clockwise or counter-clockwise depending on what it\u0027s like if we watch it from the endpoint of vector around which rotation is happening.\u003c/p\u003e\u003cp\u003eLet\u0027s assume that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/98/83/98837022d378f2d78a9689cd5a2f602d40bc70b1.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. If it\u0027s not true, we can divide \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/6e/41/6e41f00b720c7da389c1080a7e3d26b4c19ea8ff.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e by square root of its norm, it will not affect \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/f7/b8/f7b88b8f0e86cc51bcd72eff3c1ed1d941225d3e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Now we can assume that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/4e/8a/4e8acf66b4a0b6c14585df4d0919133c740b4c31.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, where \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/75/21/75215953ecfb3d0ebf82360d21ca5791f32033ba.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Also using first equation and using notation \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/ca/aa/caaa3e3545c38f32a8d6f918bbdbd2b843851cac.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/26/89/268919a486cf847c669724e5cbb8dfd3a18fee96.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, we can transform second equation in following way: \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/66/7b/667b14e07cd0cfeeac8c535989b71c77bbc99505.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. (On the other hand we subtracted \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/c5/32/c53214cf0e367ae766ccd0f374e291059b76c763.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e from both sides, on the other one since \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/e7/de/e7defc5ed92cda03dc81b2d7203c6e6ff6614c72.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e we can see that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/91/17/91170e55f471951c7ede5aa16f918839ad81155b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e)\u003c/p\u003e\u003cp\u003eNote that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/ab/d1/abd11828021efa262071056c1783affa3433d22c.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e and \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/78/de/78de927bc6360453a2ddd2f5110b62c7d59cfa58.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e are lying in the plane orthogonal to \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/43/31/4331770686d95baeff641f6b100dff0138cba415.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, thus, this is the rotation plane. Now we should see that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/7a/43/7a43ffc71ba31e376d0245c6f63e28774e899a3e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e is vector \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/78/de/78de927bc6360453a2ddd2f5110b62c7d59cfa58.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e rotated \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/3d/f5/3df5d3c78b3bb193a6358528b4d185ca05e26551.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e around vector \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/eb/cc/ebcc8e0147f5463adef605a2f40a11e557a98ab9.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e clockwise. Thus left part of second equation is \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/78/de/78de927bc6360453a2ddd2f5110b62c7d59cfa58.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, rotated around \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/eb/cc/ebcc8e0147f5463adef605a2f40a11e557a98ab9.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e clockwise on angle \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/79/3b/793b50c8ec378d5eb459c6f2501dbb3e2187fc84.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, and the right one is \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/ab/d1/abd11828021efa262071056c1783affa3433d22c.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e, rotated around \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/eb/cc/ebcc8e0147f5463adef605a2f40a11e557a98ab9.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e counter-clockwise on \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/79/3b/793b50c8ec378d5eb459c6f2501dbb3e2187fc84.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Thus we see that \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/f7/b8/f7b88b8f0e86cc51bcd72eff3c1ed1d941225d3e.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e is \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/47/e6/47e68792635c0d34b9e22b734f1b4c62a4349d9f.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e rotated around \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/eb/cc/ebcc8e0147f5463adef605a2f40a11e557a98ab9.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e counter-clockwise on \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/0a/ad/0aadc52aa14243e52a1e4ce9636f6ccee134eb9b.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. \u003c/p\u003e\u003chr /\u003e To sum up: quaternion with unit norm \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/cc/c8/ccc80bf659aa0ebcfca7693b9050ee177784ebbf.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e has such property that for each \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/47/e6/47e68792635c0d34b9e22b734f1b4c62a4349d9f.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e expression \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/0c/8d/0c8dac921ff1d9f45ecf8e28beb39f0e516a9e8a.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e specifies vector \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/47/e6/47e68792635c0d34b9e22b734f1b4c62a4349d9f.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e rotated around \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/eb/cc/ebcc8e0147f5463adef605a2f40a11e557a98ab9.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e on \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/79/3b/793b50c8ec378d5eb459c6f2501dbb3e2187fc84.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e counter-clockwise.\u003cp\u003e\u003cspan style\u003d\"font-size: 8.0pt;\"\u003e\u003ca href\u003d\"#ref10\" name\u003d\"ref11\"\u003e[1]\u003c/a\u003e \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/94/a1/94a119b4c2dfd2498f03939507c442e04da3eab6.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. Scalar part of this product equals to \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/53/ad/53ada8e5729d70624b0353791946f9f9f15a5ae1.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/span\u003e\u003c/p\u003e\u003cp\u003eAnd now the implementation. Ideone: \u003ca href\u003d\"http://ideone.com/BBOx9H\"\u003e#BBOx9H\u003c/a\u003e\u003c/p\u003e \u003cpre\u003e\u003ccode\u003e// To begin, we introduce the notation for the class and its elements, which we will use.\ntypedef double ftype;\ntypedef complex\u0026lt;ftype\u0026gt; point;\ntypedef complex\u0026lt;point\u0026gt; quater;\n#define qA real()\n#define qB imag()\n#define qs qA.real()\n#define qx qA.imag()\n#define qy qB.real()\n#define qz qB.imag()\n\nconst ftype pi \u003d acos(-1.);\nconst ftype eps \u003d 1e-9;\n\n// Multiplication via formulas in complex terms.\nquater operator * (quater a, quater b)\n{\n    return {{a.qA * b.qA - a.qB * conj(b.qB)},\n            {a.qA * b.qB + a.qB * conj(b.qA)}};\n}\n\n// Conjugated element\nquater conj(quater a)\n{\n    return {conj(a.qA), - a.qB};\n}\n\n// Quaternionic norm.\nftype norm(quater a)\n{\n    return (a * conj(a)).qs;\n}\n\n// Length.\nftype abs(quater a)\n{\n    return sqrt(norm(a));\n}\n\n// Dividing via inverse element.\nquater operator / (quater a, quater b)\n{\n    return a * conj(b) / point(norm(b));\n}\n\n// Quaternion from vector coordinates.\nquater vec(ftype x, ftype y, ftype z)\n{\n    return {{0, x}, {y, z}};\n}\n\n// Basis vectors.\nconst quater ex \u003d vec(1, 0, 0);\nconst quater ey \u003d vec(0, 1, 0);\nconst quater ez \u003d vec(0, 0, 1);\n\n// Vector part of quaternion.\nquater vec(quater a)\n{\n    return a -\u003d a.qs;\n}\n\n// Dot product.\nftype dot(quater a, quater b)\n{\n    return -(a * b).qs;\n}\n\n// Cross product.\nquater cross(quater a, quater b)\n{\n    return vec(a * b);\n}\n\n// Triple (mixed) product.\nftype mix(quater a, quater b, quater c)\n{\n    return dot(a, cross(b, c));\n}\n\n// Conjugation of vector a by quaternion g.\nquater conj(quater a, quater g)\n{\n    return g * a / g;\n}\n\n// Quaternion representing rotation around i on phi counter-clockwise.\nquater rotation(quater i, ftype phi)\n{\n    return point(cos(phi / 2)) + i * point(sin(phi / 2));\n}\n\n// Rotate a around i counter-clockwise.\nquater rotate(quater a, quater i, ftype phi)\n{\n    return conj(a, rotation(i, phi));\n}\n\n// Check if two vectors are equal.\nbool cmp(const quater \u0026amp;a, const quater \u0026amp;b)\n{\n    return abs(a - b) \u0026lt; eps;\n}\n\n// Any vector which is orthogonal to v.\nquater ortho(quater v)\n{\n    if(abs(v.qy) \u0026gt; eps)\n        return vec(v.qy, -v.qx, 0);\n    else\n        return vec(v.qz, 0, -v.qx);\n}\n\n// Quaternion representing rotation from a to b via minimal angle.\nquater min_rotation(quater a, quater b)\n{\n    a /\u003d abs(a);\n    b /\u003d abs(b);\n    if(cmp(a, -b)) // Degenerate case :(\n        return rotation(ortho(b), pi);\n    else\n        return conj(a * (a + b));\n}\n\n// Angle of rotation from [-pi; pi] defined by quaternion.\nftype get_angle(quater a)\n{\n    a /\u003d abs(a);\n    return remainder(2 * acos(a.qs), 2 * pi);\n}\n\n// Quaternion representing rotation which turns nx in x, ny in y and [nx, ny] in z.\nquater basis_rotation(quater nx, quater ny)\n{\n    nx /\u003d abs(nx);\n    ny /\u003d abs(ny);\n    quater a \u003d min_rotation(nx, ex);\n    ny \u003d conj(ny, a);\n    quater b \u003d min_rotation(ny, ey);\n    if(cmp(ny, -ey))\n        b \u003d rotation(ex, pi);\n    return b * a;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["geometry","quaternions"]}}