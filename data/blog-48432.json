{"status":"OK","result":{"originalLocale":"ru","allowViewHistory":false,"creationTimeSeconds":1479386707,"rating":0,"authorHandle":"BigBag","modificationTimeSeconds":1483799544,"id":48432,"title":"\u003cp\u003eАлгоритмы на строках. Начало\u003c/p\u003e","locale":"ru","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003e\u003cstrong\u003e1)\u003c/strong\u003e Префикс-функция.\u003c/p\u003e\u003cp\u003eПрефикс-функция для строки \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e\u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e  — \u003c/span\u003e это массив чисел \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e, где \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e  — \u003c/span\u003e это максимальная длина суффикса подстроки \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e0..\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e, совпадающего с префиксом строки \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e\u003c/span\u003e, при этом \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e ≤ \u003ci\u003ei\u003c/i\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/d8/fa/d8fa46fff84e1e8481b8beac06073fa3029d38d9.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eБудем вычислять значения \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e последовательно. Заметим, что для того, чтобы вычислить \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e, нужно найти такое максимальное \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e, что \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e0..\u003ci\u003ek\u003c/i\u003e - 1\u003c/sub\u003e \u003d \u003ci\u003es\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e - \u003ci\u003ek\u003c/i\u003e..\u003ci\u003ei\u003c/i\u003e - 1\u003c/sub\u003e\u003c/span\u003e и \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/sub\u003e \u003d \u003ci\u003es\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e.\u003c/p\u003e\u003cp\u003eЧему равно максимальное \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e, что \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e0..\u003ci\u003ek\u003c/i\u003e - 1\u003c/sub\u003e \u003d \u003ci\u003es\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e - \u003ci\u003ek\u003c/i\u003e..\u003ci\u003ei\u003c/i\u003e - 1\u003c/sub\u003e\u003c/span\u003e? Правильно \u003cspan class\u003d\"tex-span\"\u003e  — \u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e - 1\u003c/sub\u003e\u003c/span\u003e. Т.е. если \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e - 1\u003c/sub\u003e\u003c/sub\u003e\u003c/span\u003e\u003d\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e\u003c/span\u003e, то \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e \u003d \u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e - 1\u003c/sub\u003e + 1\u003c/span\u003e. Иначе, нужно найти следующее по величине \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e, удовлетворяющее данному условию. Нетрудно заметить, что оно равно \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ep\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e - 1\u003c/sub\u003e - 1\u003c/sub\u003e\u003c/span\u003e. Для лучшего понимания, посмотрите картинку :\u003c/p\u003e\u003cp\u003e\u003cimg alt\u003d\" \" src\u003d\"/predownloaded/4e/fd/4efd2e821e1bb54e4d84a2796c9489f8b8a37811.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e\u003c/p\u003e\u003cp\u003eТаким образом, получаем нетрудный алгоритм : \u003c/p\u003e \u003cpre\u003e\u003ccode\u003evoid get_prefix_function(string s, int p[]) {\n    int k \u003d 0;\n    p[0] \u003d k;\n    for (int i \u003d 1; i \u0026lt; s.length(); ++i) {\n        while (k \u0026amp;\u0026amp; s[k] !\u003d s[i]) {\n            k \u003d p[k - 1];\n        }\n        if (s[k] \u003d\u003d s[i]) {\n            ++k;\n        }\n        p[i] \u003d k;\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eДокажем, что асимптотика времени работы алгоритма \u003cspan class\u003d\"tex-span\"\u003e  — \u003c/span\u003e \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/93/dc/93dcfefdffdf2bcbb67ba9e68282d5749d5b05e4.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e. \u003c/p\u003e\u003cp\u003eЗаметим, что за одну итерацию главного цикла, \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e может либо увеличится на 1, либо уменьшиться на какое-то значение. Очевидно, что кол-во уменьшений не может превосходить кол-ва увеличений переменной \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ek\u003c/i\u003e\u003c/span\u003e. Т.к. кол-во увеличений \u003cspan class\u003d\"tex-span\"\u003e  — \u003c/span\u003e максимум \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eN\u003c/i\u003e\u003c/span\u003e, то суммарное время работы тоже \u003cimg align\u003d\"middle\" class\u003d\"tex-formula\" src\u003d\"/predownloaded/93/dc/93dcfefdffdf2bcbb67ba9e68282d5749d5b05e4.png\" style\u003d\"max-width: 100.0%;max-height: 100.0%;\" /\u003e.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003e2)\u003c/strong\u003e \u003ca href\u003d\"http://e-maxx.ru/algo/z_function\"\u003ez-функция\u003c/a\u003e.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003e3)\u003c/strong\u003e Хеширование.\u003c/p\u003e\u003cp\u003eПусть \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e(\u003ci\u003es\u003c/i\u003e) \u003d (\u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003en\u003c/i\u003e - 1\u003c/sup\u003e * \u003ci\u003es\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e0\u003c/sub\u003e + \u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003en\u003c/i\u003e - 2\u003c/sup\u003e * \u003ci\u003es\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e1\u003c/sub\u003e + ... + \u003ci\u003es\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003en\u003c/i\u003e - 1\u003c/sub\u003e)\u003c/span\u003e%\u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emod\u003c/i\u003e\u003c/span\u003e, где \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003ep\u003c/i\u003e\u003c/span\u003e и \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003emod\u003c/i\u003e\u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e  — \u003c/span\u003e заданные параметры. Тогда \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e(\u003ci\u003es\u003c/i\u003e)\u003c/span\u003e \u003cspan class\u003d\"tex-span\"\u003e  — \u003c/span\u003e хеш для строки \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e\u003c/span\u003e. Посчитаем массив \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e\u003c/span\u003e, где \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003eh\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e \u003d \u003ci\u003eh\u003c/i\u003e(\u003ci\u003es\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e0..\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e)\u003c/span\u003e, а также массив \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003epw\u003c/i\u003e\u003c/span\u003e, где \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003epw\u003c/i\u003e\u003csub class\u003d\"lower-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sub\u003e \u003d \u003ci\u003ep\u003c/i\u003e\u003csup class\u003d\"upper-index\"\u003e\u003ci\u003ei\u003c/i\u003e\u003c/sup\u003e\u003c/span\u003e. Это можно легко сделать, используя следующую формулу: \u003ccode\u003eh[i] \u003d (h[i - 1] * p + s[i]) % mod\u003c/code\u003e. Используя эти величины, можно легко посчитать хеш любой подстроки \u003cspan class\u003d\"tex-span\"\u003e\u003ci\u003es\u003c/i\u003e\u003c/span\u003e :\u003c/p\u003e \u003cpre\u003e\u003ccode\u003eint get_hash(int l, int r) {\n    int y \u003d h[r], x \u003d 0;\n    if (l) {\n        x \u003d (1LL * h[l - 1] * pw[r - l + 1]) % mod;\n    }\n    return (y - x + mod) % mod;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eЧто касается применения на практике. В зависимости от качества тестов, есть 2 случая : в них есть \u003ca href\u003d\"//codeforces.com/blog/entry/4898?locale\u003dru\"\u003eстрока Туэ-Морса\u003c/a\u003e, или нет. Если ее там нет, то можно с уверенностью писать хеши по модулю \u003cspan class\u003d\"tex-span\"\u003e2\u003csup class\u003d\"upper-index\"\u003e64\u003c/sup\u003e\u003c/span\u003e, т.е. просто используя тип данных long long. Если же она там есть, то нужно добавить второй модуль, например \u003cspan class\u003d\"tex-span\"\u003e10\u003csup class\u003d\"upper-index\"\u003e9\u003c/sup\u003e + 9\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003e4)\u003c/strong\u003e \u003ca href\u003d\"http://e-maxx.ru/algo/aho_corasick\"\u003eБор\u003c/a\u003e (1я часть).\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eЗадачи на эти темы:\u003c/strong\u003e \u003ca href\u003d\"//codeforces.com/group/JrUBa4QK0n/contest/100133\"\u003eТренировка №5\u003c/a\u003e :\u003c/p\u003e \u003cul\u003e   \u003cli\u003eB \u003cspan class\u003d\"tex-span\"\u003e  — \u003c/span\u003e решить тремя способами (бор, хеши, префикс-функция)\u003c/li\u003e   \u003cli\u003eC\u003c/li\u003e   \u003cli\u003eD\u003c/li\u003e   \u003cli\u003eE\u003c/li\u003e   \u003cli\u003eG\u003c/li\u003e   \u003cli\u003eI\u003c/li\u003e   \u003cli\u003eL\u003c/li\u003e \u003c/ul\u003e\u003cp\u003e\u003ca href\u003d\"http://acmp.ru/index.asp?main\u003dtask\u0026amp;id_task\u003d202\"\u003eПоиск подстроки\u003c/a\u003e \u003cspan class\u003d\"tex-span\"\u003e  — \u003c/span\u003e решить тремя способами (хеши, префикс-функция, z-функция), \u003ca href\u003d\"https://contest.yandex.ru/ioi/contest/567/problems/A\"\u003eПринтер, IOI 2008\u003c/a\u003e, \u003ca href\u003d\"//codeforces.com/contest/119/problem/D\"\u003eПреобразование строки\u003c/a\u003e, \u003ca href\u003d\"//codeforces.com/contest/727/problem/E\"\u003eИгры на диске\u003c/a\u003e, \u003ca href\u003d\"//codeforces.com/gym/100570/problem/E\"\u003ePalindrom Query\u003c/a\u003e, \u003ca href\u003d\"https://csacademy.com/contest/round-15/#task/substring-restrictions\"\u003eSubstring restrictions\u003c/a\u003e, \u003ca href\u003d\"//codeforces.com/contest/754/problem/E\"\u003eДаша и циклическая таблица\u003c/a\u003e.\u003c/p\u003e\u003c/div\u003e","tags":[]}}