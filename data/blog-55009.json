{"status":"OK","result":{"originalLocale":"en","allowViewHistory":true,"creationTimeSeconds":1507305682,"rating":142,"authorHandle":"Tommyr7","modificationTimeSeconds":1507381924,"id":55009,"title":"\u003cp\u003eCodeforces Round #439 (Div. 2) Editorial\u003c/p\u003e","locale":"en","content":"\u003cdiv class\u003d\"ttypography\"\u003e\u003cp\u003eHi, all!\u003c/p\u003e\u003cp\u003eThis is not \u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/Tommyr7\" title\u003d\"Master Tommyr7\"\u003eTommyr7\u003c/a\u003e, but the \u003cstrong\u003eimpostor\u003c/strong\u003e behind the round (guess who I am? :P). The statements are written by me. The characters in the round feature, again, the \u003cem\u003eMonogatari\u003c/em\u003e anime series, and to be more specific, \u003cem\u003eNisemonogatari: Fake Tale\u003c/em\u003e. The statements involve stories with fake things and oddities, but as per tradition, contain no spoilers. Thank you, everyone, and hope you\u0027ve all enjoyed the round!\u003c/p\u003e\u003cp\u003eOn a side note, special kudos to \u003ca href\u003d\"//codeforces.com/blog/entry/54971?#comment-389321\"\u003ethe best impostors of the round\u003c/a\u003e (except me, lol)!\u003c/p\u003e\u003cp\u003eAny feedback on problems and tutorials are welcome -- we look forward to doing even better in the future!\u003c/p\u003e\u003cp\u003eHere are hints for all problems and detailed tutorials!\u003c/p\u003e \u003chr /\u003e\u003ch3\u003eHints\u003c/h3\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eProblem A\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cp\u003eFirst approach: Optimize the straightforward solution.\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003e... or even...\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cp\u003eSecond approach: Believe in magic.\u003c/p\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eProblem B\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cp\u003eMultiply instead of divide. What happens to the last digit when multiplying?\u003c/p\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eProblem C\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cp\u003eConsider islands of \u003cstrong\u003etwo\u003c/strong\u003e colours and the bridges between them.\u003c/p\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eProblem D\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cp\u003eIterate over all possible combination, order and direction of extra edges.\u003c/p\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eProblem E\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cp\u003eFirst approach: 2D segment tree (or quadtree) with a \u003ccode\u003eset\u003c/code\u003e or \u003ccode\u003evector\u003c/code\u003e on each node, representing the set of barriers that cover this node.\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003e... or may as well...\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cp\u003eSecond approach: Assign a random value to each barrier. Then utilise 2D Fenwick trees.\u003c/p\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003chr /\u003e\u003ch3\u003eTutorials\u003c/h3\u003e\u003ch3\u003e\u003ca href\u003d\"/contest/869/problem/A\" title\u003d\"Codeforces Round 439 (Div. 2)\"\u003e869A - The Artful Expedient\u003c/a\u003e\u003c/h3\u003e\u003cp\u003e\u003cstrong\u003eAuthor\u003c/strong\u003e \u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/Tommyr7\" title\u003d\"Master Tommyr7\"\u003eTommyr7\u003c/a\u003e, \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/cyand1317\" title\u003d\"Grandmaster cyand1317\"\u003ecyand1317\u003c/a\u003e / \u003cstrong\u003ePreparation\u003c/strong\u003e \u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/Tommyr7\" title\u003d\"Master Tommyr7\"\u003eTommyr7\u003c/a\u003e, \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/cyand1317\" title\u003d\"Grandmaster cyand1317\"\u003ecyand1317\u003c/a\u003e / \u003cstrong\u003eTutorial\u003c/strong\u003e \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/cyand1317\" title\u003d\"Grandmaster cyand1317\"\u003ecyand1317\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"869A\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution 1 (Tommyr7)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\nusing namespace std;\n#define Maxn 4000007\nbool vis[Maxn];\nint a[4007],b[4007],n;\nint main()\n{\n\tscanf(\u0026quot;%d\u0026quot;,\u0026amp;n);\n\tmemset(vis,false,sizeof(vis));\n\tfor (int i\u003d1;i\u0026lt;\u003dn;i++)\n\t{\n\t\tscanf(\u0026quot;%d\u0026quot;,\u0026amp;a[i]);\n\t\tvis[a[i]]\u003dtrue;\n\t}\n\tfor (int i\u003d1;i\u0026lt;\u003dn;i++)\n\t{\n\t\tscanf(\u0026quot;%d\u0026quot;,\u0026amp;b[i]);\n\t\tvis[b[i]]\u003dtrue;\n\t}\n\tint ans\u003d0;\n\tfor (int i\u003d1;i\u0026lt;\u003dn;i++)\n\t\tfor (int j\u003d1;j\u0026lt;\u003dn;j++)\n\t\t\tif (vis[a[i]^b[j]]) ++ans;\n\tif (ans%2\u003d\u003d0) printf(\u0026quot;Karen\\n\u0026quot;); else printf(\u0026quot;Koyomi\\n\u0026quot;);\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution 2 (cyand1317)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;stdio.h\u0026gt;\n\nint main()\n{\n    puts(\u0026quot;Karen\u0026quot;);\n    return 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003ch3\u003e\u003ca href\u003d\"/contest/869/problem/B\" title\u003d\"Codeforces Round 439 (Div. 2)\"\u003e869B - The Eternal Immortality\u003c/a\u003e\u003c/h3\u003e\u003cp\u003e\u003cstrong\u003eAuthor\u003c/strong\u003e \u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/Tommyr7\" title\u003d\"Master Tommyr7\"\u003eTommyr7\u003c/a\u003e / \u003cstrong\u003ePreparation\u003c/strong\u003e \u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/Tommyr7\" title\u003d\"Master Tommyr7\"\u003eTommyr7\u003c/a\u003e / \u003cstrong\u003eTutorial\u003c/strong\u003e \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/cyand1317\" title\u003d\"Grandmaster cyand1317\"\u003ecyand1317\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"869B\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eModel solution (Tommyr7)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\nusing namespace std;\nlong long L,R;\nint ans;\nint main()\n{\n\tscanf(\u0026quot;%lld%lld\u0026quot;,\u0026amp;L,\u0026amp;R);\n\tif (R-L\u0026gt;\u003d10) printf(\u0026quot;%d\\n\u0026quot;,0);\n\telse\n\t{\n\t\tans\u003d1;\n\t\tfor (long long i\u003dL+1;i\u0026lt;\u003dR;i++)\n\t\t\tans\u003d(1LL*ans*(i%10))%10;\n\t\tprintf(\u0026quot;%d\\n\u0026quot;,ans);\n\t}\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003ch3\u003e\u003ca href\u003d\"/contest/869/problem/C\" title\u003d\"Codeforces Round 439 (Div. 2)\"\u003e869C - The Intriguing Obsession\u003c/a\u003e\u003c/h3\u003e\u003cp\u003e\u003cstrong\u003eAuthor\u003c/strong\u003e \u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/Tommyr7\" title\u003d\"Master Tommyr7\"\u003eTommyr7\u003c/a\u003e / \u003cstrong\u003ePreparation\u003c/strong\u003e \u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/Tommyr7\" title\u003d\"Master Tommyr7\"\u003eTommyr7\u003c/a\u003e / \u003cstrong\u003eTutorial\u003c/strong\u003e \u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/Tommyr7\" title\u003d\"Master Tommyr7\"\u003eTommyr7\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"869C\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eModel solution (Tommyr7)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n#define Maxn 5007\n#define modp 998244353\nint p[Maxn][Maxn];\nint pre[Maxn];\nint a,b,c;\nint solve(int x,int y)\n{\n\tint res\u003d0;\n\tfor (int k\u003d0;k\u0026lt;\u003dx\u0026amp;\u0026amp;k\u0026lt;\u003dy;k++)\n\t{\n\t\tint del\u003dpre[k];\n\t\tdel\u003d(1LL*del*p[x][k])%modp;\n\t\tdel\u003d(1LL*del*p[y][k])%modp;\n\t\tres\u003d(res+del)%modp;\n\t}\n\treturn res;\n}\nint main()\n{\n\tscanf(\u0026quot;%d%d%d\u0026quot;,\u0026amp;a,\u0026amp;b,\u0026amp;c);\n\tmemset(p,0,sizeof(p));\n\tp[0][0]\u003d1;\n\tfor (int i\u003d1;i\u0026lt;\u003d5000;i++)\n\t{\n\t\tp[i][0]\u003d1;\n\t\tfor (int j\u003d1;j\u0026lt;\u003di;j++)\n\t\t\tp[i][j]\u003d(p[i-1][j-1]+p[i-1][j])%modp;\n\t}\n\tmemset(pre,0,sizeof(pre));\n\tpre[0]\u003d1;\n\tfor (int i\u003d1;i\u0026lt;\u003d5000;i++)\n\t\tpre[i]\u003d(1LL*pre[i-1]*i)%modp;\n\tint ans\u003d1;\n\tans\u003d(1LL*ans*solve(a,b))%modp;\n\tans\u003d(1LL*ans*solve(b,c))%modp;\n\tans\u003d(1LL*ans*solve(a,c))%modp;\n\tprintf(\u0026quot;%d\\n\u0026quot;,ans);\n\treturn 0;\n}\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003ch3\u003e\u003ca href\u003d\"/contest/869/problem/D\" title\u003d\"Codeforces Round 439 (Div. 2)\"\u003e869D - The Overdosing Ubiquity\u003c/a\u003e\u003c/h3\u003e\u003cp\u003e\u003cstrong\u003eAuthor\u003c/strong\u003e \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/quailty\" title\u003d\"Grandmaster quailty\"\u003equailty\u003c/a\u003e / \u003cstrong\u003ePreparation\u003c/strong\u003e \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/quailty\" title\u003d\"Grandmaster quailty\"\u003equailty\u003c/a\u003e / \u003cstrong\u003eTutorial\u003c/strong\u003e \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/quailty\" title\u003d\"Grandmaster quailty\"\u003equailty\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"869D\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eModel solution (quailty)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include\u0026lt;cstdio\u0026gt;\n#include\u0026lt;cstdlib\u0026gt;\n#include\u0026lt;cstring\u0026gt;\n#include\u0026lt;cmath\u0026gt;\n#include\u0026lt;iostream\u0026gt;\n#include\u0026lt;algorithm\u0026gt;\n#include\u0026lt;map\u0026gt;\n\nusing namespace std;\n\nconst int MAXN\u003d255;\n\nconst int Mod\u003d1000000007;\ninline void add_mod(int \u0026amp;x,int y)\n{\n    x\u003d(x+y\u0026lt;Mod ? x+y : x+y-Mod);\n}\n\nint u[MAXN],v[MAXN];\n\nmap\u0026lt;int,int\u0026gt; mp;\ninline int get_id(int x)\n{\n    if(!mp[x])mp[x]\u003d(int)mp.size();\n    return mp[x];\n}\n\nvector\u0026lt;int\u0026gt; e[MAXN];\nvoid add_edge(int u,int v)\n{\n    e[u].push_back(v);\n    e[v].push_back(u);\n}\n\ninline int cal_size(int u,int n,int d)\n{\n    int t\u003du,c\u003d0,res;\n    while(t)c++,t\u0026gt;\u0026gt;\u003d1;\n    res\u003d(1\u0026lt;\u0026lt;(d-c+1))-1,t\u003dc;\n    while(t\u0026lt;d)t++,u\u003du\u0026lt;\u0026lt;1|1;\n    return res-max(min(u-n,1\u0026lt;\u0026lt;(d-c)),0);\n}\n\nint num[MAXN];\nvoid pre_dp(int u,int f)\n{\n    for(auto \u0026amp;v:e[u])\n    {\n        if(v\u003d\u003df)continue;\n        num[u]-\u003dnum[v];\n        pre_dp(v,u);\n    }\n}\n\nint vis[MAXN];\nvoid dfs(int u,int \u0026amp;tot)\n{\n    add_mod(tot,num[u]);\n    vis[u]\u003d1;\n    for(auto \u0026amp;v:e[u])\n        if(!vis[v])dfs(v,tot);\n    vis[u]\u003d0;\n}\n\nint main()\n{\n    int n,m,d\u003d0;\n    scanf(\u0026quot;%d%d\u0026quot;,\u0026amp;n,\u0026amp;m);\n    while((1\u0026lt;\u0026lt;d)\u0026lt;\u003dn)d++;\n    get_id(1);\n    for(int i\u003d0;i\u0026lt;m;i++)\n    {\n        scanf(\u0026quot;%d%d\u0026quot;,\u0026amp;u[i],\u0026amp;v[i]);\n        int t\u003du[i];\n        while(t)get_id(t),t\u0026gt;\u0026gt;\u003d1;\n        t\u003dv[i];\n        while(t)get_id(t),t\u0026gt;\u0026gt;\u003d1;\n    }\n    for(auto \u0026amp;t:mp)\n    {\n        int u\u003dt.first,id\u003dt.second;\n        if(u\u0026gt;1)add_edge(get_id(u),get_id(u\u0026gt;\u0026gt;1));\n        num[id]\u003dcal_size(u,n,d);\n    }\n    pre_dp(1,0);\n    for(int i\u003d0;i\u0026lt;m;i++)\n        add_edge(get_id(u[i]),get_id(v[i]));\n    int res\u003d0;\n    for(int i\u003d1;i\u0026lt;\u003d(int)mp.size();i++)\n    {\n        int tot\u003d0;\n        dfs(i,tot);\n        add_mod(res,1LL*tot*num[i]%Mod);\n    }\n    printf(\u0026quot;%d\\n\u0026quot;,res);\n    return 0;\n}\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003ch3\u003e\u003ca href\u003d\"/contest/869/problem/E\" title\u003d\"Codeforces Round 439 (Div. 2)\"\u003e869E - The Untended Antiquity\u003c/a\u003e\u003c/h3\u003e\u003cp\u003e\u003cstrong\u003eAuthor\u003c/strong\u003e \u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/Tommyr7\" title\u003d\"Master Tommyr7\"\u003eTommyr7\u003c/a\u003e / \u003cstrong\u003ePreparation\u003c/strong\u003e \u003ca class\u003d\"rated-user user-orange\" href\u003d\"/profile/Tommyr7\" title\u003d\"Master Tommyr7\"\u003eTommyr7\u003c/a\u003e, \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/cyand1317\" title\u003d\"Grandmaster cyand1317\"\u003ecyand1317\u003c/a\u003e, \u003ca class\u003d\"rated-user user-blue\" href\u003d\"/profile/visitWorld\" title\u003d\"Expert visitWorld\"\u003evisitWorld\u003c/a\u003e / \u003cstrong\u003eTutorial\u003c/strong\u003e \u003ca class\u003d\"rated-user user-red\" href\u003d\"/profile/cyand1317\" title\u003d\"Grandmaster cyand1317\"\u003ecyand1317\u003c/a\u003e\u003c/p\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eTutorial\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cdiv class\u003d\"problemTutorial\" problemcode\u003d\"869E\"\u003eTutorial is loading...\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution 1 (visitWorld)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n\n#define rep(i, x, y) for (int i \u003d (x), _ \u003d (y); i \u0026lt;\u003d _; ++i)\n#define down(i, x, y) for (int i \u003d (x) - 1, _ \u003d (y); i \u0026gt;\u003d _; --i)\n#define x first\n#define y second\n#define mp make_pair\n#define pb push_back\n#define bin(x) (1\u0026lt;\u0026lt;(x))\n//#define LX_JUDGE\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair\u0026lt;int, int\u0026gt; pii;\n\ntemplate\u0026lt;typename T\u0026gt; inline void upmax(T \u0026amp;x, T y) { x \u0026lt; y ? x \u003d y : 0; }\ntemplate\u0026lt;typename T\u0026gt; inline void upmin(T \u0026amp;x, T y) { x \u0026gt; y ? x \u003d y : 0; }\n\ntemplate\u0026lt;typename T\u0026gt; inline void read(T \u0026amp;x) {\n\tchar c;\n\twhile ((c \u003d getchar()) \u0026lt; \u00270\u0027 or c \u0026gt; \u00279\u0027);\n\tfor (x \u003d c - \u00270\u0027; (c \u003d getchar()) \u0026gt;\u003d \u00270\u0027 and c \u0026lt;\u003d \u00279\u0027; x \u003d x * 10 + c - \u00270\u0027);\n}\n\nconst int inf \u003d 0x3f3f3f3f;\nconst int MAX_N \u003d 2500;\n\nstruct Data {\n\tint u, d, id;\n\tData() {}\n\tData(int u, int d, int id) : u(u), d(d), id(id) {}\n};\n\nclass SegmentTree {\n\tmap\u0026lt;pii, int\u0026gt; G;\n\tint n, pcnt;\n\tvector\u0026lt;Data\u0026gt; H[MAX_N * 4 + 255];\n#define ls (o \u0026lt;\u0026lt; 1)\n#define rs (o \u0026lt;\u0026lt; 1 | 1)\n\n\tint _l, _r, _u, _d, _id;\n\n\tvoid ins(int o, int l, int r) {\n\t\tif (_l \u0026lt;\u003d l and r \u0026lt;\u003d _r) {\n\t\t\t//printf(\u0026quot;%d %d %d %d\\n\u0026quot;, l, r, _u, _d);\n\t\t\tH[o].pb(Data(_u, _d, _id));\n\t\t\treturn ;\n\t\t}\n\t\tint m \u003d (l + r) / 2;\n\t\tif (_l \u0026lt;\u003d m) ins(ls, l, m);\n\t\tif (m \u0026lt; _r) ins(rs, m + 1, r);\n\t}\n\tvoid del(int o, int l, int r) {\n\t\tif (_l \u0026lt;\u003d l and r \u0026lt;\u003d _r) {\n\t\t\tfor (vector\u0026lt;Data\u0026gt;::iterator it \u003d H[o].begin(); it !\u003d H[o].end(); it++) {\n\t\t\t\tif (it-\u0026gt;id \u003d\u003d _id) {\n\t\t\t\t\tH[o].erase(it);\n\t\t\t\t\tbreak ;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn ;\n\t\t}\n\t\tint m \u003d (l + r) / 2;\n\t\tif (_l \u0026lt;\u003d m) del(ls, l, m);\n\t\tif (m \u0026lt; _r) del(rs, m + 1, r);\n\t}\n\tinline int _ask(const vector\u0026lt;Data\u0026gt; \u0026amp;q, int h) {\n\t\tint best \u003d inf, ans \u003d -1;\n\t\tfor (auto to : q) {\n\t\t\tif (to.u \u0026lt;\u003d h and h \u0026lt;\u003d to.d and to.d - to.u \u0026lt; best) {\n\t\t\t\tbest \u003d to.d - to.u;\n\t\t\t\tans \u003d to.id;\n\t\t\t}\n\t\t}\n\t\treturn ans;\n\t}\n\tint ask(int o, int l, int r) {\n\t\tif (l \u003d\u003d r) return _ask(H[o], _u);\n\t\tint m \u003d (l + r) / 2;\n\t\tint ans \u003d m \u0026gt;\u003d _l ? ask(ls, l, m) : ask(rs, m + 1, r);\n\t\treturn ans \u0026lt; 0 ? _ask(H[o], _u) : ans;\n\t}\n#undef ls\n#undef rs\npublic :\n\tvoid init(int n) {\n\t\tthis-\u0026gt;n \u003d n;\n\t\tpcnt \u003d 1;\n\t}\n\tvoid ins(int l, int u, int r, int d) {\n\t\tG[mp(l, u)] \u003d _id \u003d pcnt++;\n\t\t_l \u003d l, _r \u003d r, _u \u003d u, _d \u003d d;\n\t\tins(1, 1, n);\n\t}\n\tvoid del(int l, int u, int r, int d) {\n\t\t_id \u003d G[mp(l, u)];\n\t\tG.erase(mp(l, u));\n\t\t_l \u003d l, _r \u003d r;\n\t\tdel(1, 1, n);\n\t}\n\tint ask(int x, int y) {\n\t\t_l \u003d x, _u \u003d y;\n\t\treturn ask(1, 1, n);\n\t}\n} my;\n\nint main() {\n\tint n, m, Q;\n\tread(n), read(m), read(Q);\n\tmy.init(2500); // FIX ME\n\tint opt, r1, c1, r2, c2;\n\twhile (Q--) {\n\t\tread(opt), read(r1), read(c1), read(r2), read(c2);\n\t\tif (opt \u003d\u003d 3) {\n\t\t\t//int a \u003d my.ask(r1, c1), b \u003d my.ask(r2, c2);\n\t\t\t//printf(\u0026quot;%d %d\\n\u0026quot;, a, b);\n\t\t\tputs(my.ask(r1, c1) \u003d\u003d my.ask(r2, c2) ? \u0026quot;Yes\u0026quot; : \u0026quot;No\u0026quot;);\n\t\t} else if (opt \u003d\u003d 1) {\n\t\t\tmy.ins(r1, c1, r2, c2);\n\t\t} else {\n\t\t\tmy.del(r1, c1, r2, c2);\n\t\t}\n\t}\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003cdiv class\u003d\"spoiler\"\u003e\u003cb class\u003d\"spoiler-title\"\u003eSolution 2 (Tommyr7)\u003c/b\u003e\u003cdiv class\u003d\"spoiler-content\" style\u003d\"display: none;\"\u003e\u003cpre\u003e\u003ccode\u003e#include \u0026lt;bits/stdc++.h\u0026gt;\n#define Maxn 2507\nusing namespace std;\nint n,m,q;\nmap\u0026lt;pair\u0026lt;pair\u0026lt;int,int\u0026gt;,pair\u0026lt;int,int\u0026gt; \u0026gt;,pair\u0026lt;unsigned long long,unsigned long long\u0026gt; \u0026gt; mp;\npair\u0026lt;unsigned long long,unsigned long long\u0026gt; s[Maxn][Maxn];\nvoid add(int x,int y,pair\u0026lt;unsigned long long,unsigned long long\u0026gt; del)\n{\n\tfor (int kx\u003dx;kx\u0026lt;\u003d2503;kx+\u003dkx\u0026amp;(-kx))\n\t\tfor (int ky\u003dy;ky\u0026lt;\u003d2503;ky+\u003dky\u0026amp;(-ky))\n\t\t{\n\t\t\ts[kx][ky].first+\u003ddel.first;\n\t\t\ts[kx][ky].second+\u003ddel.second;\n\t\t}\n}\npair\u0026lt;unsigned long long,unsigned long long\u0026gt; query(int x,int y)\n{\n\tpair\u0026lt;unsigned long long,unsigned long long\u0026gt; res\u003dmake_pair(0,0);\n\tfor (int kx\u003dx;kx;kx-\u003dkx\u0026amp;(-kx))\n\t\tfor (int ky\u003dy;ky;ky-\u003dky\u0026amp;(-ky))\n\t\t{\n\t\t\tres.first+\u003ds[kx][ky].first;\n\t\t\tres.second+\u003ds[kx][ky].second;\n\t\t}\n\treturn res;\n}\nint main()\n{\n\tscanf(\u0026quot;%d%d%d\u0026quot;,\u0026amp;n,\u0026amp;m,\u0026amp;q);\n\tmemset(s,0,sizeof(s));\n\tsrand(20001206);\n\tmp.clear();\n\tfor (int i\u003d1;i\u0026lt;\u003dq;i++)\n\t{\n\t\tint t,r1,c1,r2,c2;\n\t\tscanf(\u0026quot;%d%d%d%d%d\u0026quot;,\u0026amp;t,\u0026amp;r1,\u0026amp;c1,\u0026amp;r2,\u0026amp;c2);\n\t\tpair\u0026lt;unsigned long long,unsigned long long\u0026gt; del,udel;\n\t\tif (t\u003d\u003d1)\n\t\t{\n\t\t\tdel.first\u003drand();\n\t\t\tdel.second\u003drand();\n\t\t\tudel\u003dmake_pair(-del.first,-del.second);\n\t\t\tmp[make_pair(make_pair(r1,c1),make_pair(r2,c2))]\u003ddel;\n\t\t\tadd(r1,c1,del);\n\t\t\tadd(r1,c2+1,udel);\n\t\t\tadd(r2+1,c1,udel);\n\t\t\tadd(r2+1,c2+1,del);\n\t\t} else if (t\u003d\u003d2)\n\t\t{\n\t\t\tdel\u003dmp[make_pair(make_pair(r1,c1),make_pair(r2,c2))];\n\t\t\tmp[make_pair(make_pair(r1,c1),make_pair(r2,c2))]\u003dmake_pair(0,0);\n\t\t\tudel\u003dmake_pair(-del.first,-del.second);\n\t\t\tadd(r1,c1,udel);\n\t\t\tadd(r1,c2+1,del);\n\t\t\tadd(r2+1,c1,del);\n\t\t\tadd(r2+1,c2+1,udel);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdel\u003dquery(r1,c1);\n\t\t\tudel\u003dquery(r2,c2);\n\t\t\tif (del\u003d\u003dudel) printf(\u0026quot;Yes\\n\u0026quot;); else printf(\u0026quot;No\\n\u0026quot;);\n\t\t}\n\t}\n\treturn 0;\n}\n\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e \u003chr /\u003e\u003cp\u003e\u003cstrong\u003eTommyr7: I do hope you all enjoyed yourselves during the contest. See you next time!\u003c/strong\u003e\u003c/p\u003e\u003c/div\u003e","tags":[]}}